{
    "version": "https://jsonfeed.org/version/1",
    "title": "叶泯希·杂七杂八的🐕窝 • All posts by \"linux\" tag",
    "description": "叶泯希的个人博客,yeminxiblog",
    "home_page_url": "https://yeminxi.github.io",
    "items": [
        {
            "id": "https://yeminxi.github.io/posts/660d7bf6.html",
            "url": "https://yeminxi.github.io/posts/660d7bf6.html",
            "title": "第八章 Centos 7 Linux配置mariadb 实训任务：部署数据库",
            "date_published": "2024-05-28T05:51:51.000Z",
            "content_html": "<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>虚拟机需求：1台服务器（Server）192.168.1.10、1台客户端（Client1）192.168.1.100</p>\n<h2 id=\"部署数据库\"><a href=\"#部署数据库\" class=\"headerlink\" title=\"部署数据库\"></a>部署数据库</h2><h3 id=\"任务情境描述\"><a href=\"#任务情境描述\" class=\"headerlink\" title=\"任务情境描述\"></a>任务情境描述</h3><h4 id=\"任务一\"><a href=\"#任务一\" class=\"headerlink\" title=\"任务一\"></a>任务一</h4><blockquote>\n<p>某公司准备开发一套员工管理系统，其中数据库使用到了MariaDB数据库，现需要系统管理员完成以下部署工作：在公司一台Linux服务器（192.168.1.10）上安装数据库服务器和客户端，方便开发人员开发测试使用，在另一台Linux主机（192.168.1.100）上安装客户端；<br>对数据库进行初始化设置。</p>\n</blockquote>\n<h4 id=\"任务二\"><a href=\"#任务二\" class=\"headerlink\" title=\"任务二\"></a>任务二</h4><blockquote>\n<p>该公司准备开发一套新员工管理系统，现需要系统管理员完成以下安全管理工作：</p>\n<ol>\n<li><p>对数据库服务器进行必要的网络安全设置，只允许从公司内部网络（192.168.1.0&#x2F;24）访问数据库服务器；</p>\n</li>\n<li><p>从安全的角度对数据库的配置文件进行必要的安全设置，修改数据库端口号为“8800”，并设置日志文件为&#x2F;var&#x2F;log&#x2F;mariaDB&#x2F;access.log</p>\n</li>\n<li><p>登录数据库，并新建一个名为newstaff的数据库；在数据库中创建一个数据表为stafftable；字段类型为staff int，username varchar(20)，sex char(6)，age<br>int；并将下表中的总公司部门员工信息插入到stafftable表中：<img src=\"https://ymxpic.pages.dev/file/a238c4a03ba3d4b9e5f31.png\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/a238c4a03ba3d4b9e5f31.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n</li>\n<li><p>对数据库账户和权限进行必要的管理，为开发人员创建一个名为“adminDB”的账户，但只允许他对newstaff数据库进行必要的操作；</p>\n</li>\n<li><p>为有效保护员工数据，编写一个定时任务，让系统每天凌晨0:00点对newstaff数据库自动进行数据备份。</p>\n</li>\n</ol>\n</blockquote>\n<h2 id=\"一、-服务器（Server）和客户端（Client1）安装数据库服务\"><a href=\"#一、-服务器（Server）和客户端（Client1）安装数据库服务\" class=\"headerlink\" title=\"一、 服务器（Server）和客户端（Client1）安装数据库服务\"></a>一、 服务器（Server）和客户端（Client1）安装数据库服务</h2><h3 id=\"1-服务器（Server）\"><a href=\"#1-服务器（Server）\" class=\"headerlink\" title=\"1. 服务器（Server）\"></a>1. 服务器（Server）</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@server</span> www]# yum -y install mariadb-server mysql\t<span class=\"comment\">//安装</span></span><br><span class=\"line\">[root<span class=\"meta\">@server</span> www]# systemctl start mariadb.service \t\t<span class=\"comment\">//开启</span></span><br><span class=\"line\">[root<span class=\"meta\">@server</span> www]# systemctl enable mariadb.service \t<span class=\"comment\">//自启</span></span><br><span class=\"line\">Created symlink from /etc/systemd/system/multi-user.target.wants/mariadb.service to /usr/lib/systemd/system/mariadb.service.</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-客户端（Client1）\"><a href=\"#2-客户端（Client1）\" class=\"headerlink\" title=\"2. 客户端（Client1）\"></a>2. 客户端（Client1）</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# yum -y install mysql\t\t<span class=\"comment\">//安装</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"二、在服务器（Server）创建数据库和表\"><a href=\"#二、在服务器（Server）创建数据库和表\" class=\"headerlink\" title=\"二、在服务器（Server）创建数据库和表\"></a>二、在服务器（Server）创建数据库和表</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@server</span> www]# mysql -uroot -p\t\t<span class=\"comment\">//登录数据库 默认密码应该是root或空</span></span><br><span class=\"line\">Enter password: </span><br><span class=\"line\">Welcome to the MariaDB monitor.  Commands end with ; or \\g.</span><br><span class=\"line\">Your MariaDB connection id is <span class=\"number\">6</span></span><br><span class=\"line\">Server version: <span class=\"number\">5.5</span><span class=\"number\">.68</span>-MariaDB MariaDB Server</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">Copyright</span> <span class=\"params\">(c)</span> <span class=\"number\">2000</span>, <span class=\"number\">2018</span>, Oracle, MariaDB Corporation Ab and others.</span><br><span class=\"line\"></span><br><span class=\"line\">Type <span class=\"string\">&#x27;help;&#x27;</span> or <span class=\"string\">&#x27;\\h&#x27;</span> <span class=\"keyword\">for</span> help. Type <span class=\"string\">&#x27;\\c&#x27;</span> to clear the current input statement.</span><br><span class=\"line\"></span><br><span class=\"line\">MariaDB [(none)]&gt; create database newstaff;\t\t\t<span class=\"comment\">//创建数据库newstaff</span></span><br><span class=\"line\">Query OK, <span class=\"number\">1</span> row <span class=\"title function_\">affected</span> <span class=\"params\">(<span class=\"number\">0.00</span> sec)</span></span><br><span class=\"line\"></span><br><span class=\"line\">MariaDB [(none)]&gt; use newstaff;\t\t\t\t\t\t<span class=\"comment\">//进入数据库newstaff</span></span><br><span class=\"line\">Database changed</span><br><span class=\"line\">MariaDB [newstaff]&gt; create table <span class=\"title function_\">stafftable</span> <span class=\"params\">(\t\t//按任务需求创建表</span></span><br><span class=\"line\"><span class=\"params\">    -&gt; staffID <span class=\"type\">int</span> auto_increment,\t\t\t\t\t//自增</span></span><br><span class=\"line\"><span class=\"params\">    -&gt; username varchar(<span class=\"number\">20</span>)</span>,</span><br><span class=\"line\">    -&gt; sex <span class=\"title function_\">char</span><span class=\"params\">(<span class=\"number\">6</span>)</span>,</span><br><span class=\"line\">    -&gt; age <span class=\"type\">int</span>,</span><br><span class=\"line\">    -&gt; primary <span class=\"title function_\">key</span><span class=\"params\">(staffID)</span>\t\t\t\t\t\t\t<span class=\"comment\">//主键</span></span><br><span class=\"line\">    -&gt; )engine=innodb <span class=\"keyword\">default</span> charset=utf8;\t\t\t<span class=\"comment\">//表的引擎字符类型</span></span><br><span class=\"line\">Query OK, <span class=\"number\">0</span> rows <span class=\"title function_\">affected</span> <span class=\"params\">(<span class=\"number\">0.02</span> sec)</span></span><br><span class=\"line\"></span><br><span class=\"line\">MariaDB [newstaff]&gt; insert into <span class=\"title function_\">stafftable</span><span class=\"params\">(username,sex,age)</span> values(<span class=\"string\">&#x27;Tom&#x27;</span>,<span class=\"string\">&#x27;male&#x27;</span>,<span class=\"number\">25</span>),(<span class=\"string\">&#x27;Mary&#x27;</span>,<span class=\"string\">&#x27;female&#x27;</span>,<span class=\"number\">30</span>);\t\t\t\t\t\t\t\t</span><br><span class=\"line\">Query OK, <span class=\"number\">2</span> rows <span class=\"title function_\">affected</span> <span class=\"params\">(<span class=\"number\">0.05</span> sec)</span>\t\t\t\t<span class=\"comment\">//按要求插入数据</span></span><br><span class=\"line\">Records: <span class=\"number\">2</span>  Duplicates: <span class=\"number\">0</span>  Warnings: <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">MariaDB [newstaff]&gt; desc stafftable;\t\t\t\t<span class=\"comment\">//查看表结构</span></span><br><span class=\"line\">+----------+-------------+------+-----+---------+----------------+</span><br><span class=\"line\">| Field    | Type        | Null | Key | Default | Extra          |</span><br><span class=\"line\">+----------+-------------+------+-----+---------+----------------+</span><br><span class=\"line\">| staffID  | <span class=\"type\">int</span>(<span class=\"number\">11</span>)     | NO   | PRI | NULL    | auto_increment |</span><br><span class=\"line\">| username | varchar(<span class=\"number\">20</span>) | YES  |     | NULL    |                |</span><br><span class=\"line\">| sex      | <span class=\"type\">char</span>(<span class=\"number\">6</span>)     | YES  |     | NULL    |                |</span><br><span class=\"line\">| age      | <span class=\"type\">int</span>(<span class=\"number\">11</span>)     | YES  |     | NULL    |                |</span><br><span class=\"line\">+----------+-------------+------+-----+---------+----------------+</span><br><span class=\"line\"><span class=\"number\">4</span> rows in <span class=\"title function_\">set</span> <span class=\"params\">(<span class=\"number\">0.00</span> sec)</span></span><br><span class=\"line\"></span><br><span class=\"line\">MariaDB [newstaff]&gt; select * from stafftable;\t\t<span class=\"comment\">//查询表内所有数据</span></span><br><span class=\"line\">+---------+----------+--------+------+</span><br><span class=\"line\">| staffID | username | sex    | age  |</span><br><span class=\"line\">+---------+----------+--------+------+</span><br><span class=\"line\">|       <span class=\"number\">1</span> | Tom      | male   |   <span class=\"number\">25</span> |</span><br><span class=\"line\">|       <span class=\"number\">2</span> | Mary     | female |   <span class=\"number\">30</span> |</span><br><span class=\"line\">+---------+----------+--------+------+</span><br><span class=\"line\"><span class=\"number\">2</span> rows in <span class=\"title function_\">set</span> <span class=\"params\">(<span class=\"number\">0.01</span> sec)</span></span><br><span class=\"line\"></span><br><span class=\"line\">MariaDB [newstaff]&gt; quit\t\t\t\t\t\t\t<span class=\"comment\">//退出</span></span><br><span class=\"line\">Bye</span><br><span class=\"line\">[root<span class=\"meta\">@server</span> www]# </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"三、-服务器（Server）只允许192-168-1-0-24访问数据库\"><a href=\"#三、-服务器（Server）只允许192-168-1-0-24访问数据库\" class=\"headerlink\" title=\"三、 服务器（Server）只允许192.168.1.0&#x2F;24访问数据库\"></a>三、 服务器（Server）只允许192.168.1.0&#x2F;24访问数据库</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@server</span> www]# iptables -A INPUT -p tcp -s <span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.0</span>/<span class=\"number\">24</span> --dport <span class=\"number\">8800</span> -j ACCEPT</span><br></pre></td></tr></table></figure>\n<h2 id=\"四、-修改服务器（Server）默认端口\"><a href=\"#四、-修改服务器（Server）默认端口\" class=\"headerlink\" title=\"四、 修改服务器（Server）默认端口\"></a>四、 修改服务器（Server）默认端口</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/my.cnf\t\t<span class=\"comment\">//插入以下</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">port=8800\t\t\t\t\t\t\t\t\t\t//修改默认端口</span><br><span class=\"line\">max_user_connections=2\t\t\t\t\t\t\t//最大用户数</span><br><span class=\"line\">log=/var/log/mariadb/access.log\t\t\t\t\t//修改日志默认路径</span><br><span class=\"line\">[mysqld_safe]</span><br></pre></td></tr></table></figure>\n\n<p>防火墙设置</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">允许mysql[root<span class=\"meta\">@server</span> www]# firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-service=mysql</span><br><span class=\"line\">success</span><br><span class=\"line\">允许端口[root<span class=\"meta\">@server</span> www]# firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-port=<span class=\"number\">8800</span>/tcp</span><br><span class=\"line\">success</span><br><span class=\"line\">允许端口[root<span class=\"meta\">@server</span> www]# firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-port=<span class=\"number\">8800</span>/udp</span><br><span class=\"line\">success</span><br><span class=\"line\">重启防火墙[root<span class=\"meta\">@server</span> www]# semanage port -l | grep mysql</span><br><span class=\"line\">mysqld_port_t                  tcp      <span class=\"number\">8800</span>, <span class=\"number\">1186</span>, <span class=\"number\">3306</span>, <span class=\"number\">63132</span>-<span class=\"number\">63164</span></span><br><span class=\"line\">mysqlmanagerd_port_t           tcp      <span class=\"number\">2273</span></span><br><span class=\"line\">[root<span class=\"meta\">@server</span> www]# semanage port -a -t mysqld_port_t -p tcp <span class=\"number\">8800</span></span><br><span class=\"line\">[root<span class=\"meta\">@server</span> www]# firewall-cmd --reload </span><br><span class=\"line\">success</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@server</span> www]# systemctl restart mariadb.service </span><br></pre></td></tr></table></figure>\n<h2 id=\"五、在服务器（Server）上创建账户只允许他对newstaff数据库进行操作\"><a href=\"#五、在服务器（Server）上创建账户只允许他对newstaff数据库进行操作\" class=\"headerlink\" title=\"五、在服务器（Server）上创建账户只允许他对newstaff数据库进行操作\"></a>五、在服务器（Server）上创建账户只允许他对newstaff数据库进行操作</h2><p>创建用户</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@server</span> www]# mysql -uroot -p</span><br><span class=\"line\">Enter password: </span><br><span class=\"line\">Welcome to the MariaDB monitor.  Commands end with ; or \\g.</span><br><span class=\"line\">Your MariaDB connection id is <span class=\"number\">7</span></span><br><span class=\"line\">Server version: <span class=\"number\">5.5</span><span class=\"number\">.68</span>-MariaDB MariaDB Server</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">Copyright</span> <span class=\"params\">(c)</span> <span class=\"number\">2000</span>, <span class=\"number\">2018</span>, Oracle, MariaDB Corporation Ab and others.</span><br><span class=\"line\"></span><br><span class=\"line\">Type <span class=\"string\">&#x27;help;&#x27;</span> or <span class=\"string\">&#x27;\\h&#x27;</span> <span class=\"keyword\">for</span> help. Type <span class=\"string\">&#x27;\\c&#x27;</span> to clear the current input statement.</span><br><span class=\"line\"></span><br><span class=\"line\">MariaDB [(none)]&gt; use mysql;</span><br><span class=\"line\">Reading table information <span class=\"keyword\">for</span> completion of table and column names</span><br><span class=\"line\">You can turn off <span class=\"built_in\">this</span> feature to get a quicker startup with -A</span><br><span class=\"line\"></span><br><span class=\"line\">Database changed</span><br><span class=\"line\">MariaDB [mysql]&gt; create user <span class=\"string\">&#x27;adminDB&#x27;</span>@<span class=\"string\">&#x27;%&#x27;</span> identified by <span class=\"string\">&#x27;root&#x27;</span>;  <span class=\"comment\">//设置用户名和密码root</span></span><br><span class=\"line\">Query OK, <span class=\"number\">0</span> rows <span class=\"title function_\">affected</span> <span class=\"params\">(<span class=\"number\">0.00</span> sec)</span></span><br><span class=\"line\"></span><br><span class=\"line\">MariaDB [mysql]&gt; quit</span><br><span class=\"line\">Bye</span><br><span class=\"line\">[root<span class=\"meta\">@server</span> www]# </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>只允许对newstaff数据库进行操作</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@server</span> www]# mysql -uroot -p</span><br><span class=\"line\">Enter password: </span><br><span class=\"line\">Welcome to the MariaDB monitor.  Commands end with ; or \\g.</span><br><span class=\"line\">Your MariaDB connection id is <span class=\"number\">8</span></span><br><span class=\"line\">Server version: <span class=\"number\">5.5</span><span class=\"number\">.68</span>-MariaDB MariaDB Server</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">Copyright</span> <span class=\"params\">(c)</span> <span class=\"number\">2000</span>, <span class=\"number\">2018</span>, Oracle, MariaDB Corporation Ab and others.</span><br><span class=\"line\"></span><br><span class=\"line\">Type <span class=\"string\">&#x27;help;&#x27;</span> or <span class=\"string\">&#x27;\\h&#x27;</span> <span class=\"keyword\">for</span> help. Type <span class=\"string\">&#x27;\\c&#x27;</span> to clear the current input statement.</span><br><span class=\"line\"></span><br><span class=\"line\">MariaDB [(none)]&gt; show grants <span class=\"keyword\">for</span> <span class=\"string\">&#x27;adminDB&#x27;</span>@<span class=\"string\">&#x27;%&#x27;</span>;</span><br><span class=\"line\">+----------------------------------------------------------------------------------------------------------------+</span><br><span class=\"line\">| Grants <span class=\"keyword\">for</span> adminDB@%                                                                                   |</span><br><span class=\"line\">+----------------------------------------------------------------------------------------------------------------+</span><br><span class=\"line\">| GRANT USAGE ON *.* TO <span class=\"string\">&#x27;adminDB&#x27;</span>@<span class=\"string\">&#x27;%&#x27;</span> IDENTIFIED BY PASSWORD <span class=\"string\">&#x27;*81F5E21E35407D884A6CD4A731AEBFB6AF209E1B&#x27;</span> |</span><br><span class=\"line\">+----------------------------------------------------------------------------------------------------------------+</span><br><span class=\"line\"><span class=\"number\">1</span> row in <span class=\"title function_\">set</span> <span class=\"params\">(<span class=\"number\">0.00</span> sec)</span></span><br><span class=\"line\"></span><br><span class=\"line\">MariaDB [(none)]&gt; grant select,insert,update,delete,create,drop on newstaff.* to <span class=\"string\">&#x27;adminDB&#x27;</span>@<span class=\"string\">&#x27;%&#x27;</span>;\t<span class=\"comment\">//只允许adminDB操作数据库newstaff</span></span><br><span class=\"line\">Query OK, <span class=\"number\">0</span> rows <span class=\"title function_\">affected</span> <span class=\"params\">(<span class=\"number\">0.01</span> sec)</span></span><br><span class=\"line\"></span><br><span class=\"line\">MariaDB [(none)]&gt; quit</span><br><span class=\"line\">Bye</span><br><span class=\"line\">[root<span class=\"meta\">@server</span> www]# </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"六、编写备份程序（可略，老师好像不看）\"><a href=\"#六、编写备份程序（可略，老师好像不看）\" class=\"headerlink\" title=\"六、编写备份程序（可略，老师好像不看）\"></a>六、编写备份程序（可略，老师好像不看）</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@server</span> www]# mysqldump -uroot -p newstaff &gt; newstaff_backup.sql\t\t<span class=\"comment\">//备份newstaff数据库</span></span><br><span class=\"line\">Enter password: </span><br><span class=\"line\">[root<span class=\"meta\">@server</span> www]# cd ..</span><br><span class=\"line\">[root<span class=\"meta\">@server</span> <span class=\"keyword\">var</span>]# cd ..</span><br><span class=\"line\">[root<span class=\"meta\">@server</span> /]# vim backup.sh\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//编写程序</span></span><br><span class=\"line\">#!/bin/bash</span><br><span class=\"line\">time=`date+<span class=\"string\">&quot;(&quot;</span>%F<span class=\"string\">&quot;)&quot;</span>%R`</span><br><span class=\"line\">$/usr/local/mysql/bin/mysqldump -uroot -proot newstaff|gzip &gt; /root/staffbackup-$time.gz</span><br><span class=\"line\">[root<span class=\"meta\">@server</span> /]# crontab -e\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//添加定时任务</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">00 00 * * * /backup.sh\t\t\t\t\t\t\t\t\t\t\t\t\t\t//0点0分 每天 每月 每时 脚本路径</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">crontab: installing <span class=\"keyword\">new</span> <span class=\"title class_\">crontab</span></span><br><span class=\"line\">[root<span class=\"meta\">@server</span> /]# systemcrl restart mariadb</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"七、-测试\"><a href=\"#七、-测试\" class=\"headerlink\" title=\"七、 测试\"></a>七、 测试</h2><p>老师一般说这几条命令，她叫你打什么就打什么吧</p>\n<h3 id=\"1-客户端（Client1）\"><a href=\"#1-客户端（Client1）\" class=\"headerlink\" title=\"1. 客户端（Client1）\"></a>1. 客户端（Client1）</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# mysql -uadminDB -p -P8800 -h <span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.10</span>\t<span class=\"comment\">//带端口登录</span></span><br><span class=\"line\">Enter password: </span><br><span class=\"line\">Welcome to the MariaDB monitor.  Commands end with ; or \\g.</span><br><span class=\"line\">Your MariaDB connection id is <span class=\"number\">8</span></span><br><span class=\"line\">Server version: <span class=\"number\">5.5</span><span class=\"number\">.68</span>-MariaDB MariaDB Server</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">Copyright</span> <span class=\"params\">(c)</span> <span class=\"number\">2000</span>, <span class=\"number\">2018</span>, Oracle, MariaDB Corporation Ab and others.</span><br><span class=\"line\"></span><br><span class=\"line\">Type <span class=\"string\">&#x27;help;&#x27;</span> or <span class=\"string\">&#x27;\\h&#x27;</span> <span class=\"keyword\">for</span> help. Type <span class=\"string\">&#x27;\\c&#x27;</span> to clear the current input statement.</span><br><span class=\"line\"></span><br><span class=\"line\">MariaDB [(none)]&gt; use newstaff;</span><br><span class=\"line\">Reading table information <span class=\"keyword\">for</span> completion of table and column names</span><br><span class=\"line\">You can turn off <span class=\"built_in\">this</span> feature to get a quicker startup with -A</span><br><span class=\"line\"></span><br><span class=\"line\">Database changed</span><br><span class=\"line\">MariaDB [newstaff]&gt; desc stafftable;\t\t\t\t<span class=\"comment\">//查看表结构</span></span><br><span class=\"line\">+----------+-------------+------+-----+---------+----------------+</span><br><span class=\"line\">| Field    | Type        | Null | Key | Default | Extra          |</span><br><span class=\"line\">+----------+-------------+------+-----+---------+----------------+</span><br><span class=\"line\">| staffID  | <span class=\"type\">int</span>(<span class=\"number\">11</span>)     | NO   | PRI | NULL    | auto_increment |</span><br><span class=\"line\">| username | varchar(<span class=\"number\">20</span>) | YES  |     | NULL    |                |</span><br><span class=\"line\">| sex      | <span class=\"type\">char</span>(<span class=\"number\">6</span>)     | YES  |     | NULL    |                |</span><br><span class=\"line\">| age      | <span class=\"type\">int</span>(<span class=\"number\">11</span>)     | YES  |     | NULL    |                |</span><br><span class=\"line\">+----------+-------------+------+-----+---------+----------------+</span><br><span class=\"line\"><span class=\"number\">4</span> rows in <span class=\"title function_\">set</span> <span class=\"params\">(<span class=\"number\">0.00</span> sec)</span></span><br><span class=\"line\"></span><br><span class=\"line\">MariaDB [newstaff]&gt; select * from stafftable;\t\t<span class=\"comment\">//查看表内容</span></span><br><span class=\"line\">+---------+----------+--------+------+</span><br><span class=\"line\">| staffID | username | sex    | age  |</span><br><span class=\"line\">+---------+----------+--------+------+</span><br><span class=\"line\">|       <span class=\"number\">1</span> | Tom      | male   |   <span class=\"number\">25</span> |</span><br><span class=\"line\">|       <span class=\"number\">2</span> | Mary     | female |   <span class=\"number\">30</span> |</span><br><span class=\"line\">+---------+----------+--------+------+</span><br><span class=\"line\"><span class=\"number\">2</span> rows in <span class=\"title function_\">set</span> <span class=\"params\">(<span class=\"number\">0.00</span> sec)</span></span><br><span class=\"line\"></span><br><span class=\"line\">MariaDB [newstaff]&gt; quit</span><br><span class=\"line\">Bye</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]#</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-服务器（Server）\"><a href=\"#2-服务器（Server）\" class=\"headerlink\" title=\"2. 服务器（Server）\"></a>2. 服务器（Server）</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@server</span> /]# mysql -uroot -p</span><br><span class=\"line\">Enter password: </span><br><span class=\"line\">Welcome to the MariaDB monitor.  Commands end with ; or \\g.</span><br><span class=\"line\">Your MariaDB connection id is <span class=\"number\">12</span></span><br><span class=\"line\">Server version: <span class=\"number\">5.5</span><span class=\"number\">.68</span>-MariaDB MariaDB Server</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">Copyright</span> <span class=\"params\">(c)</span> <span class=\"number\">2000</span>, <span class=\"number\">2018</span>, Oracle, MariaDB Corporation Ab and others.</span><br><span class=\"line\"></span><br><span class=\"line\">Type <span class=\"string\">&#x27;help;&#x27;</span> or <span class=\"string\">&#x27;\\h&#x27;</span> <span class=\"keyword\">for</span> help. Type <span class=\"string\">&#x27;\\c&#x27;</span> to clear the current input statement.</span><br><span class=\"line\"></span><br><span class=\"line\">MariaDB [(none)]&gt; show grants <span class=\"keyword\">for</span> <span class=\"string\">&#x27;adminDB&#x27;</span>@<span class=\"string\">&#x27;%&#x27;</span>;</span><br><span class=\"line\">+--------------------------------------------------------------------------------------------------------------------+</span><br><span class=\"line\">| Grants <span class=\"keyword\">for</span> adminDB@%                                                                                   |</span><br><span class=\"line\">+--------------------------------------------------------------------------------------------------------------------+</span><br><span class=\"line\">| GRANT USAGE ON *.* TO <span class=\"string\">&#x27;adminDB&#x27;</span>@<span class=\"string\">&#x27;%&#x27;</span> IDENTIFIED BY PASSWORD <span class=\"string\">&#x27;*81F5E21E35407D884A6CD4A731AEBFB6AF209E1B&#x27;</span> |</span><br><span class=\"line\">| GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP ON `newstaff`.* TO <span class=\"string\">&#x27;adminDB&#x27;</span>@<span class=\"string\">&#x27;%&#x27;</span>                    |</span><br><span class=\"line\">+--------------------------------------------------------------------------------------------------------------------+</span><br><span class=\"line\"><span class=\"number\">2</span> rows in <span class=\"title function_\">set</span> <span class=\"params\">(<span class=\"number\">0.00</span> sec)</span></span><br><span class=\"line\"></span><br><span class=\"line\">MariaDB [(none)]&gt; quit</span><br><span class=\"line\">Bye</span><br><span class=\"line\">[root<span class=\"meta\">@server</span> /]#</span><br></pre></td></tr></table></figure>\n<h2 id=\"至此，实验结束。\"><a href=\"#至此，实验结束。\" class=\"headerlink\" title=\"至此，实验结束。\"></a>至此，实验结束。</h2>",
            "tags": [
                "数据库",
                "服务器",
                "Linux",
                "CentOS",
                "mariadb"
            ]
        },
        {
            "id": "https://yeminxi.github.io/posts/2d95345a.html",
            "url": "https://yeminxi.github.io/posts/2d95345a.html",
            "title": "第七章 Centos 7 Linux配置ftp 实训任务1：FTP服务器加密传输",
            "date_published": "2024-05-28T05:31:51.000Z",
            "content_html": "<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p><em><strong>&#x3D;&#x3D;前面的DNS一定要成功才能做！！！&#x3D;&#x3D;</strong></em><br>虚拟机需求：1台DNS服务器（Server）、1台Web服务器（Ftp Server）、1台客户端（Client1）</p>\n<blockquote>\n<p><strong>在第五章的基础上继续实训</strong></p>\n</blockquote>\n<h2 id=\"FTP服务器加密传输\"><a href=\"#FTP服务器加密传输\" class=\"headerlink\" title=\"FTP服务器加密传输\"></a>FTP服务器加密传输</h2><blockquote>\n<p>任务情境描述<br>某公司在需要使用vsftpd搭建一台FTP服务器，用于web站点资料的更新和公司公用文件的存放。为了保证客户机和服务器之间传输数据的保密性和完整性，公司决定使用SSL&#x2F;TLS协议加固FTP服务器，客户机和服务器之间采用SSL&#x2F;TLS协议加密数据。</p>\n</blockquote>\n<h2 id=\"任务要求：\"><a href=\"#任务要求：\" class=\"headerlink\" title=\"任务要求：\"></a>任务要求：</h2><blockquote>\n<h3 id=\"1-禁止使用不安全的FTP，请使用“CA”证书颁发机构，颁发的证书，启用FTPS服务；\"><a href=\"#1-禁止使用不安全的FTP，请使用“CA”证书颁发机构，颁发的证书，启用FTPS服务；\" class=\"headerlink\" title=\"1. 禁止使用不安全的FTP，请使用“CA”证书颁发机构，颁发的证书，启用FTPS服务；\"></a>1. 禁止使用不安全的FTP，请使用“CA”证书颁发机构，颁发的证书，启用FTPS服务；</h3><pre><code>Country Name (2 letter code) [XX]:CN\n</code></pre>\n<p>State or Province Name (fullname) []:GD \t \t<br>Locality Name (eg, city) [Default City]:GuangZhou \t<br>    Organization Name (eg, company) [Default Company Ltd]:mydomain.com \t<br>    Organizational Unit Name (eg, section) []:Operations Departments \t<br>    Common Name (eg, your name or your server’s hostname)[]:ftp.mydomain.com</p>\n<h3 id=\"2-使用ftp-mydomian-com域名访问服务器；\"><a href=\"#2-使用ftp-mydomian-com域名访问服务器；\" class=\"headerlink\" title=\"2. 使用ftp.mydomian.com域名访问服务器；\"></a>2. 使用ftp.mydomian.com域名访问服务器；</h3><h3 id=\"3-用户webadmin，登录ftp服务器，根目录为-webdata-；\"><a href=\"#3-用户webadmin，登录ftp服务器，根目录为-webdata-；\" class=\"headerlink\" title=\"3. 用户webadmin，登录ftp服务器，根目录为&#x2F;webdata&#x2F;；\"></a>3. 用户webadmin，登录ftp服务器，根目录为&#x2F;webdata&#x2F;；</h3><h3 id=\"4-登录后限制在自己的根目录；\"><a href=\"#4-登录后限制在自己的根目录；\" class=\"headerlink\" title=\"4. 登录后限制在自己的根目录；\"></a>4. 登录后限制在自己的根目录；</h3><h3 id=\"5-允许WEB管理员上传和下载文件，但是禁止上传后缀名为-doc-docx-xlsx的文件；\"><a href=\"#5-允许WEB管理员上传和下载文件，但是禁止上传后缀名为-doc-docx-xlsx的文件；\" class=\"headerlink\" title=\"5. 允许WEB管理员上传和下载文件，但是禁止上传后缀名为.doc .docx .xlsx的文件；\"></a>5. 允许WEB管理员上传和下载文件，但是禁止上传后缀名为.doc .docx .xlsx的文件；</h3><h3 id=\"6-限制用户的下载最大速度为100kb-s；最大同一IP在线人数为2人；\"><a href=\"#6-限制用户的下载最大速度为100kb-s；最大同一IP在线人数为2人；\" class=\"headerlink\" title=\"6. 限制用户的下载最大速度为100kb&#x2F;s；最大同一IP在线人数为2人；\"></a>6. 限制用户的下载最大速度为100kb&#x2F;s；最大同一IP在线人数为2人；</h3><h3 id=\"7-用于通过工具或者浏览器下载的最大速度不超过100kb-s；\"><a href=\"#7-用于通过工具或者浏览器下载的最大速度不超过100kb-s；\" class=\"headerlink\" title=\"7.用于通过工具或者浏览器下载的最大速度不超过100kb&#x2F;s；\"></a>7.用于通过工具或者浏览器下载的最大速度不超过100kb&#x2F;s；</h3><h3 id=\"8-一个IP地址同时登陆的用户进程-人数不超过2人。\"><a href=\"#8-一个IP地址同时登陆的用户进程-人数不超过2人。\" class=\"headerlink\" title=\"8. 一个IP地址同时登陆的用户进程&#x2F;人数不超过2人。\"></a>8. 一个IP地址同时登陆的用户进程&#x2F;人数不超过2人。</h3></blockquote>\n<h2 id=\"一、配置Ftp服务器（Ftp-Server）的IP地址\"><a href=\"#一、配置Ftp服务器（Ftp-Server）的IP地址\" class=\"headerlink\" title=\"一、配置Ftp服务器（Ftp Server）的IP地址\"></a>一、配置Ftp服务器（Ftp Server）的IP地址</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">BOOTPROTO=static</span><br><span class=\"line\">IPADDR=192.168.1.100</span><br><span class=\"line\">GATEWAY=192.168.1.2</span><br><span class=\"line\">NETMASK=255.255.255.0</span><br><span class=\"line\">DNS1=192.168.1.10</span><br><span class=\"line\">DNS2=202.96.128.86</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/b3c12c42b1a1943313648.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/b3c12c42b1a1943313648.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"二、-为Ftp服务器（Ftp-Server）安装vsftp服务\"><a href=\"#二、-为Ftp服务器（Ftp-Server）安装vsftp服务\" class=\"headerlink\" title=\"二、 为Ftp服务器（Ftp Server）安装vsftp服务\"></a>二、 为Ftp服务器（Ftp Server）安装vsftp服务</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install vsftpd\t<span class=\"comment\">//安装vsftp服务</span></span><br><span class=\"line\">systemctl start vsftpd\t<span class=\"comment\">//开启vsftp服务</span></span><br><span class=\"line\">systemctl enable vsftpd\t<span class=\"comment\">//开机自启</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/da457df601a02990e21fc.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/da457df601a02990e21fc.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"三、Ftp服务器（Ftp-Server）生成证书\"><a href=\"#三、Ftp服务器（Ftp-Server）生成证书\" class=\"headerlink\" title=\"三、Ftp服务器（Ftp Server）生成证书\"></a>三、Ftp服务器（Ftp Server）生成证书</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">创建目录[root<span class=\"meta\">@webserver</span> webserver]# mkdir /etc/ssl/serverkey</span><br><span class=\"line\">生成证书[root<span class=\"meta\">@webserver</span> webserver]# openssl req -x509 -nodes -keyout /etc/ssl/serverkey/vsftpd.pem -out /etc/ssl/serverkey/vsftpd.pem -days <span class=\"number\">365</span> -newkey rsa:<span class=\"number\">2048</span></span><br><span class=\"line\">Generating a <span class=\"number\">2048</span> bit RSA <span class=\"keyword\">private</span> key</span><br><span class=\"line\">................+++</span><br><span class=\"line\">.....+++</span><br><span class=\"line\">writing <span class=\"keyword\">new</span> <span class=\"title class_\">private</span> key to <span class=\"string\">&#x27;/etc/ssl/serverkey/vsftpd.pem&#x27;</span></span><br><span class=\"line\">-----</span><br><span class=\"line\">You are about to be asked to enter information that will be incorporated</span><br><span class=\"line\">into your certificate request.</span><br><span class=\"line\">What you are about to enter is what is called a Distinguished Name or a DN.</span><br><span class=\"line\">There are quite a few fields but you can leave some blank</span><br><span class=\"line\">For some fields there will be a <span class=\"keyword\">default</span> value,</span><br><span class=\"line\">If you enter <span class=\"string\">&#x27;.&#x27;</span>, the field will be left blank.</span><br><span class=\"line\">-----</span><br><span class=\"line\">Country <span class=\"title function_\">Name</span> <span class=\"params\">(<span class=\"number\">2</span> letter code)</span> [CN]:</span><br><span class=\"line\">State or Province <span class=\"title function_\">Name</span> <span class=\"params\">(full name)</span> [China]:GD</span><br><span class=\"line\">Locality <span class=\"title function_\">Name</span> <span class=\"params\">(eg, city)</span> [GuangZhou]:</span><br><span class=\"line\">Organization <span class=\"title function_\">Name</span> <span class=\"params\">(eg, company)</span> [ymx.com]:</span><br><span class=\"line\">Organizational Unit <span class=\"title function_\">Name</span> <span class=\"params\">(eg, section)</span> []:Operations Departments</span><br><span class=\"line\">Common <span class=\"title function_\">Name</span> <span class=\"params\">(eg, your name or your server<span class=\"string\">&#x27;s hostname) []:ftp.ymx.com</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"params\">Email Address []:</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"params\">[root@webserver webserver]#</span></span></span><br></pre></td></tr></table></figure>\n<p>图片打反了 别按照图片 按上面的文本<br><img src=\"https://ymxpic.pages.dev/file/173428ff934d91c26fc94.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/173428ff934d91c26fc94.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"四、-Ftp服务器（Ftp-Server）防火墙设置\"><a href=\"#四、-Ftp服务器（Ftp-Server）防火墙设置\" class=\"headerlink\" title=\"四、 Ftp服务器（Ftp Server）防火墙设置\"></a>四、 Ftp服务器（Ftp Server）防火墙设置</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">允许ftp通过[root<span class=\"meta\">@webserver</span> webserver]# firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-service=ftp</span><br><span class=\"line\">success</span><br><span class=\"line\">允许端口通过[root<span class=\"meta\">@webserver</span> webserver]# firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-port=<span class=\"number\">990</span>/tcp</span><br><span class=\"line\">success</span><br><span class=\"line\">允许端口通过[root<span class=\"meta\">@webserver</span> webserver]# firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-port=<span class=\"number\">990</span>/udp</span><br><span class=\"line\">success</span><br><span class=\"line\">允许端口通过[root<span class=\"meta\">@webserver</span> webserver]# firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-port=<span class=\"number\">40000</span>-<span class=\"number\">50000</span>/tcp</span><br><span class=\"line\">success</span><br><span class=\"line\">允许端口通过[root<span class=\"meta\">@webserver</span> webserver]# firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-port=<span class=\"number\">40000</span>-<span class=\"number\">50000</span>/udp</span><br><span class=\"line\">success</span><br><span class=\"line\">重启防火墙[root<span class=\"meta\">@webserver</span> webserver]# firewall-cmd --reload </span><br><span class=\"line\">success</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/cb7bc5a7b1bc7e530010d.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/cb7bc5a7b1bc7e530010d.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"五、-Ftp服务器（Ftp-Server）配置vsftp文件\"><a href=\"#五、-Ftp服务器（Ftp-Server）配置vsftp文件\" class=\"headerlink\" title=\"五、 Ftp服务器（Ftp Server）配置vsftp文件\"></a>五、 Ftp服务器（Ftp Server）配置vsftp文件</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/vsftpd/vsftpd.conf</span><br></pre></td></tr></table></figure>\n<p>最后插入</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssl_enable=yes</span><br><span class=\"line\">ssl_tlsv1=yes</span><br><span class=\"line\">ssl_sslv2=no</span><br><span class=\"line\">ssl_sslv3=no</span><br><span class=\"line\">rsa_private_key_file=/etc/ssl/serverkey/vsftpd.pem</span><br><span class=\"line\">rsa_cert_file=/etc/ssl/serverkey/vsftpd.pem</span><br><span class=\"line\">allow_anon_ssl=no</span><br><span class=\"line\">force_local_logins_ssl=yes</span><br><span class=\"line\">force_local_data_ssl=yes</span><br><span class=\"line\">pasv_min_port=40000</span><br><span class=\"line\">pasv_max_port=50000</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart vsftpd\t<span class=\"comment\">//重启</span></span><br></pre></td></tr></table></figure>\n<p>图片打错了请按照上面文本打<br><img src=\"https://ymxpic.pages.dev/file/7ffae0727a56d9d65892a.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/7ffae0727a56d9d65892a.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br><img src=\"https://ymxpic.pages.dev/file/9b2f1e351d05e8dcd8e28.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/9b2f1e351d05e8dcd8e28.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"六、创建用户和根目录以及虚拟用户（详情看学习通ftp虚拟用户章节-这里不做过多解释）\"><a href=\"#六、创建用户和根目录以及虚拟用户（详情看学习通ftp虚拟用户章节-这里不做过多解释）\" class=\"headerlink\" title=\"六、创建用户和根目录以及虚拟用户（详情看学习通ftp虚拟用户章节 这里不做过多解释）\"></a>六、创建用户和根目录以及虚拟用户（详情看学习通ftp虚拟用户章节 这里不做过多解释）</h2><p>看不懂去看ppt</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# useradd webadmin -s /sbin/nologin </span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# useradd admin -s /sbin/nologin  </span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# passwd --stdin webadmin </span><br><span class=\"line\">更改用户 webadmin 的密码 。</span><br><span class=\"line\">root</span><br><span class=\"line\">passwd：所有的身份验证令牌已经成功更新。</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# passwd --stdin admin</span><br><span class=\"line\">更改用户 admin 的密码 。</span><br><span class=\"line\">root</span><br><span class=\"line\">passwd：所有的身份验证令牌已经成功更新。</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# vim /etc/vsftpd/vusr.txt </span><br><span class=\"line\">webadmin</span><br><span class=\"line\">root</span><br><span class=\"line\">admin</span><br><span class=\"line\">root</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# mkdir -p /<span class=\"keyword\">var</span>/ftp/pub/ /webdata</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# chmod <span class=\"number\">777</span> /webdata</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# chown webadmin /<span class=\"keyword\">var</span>/ftp/pub/ /webdata</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# rpm -qf /usr/bin/db_load</span><br><span class=\"line\">libdb-utils-<span class=\"number\">5.3</span><span class=\"number\">.21</span>-<span class=\"number\">24.</span>el7.x86_64</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# db_load -T -t hash -f /etc/vsftpd/vusr.txt /etc/vsftpd/vusr.db</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# file /etc/vsftpd/vusr.db</span><br><span class=\"line\">/etc/vsftpd/vusr.db: Berkeley <span class=\"title function_\">DB</span> <span class=\"params\">(Hash, version <span class=\"number\">9</span>, <span class=\"keyword\">native</span> <span class=\"type\">byte</span>-order)</span></span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# chmod <span class=\"number\">600</span> /etc/vsftpd/vusr.*</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# cp -p /etc/pam.d/vsftpd /etc/pam.d/vsftpd-vusr</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# vim /etc/pam.d/vsftpd-vusr</span><br><span class=\"line\">auth       sufficient   /lib64/security/pam_userdb.so db=/etc/vsftpd/vusr</span><br><span class=\"line\">account    sufficient   /lib64/security/pam_userdb.so db=/etc/vsftpd/vusr</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# vim /etc/vsftpd/vsftpd.conf </span><br><span class=\"line\">local_enable=yes</span><br><span class=\"line\">chroot_local_user=yes</span><br><span class=\"line\">pam_service_name=vsftpd-vusr</span><br><span class=\"line\">guest_enable=yes</span><br><span class=\"line\">guest_username=webadmin</span><br><span class=\"line\">user_config_dir=/etc/vsftpd/vconfig</span><br><span class=\"line\">virtual_use_local_privs=yes</span><br><span class=\"line\">allow_writeable_chroot=yes</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# mkdir /etc/vsftpd/vconfig/</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# vim /etc/vsftpd/vconfig/webadmin</span><br><span class=\"line\">local_root=/webdata</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# vim /etc/vsftpd/vconfig/admin</span><br><span class=\"line\">local_root=/webdata</span><br><span class=\"line\">write_enable=no</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# setsebool -P ftpd_full_access on</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# systemctl restart vsftpd</span><br></pre></td></tr></table></figure>\n<h2 id=\"七、-使用域名登录要在Dns服务器（Dns-Server）上正反向加上一条（略过）\"><a href=\"#七、-使用域名登录要在Dns服务器（Dns-Server）上正反向加上一条（略过）\" class=\"headerlink\" title=\"七、 使用域名登录要在Dns服务器（Dns Server）上正反向加上一条（略过）\"></a>七、 使用域名登录要在Dns服务器（Dns Server）上正反向加上一条（略过）</h2><p><img src=\"https://ymxpic.pages.dev/file/204c48d07d06906775de2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/204c48d07d06906775de2.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"八、任务需求后四项Ftp服务器（Ftp-Server）上修改配置文件\"><a href=\"#八、任务需求后四项Ftp服务器（Ftp-Server）上修改配置文件\" class=\"headerlink\" title=\"八、任务需求后四项Ftp服务器（Ftp Server）上修改配置文件\"></a>八、任务需求后四项Ftp服务器（Ftp Server）上修改配置文件</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/vsftpd/vsftpd.conf</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#允许WEB管理员上传和下载文件，但是禁止上传后缀名为.doc .docx .xlsx的文件；</span><br><span class=\"line\">deny_file=&#123;*.doc,*.docx,*.xlsx&#125;</span><br><span class=\"line\">#限制用户的下载最大速度为100kb/s；用于通过工具或者浏览器下载的最大速度不超过100kb/s；人数为<span class=\"number\">2</span>人；</span><br><span class=\"line\">local_max_rate=<span class=\"number\">102400</span></span><br><span class=\"line\">#最大同一IP在线</span><br><span class=\"line\">max_per_ip=<span class=\"number\">2</span></span><br><span class=\"line\">#一个IP地址同时登陆的用户进程/人数不超过<span class=\"number\">2</span>人。</span><br><span class=\"line\">max_clients=<span class=\"number\">2</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart vsftpd</span><br></pre></td></tr></table></figure>\n<h2 id=\"九、客户端（client1）测试\"><a href=\"#九、客户端（client1）测试\" class=\"headerlink\" title=\"九、客户端（client1）测试\"></a>九、客户端（client1）测试</h2><h3 id=\"1-安装ftp服务和FileZilla\"><a href=\"#1-安装ftp服务和FileZilla\" class=\"headerlink\" title=\"1. 安装ftp服务和FileZilla\"></a>1. 安装ftp服务和FileZilla</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install epel-release</span><br><span class=\"line\">yum -y install filezilla</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/fa01511cce2858dc00271.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/fa01511cce2858dc00271.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-创建测试文件\"><a href=\"#2-创建测试文件\" class=\"headerlink\" title=\"2. 创建测试文件\"></a>2. 创建测试文件</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@client</span> server]# mkdir /home/server/test <span class=\"comment\">/*server是我的用户名，看情况来*/</span></span><br><span class=\"line\">[root<span class=\"meta\">@client</span> server]# chmod <span class=\"number\">777</span>  /home/server/test</span><br><span class=\"line\">[root<span class=\"meta\">@client</span> server]# cd /home/server/test/</span><br><span class=\"line\">[root<span class=\"meta\">@client</span> test]# vim test.txt</span><br><span class=\"line\">[root<span class=\"meta\">@client</span> test]# vim test.doc</span><br><span class=\"line\">[root<span class=\"meta\">@client</span> test]# vim test.docx</span><br><span class=\"line\">[root<span class=\"meta\">@client</span> test]# vim test.xlsx</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-尝试域名带证书CA登录ftp\"><a href=\"#3-尝试域名带证书CA登录ftp\" class=\"headerlink\" title=\"3. 尝试域名带证书CA登录ftp\"></a>3. 尝试域名带证书CA登录ftp</h3><p><img src=\"https://ymxpic.pages.dev/file/cbc7ba60aae41fa13abc7.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/cbc7ba60aae41fa13abc7.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br><img src=\"https://ymxpic.pages.dev/file/9fefc4d3e02513f54f15f.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/9fefc4d3e02513f54f15f.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br><img src=\"https://ymxpic.pages.dev/file/45c7673c5fb3db94c02c4.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/45c7673c5fb3db94c02c4.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br>登录成功！</p>\n<h3 id=\"4-尝试禁止上传文件类型上传\"><a href=\"#4-尝试禁止上传文件类型上传\" class=\"headerlink\" title=\"4.  尝试禁止上传文件类型上传\"></a>4.  尝试禁止上传文件类型上传</h3><p><img src=\"https://ymxpic.pages.dev/file/1c3ebb110203217f2412e.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/1c3ebb110203217f2412e.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br>上传失败！</p>\n<h3 id=\"5-尝试下载文件\"><a href=\"#5-尝试下载文件\" class=\"headerlink\" title=\"5. 尝试下载文件\"></a>5. 尝试下载文件</h3><p><img src=\"https://ymxpic.pages.dev/file/9583e247ad1aa7c6720bc.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/9583e247ad1aa7c6720bc.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br>成功！</p>\n<h3 id=\"6-单IP多用户登录\"><a href=\"#6-单IP多用户登录\" class=\"headerlink\" title=\"6. 单IP多用户登录\"></a>6. 单IP多用户登录</h3><p><img src=\"https://ymxpic.pages.dev/file/6257891a3377c2add1e27.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/6257891a3377c2add1e27.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br>最多只能2个不能再多了！</p>\n<h2 id=\"至此，实验结束。\"><a href=\"#至此，实验结束。\" class=\"headerlink\" title=\"至此，实验结束。\"></a>至此，实验结束。</h2>",
            "tags": [
                "服务器",
                "Linux",
                "CentOS",
                "网络",
                "FTP"
            ]
        },
        {
            "id": "https://yeminxi.github.io/posts/f0f1ea42.html",
            "url": "https://yeminxi.github.io/posts/f0f1ea42.html",
            "title": "第六章 Centos 7 Linux配置web 实训任务：Apache服务器部署",
            "date_published": "2024-05-28T05:04:51.000Z",
            "content_html": "<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p><em><strong>&#x3D;&#x3D;前面的DNS一定要成功才能做！！！&#x3D;&#x3D;</strong></em><br>虚拟机需求：1台DNS服务器（Server）、1台Web服务器（Web Server）、1台客户端（Client1）</p>\n<blockquote>\n<p><strong>在第五章的基础上继续实训</strong></p>\n</blockquote>\n<h2 id=\"Apache服务器部署\"><a href=\"#Apache服务器部署\" class=\"headerlink\" title=\"Apache服务器部署\"></a>Apache服务器部署</h2><blockquote>\n<p>任务情境描述</p>\n<p>某公司需要搭建一台Web服务器，用于公司办公和网站宣传；还有另一台DNS服务器，用于实现Web服务器的域名解析。</p>\n</blockquote>\n<p> 网络拓扑图如下：<br><img src=\"https://ymxpic.pages.dev/file/f41d78cb8b0aed1fc5f16.png\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/f41d78cb8b0aed1fc5f16.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<blockquote>\n<p>部署信息如下：</p>\n<p>•        Server1为DNS服务器，IP地址为：192.168.1.10；</p>\n<p>•        Server2为Web服务器，IP地址为：192.168.1.100。</p>\n</blockquote>\n<blockquote>\n<h3 id=\"实训任务：\"><a href=\"#实训任务：\" class=\"headerlink\" title=\"实训任务：\"></a>实训任务：</h3><h4 id=\"任务1\"><a href=\"#任务1\" class=\"headerlink\" title=\"任务1\"></a>任务1</h4><p>搭建<a href=\"http://web1.mydomain.com的web1服务器,主目录是/var/www/web1%EF%BC%8C%E5%8F%AA%E5%85%81%E8%AE%B8192.168.1.0/24%E7%BD%91%E6%AE%B5%E7%9A%84%E4%B8%BB%E6%9C%BA%E8%AE%BF%E9%97%AE%E3%80%82\">http://web1.mydomain.com的web1服务器，主目录是/var/www/web1，只允许192.168.1.0/24网段的主机访问。</a></p>\n</blockquote>\n<blockquote>\n<h4 id=\"任务2\"><a href=\"#任务2\" class=\"headerlink\" title=\"任务2\"></a>任务2</h4><p>搭建基于8008端口号的安全服务器，可使用<a href=\"https://web2.mydomain.com:8008地址访问，主目录是/var/www/web2，使用CA颁发证书进行安全认证。\">https://web2.mydomain.com:8008地址访问，主目录是/var/www/web2，使用CA颁发证书进行安全认证。</a><br>“CSK Global Root CA”颁发机构颁发，网站证书信息如下：<br>    C &#x3D; CN<br>    ST &#x3D; China<br>    L &#x3D; GuangZhou<br>    O &#x3D; mydomain.com<br>    OU &#x3D; Operations Departments<br>    CN &#x3D; web2.mydomain.com</p>\n</blockquote>\n<blockquote>\n<h4 id=\"任务3-启动防火墙，SELinux设置为（Enforcing）。\"><a href=\"#任务3-启动防火墙，SELinux设置为（Enforcing）。\" class=\"headerlink\" title=\"任务3 启动防火墙，SELinux设置为（Enforcing）。\"></a>任务3 启动防火墙，SELinux设置为（Enforcing）。</h4></blockquote>\n<h2 id=\"一、配置Web服务器（Web-Server）的IP地址\"><a href=\"#一、配置Web服务器（Web-Server）的IP地址\" class=\"headerlink\" title=\"一、配置Web服务器（Web Server）的IP地址\"></a>一、配置Web服务器（Web Server）的IP地址</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">BOOTPROTO=static</span><br><span class=\"line\">IPADDR=192.168.1.100</span><br><span class=\"line\">GATEWAY=192.168.1.2</span><br><span class=\"line\">NETMASK=255.255.255.0</span><br><span class=\"line\">DNS1=192.168.1.10</span><br><span class=\"line\">DNS2=202.96.128.86</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/3588694d141b24cb86fd7.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/3588694d141b24cb86fd7.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"二、在Web服务器（Web-Server）上生成CA证书\"><a href=\"#二、在Web服务器（Web-Server）上生成CA证书\" class=\"headerlink\" title=\"二、在Web服务器（Web Server）上生成CA证书\"></a>二、在Web服务器（Web Server）上生成CA证书</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# cd /etc/pki/tls/certs/</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> certs]# make server.key</span><br><span class=\"line\"></span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> certs]# openssl rsa -in server.key -out server.key</span><br><span class=\"line\"></span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> certs]# make server.csr</span><br><span class=\"line\">umask <span class=\"number\">77</span> ; \\</span><br><span class=\"line\">/usr/bin/openssl req -utf8 -<span class=\"keyword\">new</span> -key server.key -out server.csr</span><br><span class=\"line\">You are about to be asked to enter information that will be incorporated</span><br><span class=\"line\">into your certificate request.</span><br><span class=\"line\">What you are about to enter is what is called a Distinguished Name or a DN.</span><br><span class=\"line\">There are quite a few fields but you can leave some blank</span><br><span class=\"line\">For some fields there will be a <span class=\"keyword\">default</span> value,</span><br><span class=\"line\">If you enter <span class=\"string\">&#x27;.&#x27;</span>, the field will be left blank.</span><br><span class=\"line\">-----</span><br><span class=\"line\">Country <span class=\"title function_\">Name</span> <span class=\"params\">(<span class=\"number\">2</span> letter code)</span> [XX]:CN</span><br><span class=\"line\">State or Province <span class=\"title function_\">Name</span> <span class=\"params\">(full name)</span> []:China</span><br><span class=\"line\">Locality <span class=\"title function_\">Name</span> <span class=\"params\">(eg, city)</span> [Default City]:GuangZhou</span><br><span class=\"line\">Organization <span class=\"title function_\">Name</span> <span class=\"params\">(eg, company)</span> [Default Company Ltd]:ymx.com</span><br><span class=\"line\">Organizational Unit <span class=\"title function_\">Name</span> <span class=\"params\">(eg, section)</span> []:Operations Deoartments</span><br><span class=\"line\">Common <span class=\"title function_\">Name</span> <span class=\"params\">(eg, your name or your server<span class=\"string\">&#x27;s hostname) []:web2.ymx.com</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"params\">Email Address []:</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"params\">Please enter the following &#x27;</span>extra<span class=\"string\">&#x27; attributes</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"params\">to be sent with your certificate request</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"params\">A challenge password []:</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"params\">An optional company name []:</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"params\">[root@webserver certs]# openssl x509 -in server.csr -out server.pem -req -signkey server.key -days 365</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"params\"></span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"params\">[root@webserver certs]# chmod 400 server.*</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"params\">[root@webserver certs]# yum -y install httpd mod_ssl</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"params\">[root@webserver certs]# systemctl restart httpd</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"params\"></span></span></span><br></pre></td></tr></table></figure>\n<h3 id=\"1-修改OpenSSL配置文件\"><a href=\"#1-修改OpenSSL配置文件\" class=\"headerlink\" title=\"1. 修改OpenSSL配置文件\"></a>1. 修改OpenSSL配置文件</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/pki/tls/openssl.cnf\t<span class=\"comment\">//打开OpenSSL配置文件修改以下</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">my-ca.crt</span><br><span class=\"line\">my-ca.crl</span><br><span class=\"line\">my-ca.key</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/b77d1cae565a551339b87.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/b77d1cae565a551339b87.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[ req_distinguished_name ]</span><br><span class=\"line\">countryName                     = Country Name (2 letter code)</span><br><span class=\"line\">countryName_default             = CN</span><br><span class=\"line\">countryName_min                 = 2</span><br><span class=\"line\">countryName_max                 = 2</span><br><span class=\"line\"></span><br><span class=\"line\">stateOrProvinceName             = State or Province Name (full name)</span><br><span class=\"line\">stateOrProvinceName_default     = China</span><br><span class=\"line\"></span><br><span class=\"line\">localityName                    = Locality Name (eg, city)</span><br><span class=\"line\">localityName_default            = GuangZhou</span><br><span class=\"line\"></span><br><span class=\"line\">0.organizationName              = Organization Name (eg, company)</span><br><span class=\"line\">0.organizationName_default      = ymx.com</span><br><span class=\"line\"></span><br><span class=\"line\"># we can do this but it is not needed normally :-)</span><br><span class=\"line\">#1.organizationName             = Second Organization Name (eg, company)</span><br><span class=\"line\">#1.organizationName_default     = World Wide Web Pty Ltd</span><br><span class=\"line\"></span><br><span class=\"line\">organizationalUnitName          = Organizational Unit Name (eg, section)</span><br><span class=\"line\">organizationalUnitName_default  = Operations Deoartments</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/22226e0fd346c29fb2244.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/22226e0fd346c29fb2244.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"2\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">保存退出 :wq</span><br><span class=\"line\"> cd /etc/pki/CA/\t<span class=\"comment\">//进入CA目录</span></span><br><span class=\"line\"> ls\t\t\t\t\t<span class=\"comment\">//查看目录</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2-生成CA文件\"><a href=\"#2-生成CA文件\" class=\"headerlink\" title=\"2. 生成CA文件\"></a>2. 生成CA文件</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">touch /etc/pki/CA/index.txt\t\t\t\t\t\t\t<span class=\"comment\">//新建一个放数据的文件</span></span><br><span class=\"line\">echo <span class=\"number\">01</span> &gt; /etc/pki/CA/serial\t\t\t\t\t\t<span class=\"comment\">//创建一个索引文件</span></span><br><span class=\"line\">openssl genrsa -out <span class=\"keyword\">private</span>/my-ca.key -des3 <span class=\"number\">2048</span>\t<span class=\"comment\">//生成CA文件，输入两次密码（请记住）</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"3-生成公钥文件\"><a href=\"#3-生成公钥文件\" class=\"headerlink\" title=\"3. 生成公钥文件\"></a>3. 生成公钥文件</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">openssl req -<span class=\"keyword\">new</span> -x509 -key <span class=\"keyword\">private</span>/my-ca.key -days <span class=\"number\">365</span> &gt; my-ca.crt\t<span class=\"comment\">//生成公钥文件</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/33e752e42d0501a1cd602.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/33e752e42d0501a1cd602.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"4-创建Server-key\"><a href=\"#4-创建Server-key\" class=\"headerlink\" title=\"4. 创建Server.key\"></a>4. 创建Server.key</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">openssl genrsa -des3 -out server.key <span class=\"number\">2048</span>\t<span class=\"comment\">//创建server.key</span></span><br><span class=\"line\">ls\t\t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//查看目录</span></span><br><span class=\"line\">openssl rsa -noout -text -in server.key\t\t<span class=\"comment\">//不输出以text文本查看server.key，输入保护密钥</span></span><br><span class=\"line\">cat server.key\t\t\t\t\t\t\t\t<span class=\"comment\">//查看</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/19e6298977aca66589e01.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/19e6298977aca66589e01.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">openssl req -<span class=\"keyword\">new</span> -key server.key -out server.csr\t<span class=\"comment\">//证书申请</span></span><br><span class=\"line\">ls\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//查看目录</span></span><br><span class=\"line\">openssl ca -in server.csr -out server.crt\t\t\t<span class=\"comment\">//生成公钥文件，输入密码，两次确认</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/a8bf6e2992bbfd4c2526c.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/a8bf6e2992bbfd4c2526c.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"三、在DNS服务器（Server）上添加记录\"><a href=\"#三、在DNS服务器（Server）上添加记录\" class=\"headerlink\" title=\"三、在DNS服务器（Server）上添加记录\"></a>三、在DNS服务器（Server）上添加记录</h2><h3 id=\"1-添加正向区域记录\"><a href=\"#1-添加正向区域记录\" class=\"headerlink\" title=\"1. 添加正向区域记录\"></a>1. 添加正向区域记录</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /<span class=\"keyword\">var</span>/named/ymx.com.zone\t\t<span class=\"comment\">//打开正向区域文件</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$TTL 1D</span><br><span class=\"line\">@       IN SOA  dns ymx.com. (</span><br><span class=\"line\">                                        0       ; serial</span><br><span class=\"line\">                                        1D      ; refresh</span><br><span class=\"line\">                                        1H      ; retry</span><br><span class=\"line\">                                        1W      ; expire</span><br><span class=\"line\">                                        3H )    ; minimum</span><br><span class=\"line\">        NS      dns</span><br><span class=\"line\">dns     A       192.168.1.10</span><br><span class=\"line\">www     A       192.168.1.100</span><br><span class=\"line\">web1    A       192.168.1.100\t\t\t\t//添加这两条</span><br><span class=\"line\">web2    A       192.168.1.100</span><br><span class=\"line\">mail    A       192.168.1.200</span><br><span class=\"line\">ftp     CNAME   www</span><br><span class=\"line\">mail    MX 10   mail</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/79f13a2e82c1327208e20.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/79f13a2e82c1327208e20.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-添加反向区域记录\"><a href=\"#2-添加反向区域记录\" class=\"headerlink\" title=\"2. 添加反向区域记录\"></a>2. 添加反向区域记录</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /<span class=\"keyword\">var</span>/named/<span class=\"number\">1.168</span><span class=\"number\">.192</span>.zone\t<span class=\"comment\">//打开反向区域配置文件</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$TTL 1D</span><br><span class=\"line\">@       IN SOA  dns ymx.com. (</span><br><span class=\"line\">                                        0       ; serial</span><br><span class=\"line\">                                        1D      ; refresh</span><br><span class=\"line\">                                        1H      ; retry</span><br><span class=\"line\">                                        1W      ; expire</span><br><span class=\"line\">                                        3H )    ; minimum</span><br><span class=\"line\">        NS      dns</span><br><span class=\"line\">dns     A       192.168.1.10</span><br><span class=\"line\">10      PTR     dns.ymx.com.</span><br><span class=\"line\">100     PTR     web1.ymx.com.\t\t\t\t//添加这两条</span><br><span class=\"line\">100     PTR     web2.ymx.com.</span><br><span class=\"line\">100     PTR     www.ymx.com.</span><br><span class=\"line\">100     PTR     ftp.ymx.com.</span><br><span class=\"line\">200     PTR     mail.ymx.com.</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/72bd3ad32aabc83beac7c.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/72bd3ad32aabc83beac7c.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart named\t\t\t<span class=\"comment\">//重启dns服务</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"四、在Web服务器（Web-Server）上安装httpd和mod-ssl服务\"><a href=\"#四、在Web服务器（Web-Server）上安装httpd和mod-ssl服务\" class=\"headerlink\" title=\"四、在Web服务器（Web Server）上安装httpd和mod_ssl服务\"></a>四、在Web服务器（Web Server）上安装httpd和mod_ssl服务</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install http mod_ssl\t\t<span class=\"comment\">//安装</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/8c3e6d256b9c4e2debcaa.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/8c3e6d256b9c4e2debcaa.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"1-修改ssl配置文件\"><a href=\"#1-修改ssl配置文件\" class=\"headerlink\" title=\"1.修改ssl配置文件\"></a>1.修改ssl配置文件</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/httpd/conf.d/ssl.conf\t<span class=\"comment\">//修改配置文件</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Listen 8008 https\t\t\t\t\t\t\t\t\t//监听8008端口</span><br><span class=\"line\">&lt;VirtualHost *:8008&gt;\t\t\t\t\t\t\t\t//虚拟主机头</span><br><span class=\"line\">ServerName web2.ymx.com:8008\t\t\t\t\t\t//服务器名</span><br><span class=\"line\">DocumentRoot &quot;/var/www/web2&quot;\t\t\t\t\t\t//目录</span><br><span class=\"line\">SSLCertificateFile /etc/pki/CA/server.crt\t\t\t//ca证书文件</span><br><span class=\"line\">SSLCertificateKeyFile /etc/pki/CA/server.key \t\t//ca公钥文件</span><br><span class=\"line\">SSLCACertificateFile /etc/pki/CA/server.crt\t\t\t//ca私钥文件</span><br><span class=\"line\">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/ed674871c8806455ad6fd.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/ed674871c8806455ad6fd.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-新建网页\"><a href=\"#2-新建网页\" class=\"headerlink\" title=\"2. 新建网页\"></a>2. 新建网页</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@webserver</span> CA]# mkdir /<span class=\"keyword\">var</span>/www/web1</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> CA]# mkdir /<span class=\"keyword\">var</span>/www/web2</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> CA]# vim /<span class=\"keyword\">var</span>/www/html/index.html</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> CA]# vim /<span class=\"keyword\">var</span>/www/web1/index.html</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> CA]# vim /<span class=\"keyword\">var</span>/www/web2/index.html</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-新建虚拟主机\"><a href=\"#3-新建虚拟主机\" class=\"headerlink\" title=\"3. 新建虚拟主机\"></a>3. 新建虚拟主机</h3> <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/httpd/conf.d/vhost.conf</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;VirtualHost www.ymx.com&gt;</span><br><span class=\"line\">ServerName www.ymx.com</span><br><span class=\"line\">DocumentRoot &quot;/var/www/html&quot;</span><br><span class=\"line\">&lt;/VirtualHost&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;VirtualHost web1.ymx.com&gt;</span><br><span class=\"line\">ServerName web1.ymx.com</span><br><span class=\"line\">DocumentRoot &quot;/var/www/web1&quot;</span><br><span class=\"line\">&lt;/VirtualHost&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;Directory &#x27;/var/www/web1&#x27;&gt;</span><br><span class=\"line\">Options Indexes FollowSymLinks</span><br><span class=\"line\">AllowOverride None</span><br><span class=\"line\">Order allow,deny</span><br><span class=\"line\">allow from 192.168.1.0/24\t//只允许192.168.1.0/24 通过</span><br><span class=\"line\">&lt;/Directory&gt;</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/3398ac156559026841d36.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/3398ac156559026841d36.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# systemctl restart httpd\t\t\t\t\t<span class=\"comment\">//重启http服务</span></span><br><span class=\"line\">Enter SSL pass phrase <span class=\"keyword\">for</span> web2.ymx.com:<span class=\"number\">8008</span> (RSA) : ****\t\t\t<span class=\"comment\">//输入密码</span></span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# systemctl enable httpd\t\t\t\t\t<span class=\"comment\">//开机自启</span></span><br><span class=\"line\">Created symlink from /etc/systemd/system/multi-user.target.wants/httpd.service to /usr/lib/systemd/system/httpd.service.</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"5-修改httpd-conf配置文件\"><a href=\"#5-修改httpd-conf配置文件\" class=\"headerlink\" title=\"5. 修改httpd.conf配置文件\"></a>5. 修改httpd.conf配置文件</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@webserver</span> CA]# vim /etc/httpd/conf/httpd.conf </span><br><span class=\"line\">ServerName www.ymx.com:<span class=\"number\">80</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/dbfdaf9ea0c91291785a8.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/dbfdaf9ea0c91291785a8.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"6-防火墙设置\"><a href=\"#6-防火墙设置\" class=\"headerlink\" title=\"6. 防火墙设置\"></a>6. 防火墙设置</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@webserver</span> CA]# firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-service=http\t<span class=\"comment\">//开启http</span></span><br><span class=\"line\">success</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> CA]# firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-service=https\t<span class=\"comment\">//开启https</span></span><br><span class=\"line\">success</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> CA]# firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-port=<span class=\"number\">8008</span>/tcp\t<span class=\"comment\">//开启8008端口</span></span><br><span class=\"line\">success</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> CA]# firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-port=<span class=\"number\">8008</span>/udp</span><br><span class=\"line\">success</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> CA]# firewall-cmd --reload \t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//重启防火墙</span></span><br><span class=\"line\">success</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> CA]# netstat -an | grep :<span class=\"number\">8008</span>\t\t\t\t\t\t\t\t\t<span class=\"comment\">//查看端口</span></span><br><span class=\"line\">tcp6       <span class=\"number\">0</span>      <span class=\"number\">0</span> :::<span class=\"number\">8008</span>                 :::*                    LISTEN     </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"7-复制证书文件\"><a href=\"#7-复制证书文件\" class=\"headerlink\" title=\"7. 复制证书文件\"></a>7. 复制证书文件</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@webserver</span> CA]# cd /etc/pki/CA</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> CA]# cp my-ca.crt /<span class=\"keyword\">var</span>/www/web1/</span><br></pre></td></tr></table></figure>\n<h3 id=\"8-客户端（Client-1）导入CA证书\"><a href=\"#8-客户端（Client-1）导入CA证书\" class=\"headerlink\" title=\"8. 客户端（Client 1）导入CA证书\"></a>8. 客户端（Client 1）导入CA证书</h3><h4 id=\"打开浏览器输入地址http-web1-ymx-com-my-ca-crt-下载证书文件并导入证书\"><a href=\"#打开浏览器输入地址http-web1-ymx-com-my-ca-crt-下载证书文件并导入证书\" class=\"headerlink\" title=\"打开浏览器输入地址http://web1.ymx.com/my-ca.crt 下载证书文件并导入证书\"></a>打开浏览器输入地址<a href=\"http://web1.ymx.com/my-ca.crt\">http://web1.ymx.com/my-ca.crt</a> 下载证书文件并导入证书</h4><p><img src=\"https://ymxpic.pages.dev/file/9ec2f9471a9bc62b2dc9c.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/9ec2f9471a9bc62b2dc9c.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"9-最终效果\"><a href=\"#9-最终效果\" class=\"headerlink\" title=\"9. 最终效果\"></a>9. 最终效果</h3><p><strong>http：&#x2F;&#x2F;web1.ymx.com<br><a href=\"https://web2.ymx.com:8008/\">https://web2.ymx.com:8008</a></strong><br><img src=\"https://ymxpic.pages.dev/file/0178b6492fb0d7a243482.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/0178b6492fb0d7a243482.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"至此，实验结束\"><a href=\"#至此，实验结束\" class=\"headerlink\" title=\"至此，实验结束\"></a>至此，实验结束</h2>",
            "tags": [
                "服务器",
                "Linux",
                "CentOS",
                "Apache"
            ]
        },
        {
            "id": "https://yeminxi.github.io/posts/974b3ed7.html",
            "url": "https://yeminxi.github.io/posts/974b3ed7.html",
            "title": "第五章 Centos 7 Linux配置dns 实训任务：部署DNS服务器",
            "date_published": "2024-05-28T04:32:51.000Z",
            "content_html": "<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>虚拟机需求：1台服务器（Server）、1台客户端（Client1）</p>\n<blockquote>\n<p><strong>在第四章的基础上继续实训</strong></p>\n</blockquote>\n<h2 id=\"部署DNS服务器\"><a href=\"#部署DNS服务器\" class=\"headerlink\" title=\"部署DNS服务器\"></a>部署DNS服务器</h2><blockquote>\n<h3 id=\"任务情境描述\"><a href=\"#任务情境描述\" class=\"headerlink\" title=\"任务情境描述\"></a>任务情境描述</h3><p>某公司要求在内部网络部署DNS服务器，用内部DNS服务器为内部网络中的计算机提供内部网络和Internet的域名解析服务。</p>\n</blockquote>\n<h3 id=\"网络拓扑图如下：\"><a href=\"#网络拓扑图如下：\" class=\"headerlink\" title=\"网络拓扑图如下：\"></a>网络拓扑图如下：</h3><p><img src=\"https://ymxpic.pages.dev/file/9a3bf5e11c452db3f7c9d.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/9a3bf5e11c452db3f7c9d.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<blockquote>\n<h3 id=\"环境说明：\"><a href=\"#环境说明：\" class=\"headerlink\" title=\"环境说明：\"></a>环境说明：</h3><p>（1） server安装CentOS 7基础设施服务器</p>\n<p>（2） client安装CentOS 7桌面环境</p>\n<p>（3） server、client均已配置网络和主机名（配置了第四章就不用配置了）</p>\n</blockquote>\n<blockquote>\n<h3 id=\"部署信息如下：\"><a href=\"#部署信息如下：\" class=\"headerlink\" title=\"部署信息如下：\"></a>部署信息如下：</h3><p>（1） 公司的DNS域名为 ymx.com（或自己命名）&#x2F;&#x2F;这里我用了自己的，用老师的是myhost.com下面表格也要跟着改</p>\n<p>（2） 名称解释要求如下表所示：</p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th>角色</th>\n<th>主机名</th>\n<th>IP地址</th>\n<th>备注</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Web服务器</td>\n<td><a href=\"http://www.ymx.com/\">www.ymx.com</a></td>\n<td>192.168.1.100</td>\n<td></td>\n</tr>\n<tr>\n<td>FTP服务器</td>\n<td>ftp.ymx.com</td>\n<td>192.168.1.100</td>\n<td>配置别名记录</td>\n</tr>\n<tr>\n<td>邮件服务器</td>\n<td>mail.ymx.com</td>\n<td>192.168.1.200</td>\n<td>配置相应的交换记录</td>\n</tr>\n<tr>\n<td>DNS服务器</td>\n<td>dns.ymx.com</td>\n<td>192.168.1.10</td>\n<td>DNS服务器</td>\n</tr>\n</tbody></table>\n<blockquote>\n<h3 id=\"任务1（用前面的就不用重新配置了）\"><a href=\"#任务1（用前面的就不用重新配置了）\" class=\"headerlink\" title=\"任务1（用前面的就不用重新配置了）\"></a>任务1（用前面的就不用重新配置了）</h3><p>根据上图中的网络图谱配置实训环境</p>\n<p>（1） 修改计算机名</p>\n<p>（2） 配置网络</p>\n<p>（3）开启防火墙，添加对应的服务</p>\n</blockquote>\n<blockquote>\n<h3 id=\"任务2\"><a href=\"#任务2\" class=\"headerlink\" title=\"任务2\"></a>任务2</h3><p>在server1上安装DNS服务，并将其配置为主DNS服务器</p>\n<p>（1） 安装DNS服务</p>\n<p>（2） 创建正向查找区域，并根据上表提供的信息在区域中添加资源记录；<br>          创建反向查找区域，并根据上表提供的信息在区域中添加资源记录；</p>\n<p>（3） 检查区域数据文件语法错误</p>\n<p>（4） 启动&#x2F;重启DNS服务</p>\n<p>（5） 开启防火墙，添加对应的服务</p>\n</blockquote>\n<blockquote>\n<h3 id=\"任务3\"><a href=\"#任务3\" class=\"headerlink\" title=\"任务3\"></a>任务3</h3><p>使用client对主DNS服务器进行测试</p>\n<p>（1） client网络配置</p>\n<p>（2） 在客户端执行DNS域名查询测试，对主&#x2F;辅DNS均进行域名查询测试（可使用命令指令使用主NDS或服务DNS进行查询）</p>\n</blockquote>\n<h2 id=\"一、在服务器（Server）上安装DNS服务\"><a href=\"#一、在服务器（Server）上安装DNS服务\" class=\"headerlink\" title=\"一、在服务器（Server）上安装DNS服务\"></a>一、在服务器（Server）上安装DNS服务</h2><h3 id=\"1-确保良好的网络连接也要保证设备的联网\"><a href=\"#1-确保良好的网络连接也要保证设备的联网\" class=\"headerlink\" title=\"1. 确保良好的网络连接也要保证设备的联网\"></a>1. 确保良好的网络连接也要保证设备的联网</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum list installed | grep bind \t\t\t\t\\\\查看是否安装了dns服务</span><br><span class=\"line\">yum -y install bind\t\t\t\t\t\t\t\\\\安装dns服务</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/5ecdc267b84b5e1eecf9b.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/5ecdc267b84b5e1eecf9b.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-启动服务\"><a href=\"#2-启动服务\" class=\"headerlink\" title=\"2. 启动服务\"></a>2. 启动服务</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start named\t\t<span class=\"comment\">//启动dns服务</span></span><br><span class=\"line\">systemctl enable named\t\t<span class=\"comment\">//开机自启dns服务</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/b0450986f32adae814627.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/b0450986f32adae814627.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"2\"></p>\n<h3 id=\"3-防火墙配置\"><a href=\"#3-防火墙配置\" class=\"headerlink\" title=\"3. 防火墙配置\"></a>3. 防火墙配置</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-port=<span class=\"number\">53</span>/tcp\t<span class=\"comment\">//开启53端口</span></span><br><span class=\"line\">firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-port=<span class=\"number\">53</span>/udp</span><br><span class=\"line\">firewall-cmd --reload\t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//重启防火墙</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/39be9522b5ad2f238d32f.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/39be9522b5ad2f238d32f.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"二、在服务器（Server）上配置dns服务\"><a href=\"#二、在服务器（Server）上配置dns服务\" class=\"headerlink\" title=\"二、在服务器（Server）上配置dns服务\"></a>二、在服务器（Server）上配置dns服务</h2><h3 id=\"1-配置全局服务实现高速缓存\"><a href=\"#1-配置全局服务实现高速缓存\" class=\"headerlink\" title=\"1.配置全局服务实现高速缓存\"></a>1.配置全局服务实现高速缓存</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/named.conf\t\t<span class=\"comment\">//打开配置文件进行如下修改</span></span><br><span class=\"line\">named-checkconf\t\t\t<span class=\"comment\">//检查语法</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/86b0e18dd3c088a584d48.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/86b0e18dd3c088a584d48.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">listen-on port 53 &#123; any; &#125;;\t\t\t\t\t\t\t//改为any，named监听所有IP地址</span><br><span class=\"line\">allow-query     &#123; any; &#125;;\t\t\t\t\t\t\t//改为any，接受所有客户端的查询</span><br><span class=\"line\">forwarders      &#123;202.96.128.86;202.96.128.166;&#125;;\t//添加该项，配置转发器</span><br><span class=\"line\">dnssec-enable no;\t\t\t\t\t\t\t\t\t//改为no，禁用dnssec</span><br><span class=\"line\">dnssec-validation no;\t\t\t\t\t\t\t\t</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/f8db812aa6e49d4dc1883.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/f8db812aa6e49d4dc1883.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<blockquote>\n<p>检查语法发现错误，是因为我第22行打错单词了，重新编辑改回去就不报错了。</p>\n</blockquote>\n<h3 id=\"2-创建定义DNS服务器正向、反向查找区域\"><a href=\"#2-创建定义DNS服务器正向、反向查找区域\" class=\"headerlink\" title=\"2. 创建定义DNS服务器正向、反向查找区域\"></a>2. 创建定义DNS服务器正向、反向查找区域</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/named.conf\t\t<span class=\"comment\">//打开配置文件进行如下修改</span></span><br><span class=\"line\">named-checkconf\t\t\t<span class=\"comment\">//检查语法</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/4b50564b4ea5063d89f52.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/4b50564b4ea5063d89f52.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">zone &quot;ymx.com&quot; IN &#123;\t\t\t\t\t\t\t//DNS域名</span><br><span class=\"line\">        type master;\t\t\t\t\t\t//区域类型为主要区域</span><br><span class=\"line\">        file &quot;ymx.com.zone&quot;;\t\t\t\t//区域数据存储文件名，位置默认为 /var/named 目录</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">zone &quot;1.168.192.in-addr.arpa&quot; IN &#123;\t\t\t//子网地址需要反写，后缀是固定的</span><br><span class=\"line\">        type master;\t\t\t\t\t\t//区域类型为主要区域</span><br><span class=\"line\">        file &quot;1.168.192.zone&quot;;\t\t\t\t//区域数据存储文件名，位置默认为 /var/named 目录</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>如是按照题目（myhost.com）来的话如下:</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">zone &quot;myhost.com&quot; IN &#123;\t\t\t\t\t\t\t//DNS域名</span><br><span class=\"line\">        type master;\t\t\t\t\t\t//区域类型为主要区域</span><br><span class=\"line\">        file &quot;myhost.com.zone&quot;;\t\t\t\t//区域数据存储文件名，位置默认为 /var/named 目录</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">zone &quot;1.168.192.in-addr.arpa&quot; IN &#123;\t\t\t//子网地址需要反写，后缀是固定的</span><br><span class=\"line\">        type master;\t\t\t\t\t\t//区域类型为主要区域</span><br><span class=\"line\">        file &quot;1.168.192.zone&quot;;\t\t\t\t//区域数据存储文件名，位置默认为 /var/named 目录</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-创建区域数据文件\"><a href=\"#3-创建区域数据文件\" class=\"headerlink\" title=\"3. 创建区域数据文件\"></a>3. 创建区域数据文件</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /<span class=\"keyword\">var</span>/named</span><br><span class=\"line\">cp -a named.localhost ymx.com.zone\t\t<span class=\"comment\">//创建正向区域数据文件</span></span><br><span class=\"line\">cp -a named.loopback <span class=\"number\">1.168</span><span class=\"number\">.192</span>.zone\t\t<span class=\"comment\">//创建反向区域数据文件</span></span><br><span class=\"line\">systemctl restart named\t\t\t\t\t<span class=\"comment\">//重启dns服务</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>如是按照题目（myhost.com）来的话如下:</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /<span class=\"keyword\">var</span>/named</span><br><span class=\"line\">cp -a named.localhost myhost.com.zone\t<span class=\"comment\">//创建正向区域数据文件</span></span><br><span class=\"line\">cp -a named.loopback <span class=\"number\">1.168</span><span class=\"number\">.192</span>.zone\t\t<span class=\"comment\">//创建反向区域数据文件</span></span><br><span class=\"line\">systemctl restart named\t\t\t\t\t<span class=\"comment\">//重启dns服务</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"4-编辑正向区域数据文件\"><a href=\"#4-编辑正向区域数据文件\" class=\"headerlink\" title=\"4. 编辑正向区域数据文件\"></a>4. 编辑正向区域数据文件</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim ymx.com.zone\t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//编辑正向区域数据</span></span><br><span class=\"line\">named-checkzone ymx.com.zone  /<span class=\"keyword\">var</span>/named/ymx.com.zone\t<span class=\"comment\">//检查语法</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/2c79ad9474f20745df0c5.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/2c79ad9474f20745df0c5.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$TTL 1D</span><br><span class=\"line\">@       IN SOA  dns ymx.com. (\t\t\t\t\t\t\t\t\t//区域授权服务器</span><br><span class=\"line\">                                        0       ; serial</span><br><span class=\"line\">                                        1D      ; refresh</span><br><span class=\"line\">                                        1H      ; retry</span><br><span class=\"line\">                                        1W      ; expire</span><br><span class=\"line\">                                        3H )    ; minimum</span><br><span class=\"line\">        NS      dns</span><br><span class=\"line\">dns     A       192.168.1.10\t\t\t\t\t\t\t\t\t//名称服务器记录</span><br><span class=\"line\">www     A       192.168.1.100\t\t\t\t\t\t\t\t\t//主机记录</span><br><span class=\"line\">mail    A       192.168.1.200</span><br><span class=\"line\">ftp     CNAME   www\t\t\t\t\t\t\t\t\t\t\t\t//别名记录</span><br><span class=\"line\">mail    MX 10   mail\t\t\t\t\t\t\t\t\t\t\t//邮箱交换器记录</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>如是按照题目（myhost.com）来的话如下:</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim myhost.com.zone\t\t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//编辑正向区域数据</span></span><br><span class=\"line\">named-checkzone myhost.com.zone  /<span class=\"keyword\">var</span>/named/myhost.com.zone\t<span class=\"comment\">//检查语法</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$TTL 1D</span><br><span class=\"line\">@       IN SOA  server myhost.com. (\t\t\t\t\t\t\t\t\t//区域授权服务器</span><br><span class=\"line\">                                        0       ; serial</span><br><span class=\"line\">                                        1D      ; refresh</span><br><span class=\"line\">                                        1H      ; retry</span><br><span class=\"line\">                                        1W      ; expire</span><br><span class=\"line\">                                        3H )    ; minimum</span><br><span class=\"line\">        NS      server</span><br><span class=\"line\">server  A       192.168.1.10\t\t\t\t\t\t\t\t\t//名称服务器记录</span><br><span class=\"line\">www     A       192.168.1.100\t\t\t\t\t\t\t\t\t//主机记录</span><br><span class=\"line\">mail    A       192.168.1.200</span><br><span class=\"line\">ftp     CNAME   www\t\t\t\t\t\t\t\t\t\t\t\t//别名记录</span><br><span class=\"line\">mail    MX 10   mail\t\t\t\t\t\t\t\t\t\t\t//邮箱交换器记录</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/d959c88b2a0ba4d313c6d.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/d959c88b2a0ba4d313c6d.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"5-编辑反向区域数据文件\"><a href=\"#5-编辑反向区域数据文件\" class=\"headerlink\" title=\"5. 编辑反向区域数据文件\"></a>5. 编辑反向区域数据文件</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim <span class=\"number\">1.168</span><span class=\"number\">.192</span>.zone \t\t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//编辑反向区域数据</span></span><br><span class=\"line\">named-checkzone <span class=\"number\">1.168</span><span class=\"number\">.192</span>.zone  /<span class=\"keyword\">var</span>/named/<span class=\"number\">1.168</span><span class=\"number\">.192</span>.zone\t<span class=\"comment\">//检查语法</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/0e74a1c1bf31a363b73fc.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/0e74a1c1bf31a363b73fc.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$TTL 1D</span><br><span class=\"line\">@       IN SOA  dns ymx.com. (\t\t\t\t\t\t\t\t//区域授权的DNS服务器</span><br><span class=\"line\">                                        0       ; serial</span><br><span class=\"line\">                                        1D      ; refresh</span><br><span class=\"line\">                                        1H      ; retry</span><br><span class=\"line\">                                        1W      ; expire</span><br><span class=\"line\">                                        3H )    ; minimum</span><br><span class=\"line\">        NS      dns\t\t\t\t\t\t\t\t\t\t\t//名称服务器记录</span><br><span class=\"line\">dns     A       192.168.1.10\t\t\t\t\t\t\t\t//指针记录</span><br><span class=\"line\">10      PTR     dns.ymx.com.</span><br><span class=\"line\">100     PTR     www.ymx.com.</span><br><span class=\"line\">100     PTR     ftp.ymx.com.</span><br><span class=\"line\">200     PTR     mail.ymx.com.</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/85bd8de0c3edd41d5bf9c.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/85bd8de0c3edd41d5bf9c.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<blockquote>\n<p>如是按照题目（myhost.com）来的话如下:</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim <span class=\"number\">1.168</span><span class=\"number\">.192</span>.zone \t\t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//编辑反向区域数据</span></span><br><span class=\"line\">named-checkzone <span class=\"number\">1.168</span><span class=\"number\">.192</span>.zone  /<span class=\"keyword\">var</span>/named/<span class=\"number\">1.168</span><span class=\"number\">.192</span>.zone\t<span class=\"comment\">//检查语法</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$TTL 1D</span><br><span class=\"line\">@       IN SOA  server myhost.com. (\t\t\t\t\t\t\t//区域授权的DNS服务器</span><br><span class=\"line\">                                        0       ; serial</span><br><span class=\"line\">                                        1D      ; refresh</span><br><span class=\"line\">                                        1H      ; retry</span><br><span class=\"line\">                                        1W      ; expire</span><br><span class=\"line\">                                        3H )    ; minimum</span><br><span class=\"line\">        NS      server\t\t\t\t\t\t\t\t\t\t\t//名称服务器记录</span><br><span class=\"line\">server  A       192.168.1.10\t\t\t\t\t\t\t\t\t//指针记录</span><br><span class=\"line\">10      PTR     server.myhost.com.\t\t\t\t\t\t</span><br><span class=\"line\">100     PTR     www.myhost.com.</span><br><span class=\"line\">100     PTR     ftp.myhost.com.</span><br><span class=\"line\">200     PTR     mail.myhost.com.</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>若语法检查无错误<br><img src=\"https://ymxpic.pages.dev/file/224df854a0c755daf9fd2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/224df854a0c755daf9fd2.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart named\t\t<span class=\"comment\">//重启dns服务，且无返回信息则成功</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/97139188680461f22a0fb.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/97139188680461f22a0fb.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"三、在客户端（Client1）上进行测试\"><a href=\"#三、在客户端（Client1）上进行测试\" class=\"headerlink\" title=\"三、在客户端（Client1）上进行测试\"></a>三、在客户端（Client1）上进行测试</h2><h3 id=\"1-重新获取\"><a href=\"#1-重新获取\" class=\"headerlink\" title=\"1. 重新获取\"></a>1. 重新获取</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dhclient -r\t\t\t\t\t\t<span class=\"comment\">//释放租约</span></span><br><span class=\"line\">dhclient\t\t\t\t\t\t<span class=\"comment\">//重新获取租约</span></span><br><span class=\"line\">tail /etc/resolv.conf\t\t\t<span class=\"comment\">//查看客户端使用的DNS服务器</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/c58f7e03dfb8e3bc9fabd.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/c58f7e03dfb8e3bc9fabd.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-nslookup非交互式操作\"><a href=\"#2-nslookup非交互式操作\" class=\"headerlink\" title=\"2. nslookup非交互式操作\"></a>2. nslookup非交互式操作</h3><h4 id=\"2-1-测试正向解析\"><a href=\"#2-1-测试正向解析\" class=\"headerlink\" title=\"2.1 测试正向解析\"></a>2.1 测试正向解析</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nslookup www.ymx.com</span><br><span class=\"line\">nslookup ftp.ymx.com</span><br><span class=\"line\">nslookup mail.ymx.com</span><br><span class=\"line\">nslookup www.baidu.com</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/bc4dce8064bee257697bd.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/bc4dce8064bee257697bd.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h4 id=\"2-2-测试反向解析\"><a href=\"#2-2-测试反向解析\" class=\"headerlink\" title=\"2.2 测试反向解析\"></a>2.2 测试反向解析</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nslookup <span class=\"number\">202.108</span><span class=\"number\">.22</span><span class=\"number\">.5</span></span><br><span class=\"line\">nslookup <span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.10</span></span><br><span class=\"line\">nslookup <span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.100</span></span><br><span class=\"line\">nslookup <span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.200</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/bedfef08fa7af8e7af35e.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/bedfef08fa7af8e7af35e.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"3-nslookup交互式操作（知道就好不用做）\"><a href=\"#3-nslookup交互式操作（知道就好不用做）\" class=\"headerlink\" title=\"3. nslookup交互式操作（知道就好不用做）\"></a>3. nslookup交互式操作（知道就好不用做）</h3><h4 id=\"3-1-查看所有配置\"><a href=\"#3-1-查看所有配置\" class=\"headerlink\" title=\"3.1 查看所有配置\"></a>3.1 查看所有配置</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nslookup</span><br><span class=\"line\">set all</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/0d52dfe4f10aa0e388467.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/0d52dfe4f10aa0e388467.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h4 id=\"3-2-查询主机名www-ymx-com\"><a href=\"#3-2-查询主机名www-ymx-com\" class=\"headerlink\" title=\"3.2 查询主机名www.ymx.com\"></a>3.2 查询主机名<a href=\"http://www.ymx.com/\">www.ymx.com</a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">www.ymx.com</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/3db5d9ca1f855e5b61f8b.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/3db5d9ca1f855e5b61f8b.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h4 id=\"3-3-查询ymx-com区域授权记录\"><a href=\"#3-3-查询ymx-com区域授权记录\" class=\"headerlink\" title=\"3.3 查询ymx.com区域授权记录\"></a>3.3 查询ymx.com区域授权记录</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">set type=soa</span><br><span class=\"line\">ymx.com</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/b4b78740bc024a8a81610.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/b4b78740bc024a8a81610.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h4 id=\"3-4-查询1-168-192-in-addr-arpa区域授权记录\"><a href=\"#3-4-查询1-168-192-in-addr-arpa区域授权记录\" class=\"headerlink\" title=\"3.4 查询1.168.192.in-addr.arpa区域授权记录\"></a>3.4 查询1.168.192.in-addr.arpa区域授权记录</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1.168</span><span class=\"number\">.192</span>.in-addr.arpa</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/cde1584ef3d609a9520df.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/cde1584ef3d609a9520df.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h4 id=\"3-5-查询邮箱交换器记录\"><a href=\"#3-5-查询邮箱交换器记录\" class=\"headerlink\" title=\"3.5 查询邮箱交换器记录\"></a>3.5 查询邮箱交换器记录</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">set type=mx</span><br><span class=\"line\">ymx.com</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/663745b9f94e4326cad32.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/663745b9f94e4326cad32.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h4 id=\"3-6-查询名称服务器记录\"><a href=\"#3-6-查询名称服务器记录\" class=\"headerlink\" title=\"3.6 查询名称服务器记录\"></a>3.6 查询名称服务器记录</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">set type=ns</span><br><span class=\"line\">ymx.com</span><br><span class=\"line\"><span class=\"number\">1.168</span><span class=\"number\">.192</span>.in-addr.arpa</span><br><span class=\"line\">exit\t\t\t\t\t\t\t<span class=\"comment\">//退出</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/04bad564727027d52486b.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/04bad564727027d52486b.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"至此，实验结束。\"><a href=\"#至此，实验结束。\" class=\"headerlink\" title=\"至此，实验结束。\"></a>至此，实验结束。</h2>",
            "tags": [
                "服务器",
                "运维",
                "Linux",
                "CentOS",
                "网络",
                "DNS"
            ]
        },
        {
            "id": "https://yeminxi.github.io/posts/6d7d2758.html",
            "url": "https://yeminxi.github.io/posts/6d7d2758.html",
            "title": "第四章 Centos 7 Linux配置dhcp 实训任务1：使用DHCP中继部署多子网环境",
            "date_published": "2024-05-28T04:05:51.000Z",
            "content_html": "<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>虚拟机需求：1台服务器（Server）、1台中继服务器（Relay Server）、2台客户端（Client1、Client2）</p>\n<blockquote>\n<p><strong>在第三章的基础上继续实训</strong></p>\n</blockquote>\n<h2 id=\"实训任务1：DHCP中继部署\"><a href=\"#实训任务1：DHCP中继部署\" class=\"headerlink\" title=\"实训任务1：DHCP中继部署\"></a>实训任务1：DHCP中继部署</h2><blockquote>\n<p>任务情境描述：为校园网1号办公楼和2号办公楼的网络设备分配地址，客户端Client1和Client2可通过DHCP服务器分配地址。</p>\n</blockquote>\n<p>网络拓扑如下：<br><img src=\"https://ymxpic.pages.dev/file/2c4a6b1900d6ad809395d.png\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/2c4a6b1900d6ad809395d.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<blockquote>\n<h3 id=\"任务要求：\"><a href=\"#任务要求：\" class=\"headerlink\" title=\"任务要求：\"></a>任务要求：</h3><p>1号楼地址池范围：192.168.1.110-192.168.1.190&#x2F;24，网关：192.168.1.2；</p>\n<p>2号楼地址池范围：192.168.2.100-192.168.2.200&#x2F;24，网关：192.168.2.254；</p>\n<p>域名解析服务器：192.168.1.10和192.168.1.11；</p>\n<p>为Client1动态分配地址，Client2用户分配固定地址，地址为 192.168.2.188&#x2F;24。</p>\n</blockquote>\n<blockquote>\n<h3 id=\"检查要求：-会查看客户端和服务器端的租约文件，并理解租约信息。\"><a href=\"#检查要求：-会查看客户端和服务器端的租约文件，并理解租约信息。\" class=\"headerlink\" title=\"检查要求： 会查看客户端和服务器端的租约文件，并理解租约信息。\"></a>检查要求： 会查看客户端和服务器端的租约文件，并理解租约信息。</h3></blockquote>\n<blockquote>\n<h3 id=\"任务提示：\"><a href=\"#任务提示：\" class=\"headerlink\" title=\"任务提示：\"></a>任务提示：</h3><p>DHCP Relay设备配置两张网卡，分别为192.168.1.254和192.168.2.10</p>\n<p>并在&#x2F;etc&#x2F;sysctl.conf中添加：</p>\n<p>net.ipv4.ip_forward&#x3D;1            &#x2F;&#x2F;全网通</p>\n<p>保存后，重新加载系统参数</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#sysctl -p </span><br></pre></td></tr></table></figure>\n</blockquote>\n<blockquote>\n<h3 id=\"注意事项：\"><a href=\"#注意事项：\" class=\"headerlink\" title=\"注意事项：\"></a>注意事项：</h3><p>192.168.1.0&#x2F;24网络适配器选择NAT模式；</p>\n<p>192.168.2.0&#x2F;24网络适配器选择仅主机模式；</p>\n<p>Client1和Client2可以是独立的主机（资源允许），也可以通过在Server和Relay端添加网卡的形式，模拟客户端网卡。<br>这次实验一共4台虚拟机</p>\n</blockquote>\n<h2 id=\"一、在服务器（Server）和中继服务器（Relay-Server）上安装dhcp服务\"><a href=\"#一、在服务器（Server）和中继服务器（Relay-Server）上安装dhcp服务\" class=\"headerlink\" title=\"一、在服务器（Server）和中继服务器（Relay Server）上安装dhcp服务\"></a>一、在服务器（Server）和中继服务器（Relay Server）上安装dhcp服务</h2><h3 id=\"1-中继服务器安装双网卡详细看第一章-十五、中继服务器安装，和这里的方法如下：\"><a href=\"#1-中继服务器安装双网卡详细看第一章-十五、中继服务器安装，和这里的方法如下：\" class=\"headerlink\" title=\"1. 中继服务器安装双网卡详细看第一章 十五、中继服务器安装，和这里的方法如下：\"></a>1. 中继服务器安装双网卡详细看<a href=\"https://yeminxi.github.io/posts/6404ce4b.html#%E5%8D%81%E4%BA%94%E3%80%81%E4%B8%AD%E7%BB%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%89%E8%A3%85%E5%8F%AF%E4%BB%A5%E5%8F%82%E8%80%83%E8%BF%99%E4%B8%80%E6%AD%A5%EF%BC%88%E5%85%B6%E4%BD%99%E5%8F%AF%E5%BF%BD%E7%95%A5%E6%AD%A4%E6%AD%A5%EF%BC%89\">第一章 十五、中继服务器安装</a>，和这里的方法如下：</h3><p><img src=\"https://ymxpic.pages.dev/file/ef909f36a743f0f0de307.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/ef909f36a743f0f0de307.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br><img src=\"https://ymxpic.pages.dev/file/dcd03e417ded2a5ed11c2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/dcd03e417ded2a5ed11c2.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmtui\t<span class=\"comment\">//进入图形化设置</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/39cc7a39eb18d2cc64be1.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/39cc7a39eb18d2cc64be1.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br>网卡会激活失败，原因是自动获取的，我已经关掉虚拟网络的dhcp服务，所以在另外在网卡脚本文件配置静态的IP的地址</p>\n<h3 id=\"2-给中继服务器（Relay-Server）双网卡配置静态ip地址\"><a href=\"#2-给中继服务器（Relay-Server）双网卡配置静态ip地址\" class=\"headerlink\" title=\"2. 给中继服务器（Relay Server）双网卡配置静态ip地址\"></a>2. 给中继服务器（Relay Server）双网卡配置静态ip地址</h3><h4 id=\"2-1-配置NAT模式下的网卡静态地址\"><a href=\"#2-1-配置NAT模式下的网卡静态地址\" class=\"headerlink\" title=\"2.1 配置NAT模式下的网卡静态地址\"></a>2.1 配置NAT模式下的网卡静态地址</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/sysconfig/network-scripts/ifcfg-ens33\t<span class=\"comment\">//每个人的网卡名称都不一样 一切按时来</span></span><br><span class=\"line\">vim /etc/sysconfig/network-scripts/ifcfg-ens34\t<span class=\"comment\">//我这里的 ens开头的 33是NAT模式的 34是仅主机模式的</span></span><br></pre></td></tr></table></figure>\n <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> BOOTPROTO=&quot;static&quot; </span><br><span class=\"line\">ONBOOT=&quot;yes&quot; </span><br><span class=\"line\"> IPADDR=192.168.1.254</span><br><span class=\"line\">NETMASK=255.255.255.0 </span><br><span class=\"line\">GATEWAY=192.168.1.2 </span><br><span class=\"line\">DNS1=202.96.128.86（电信）\t联通：221.5.88.88\t移动：211.136.192.6</span><br><span class=\"line\">DNS2=114.114.114.114</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/bfcb6eb556c27643f78b0.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/bfcb6eb556c27643f78b0.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h4 id=\"2-2-配置仅主机模式下的网卡静态地址\"><a href=\"#2-2-配置仅主机模式下的网卡静态地址\" class=\"headerlink\" title=\"2.2 配置仅主机模式下的网卡静态地址\"></a>2.2 配置仅主机模式下的网卡静态地址</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">BOOTPROTO=static  </span><br><span class=\"line\">ONBOOT=yes </span><br><span class=\"line\">IPADDR=192.168.2.10 </span><br><span class=\"line\">NETMASK=255.255.255.0</span><br><span class=\"line\">GATEWAY=192.168.2.254 </span><br><span class=\"line\">DNS1=202.96.128.86 </span><br><span class=\"line\">DNS2=114.114.114.114</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/019007884e77bb7b5b675.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/019007884e77bb7b5b675.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h4 id=\"2-3-重启网络服务并ping通服务器（Server）\"><a href=\"#2-3-重启网络服务并ping通服务器（Server）\" class=\"headerlink\" title=\"2.3 重启网络服务并ping通服务器（Server）\"></a>2.3 重启网络服务并ping通服务器（Server）</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart network\t<span class=\"comment\">//重启网络</span></span><br><span class=\"line\">ping <span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.10</span>\t\t\t<span class=\"comment\">//ping服务器（server）</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/8fb6128a292c6a041f59e.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/8fb6128a292c6a041f59e.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"3-在服务器（Server）上安装dhcp服务（确保良好的网络连接也要保证设备的联网）\"><a href=\"#3-在服务器（Server）上安装dhcp服务（确保良好的网络连接也要保证设备的联网）\" class=\"headerlink\" title=\"3. 在服务器（Server）上安装dhcp服务（确保良好的网络连接也要保证设备的联网）\"></a>3. 在服务器（Server）上安装dhcp服务（确保良好的网络连接也要保证设备的联网）</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum list installed | grep dhcp \t\t\t\t\\\\查看是否安装了dhcp服务</span><br><span class=\"line\">yum -y install dhcp\t\t\t\t\t\t\t\\\\安装dhcp服务</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/daf676459987d8c9788f7.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/daf676459987d8c9788f7.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"4-中继服务器（Relay-Server）同理\"><a href=\"#4-中继服务器（Relay-Server）同理\" class=\"headerlink\" title=\"4. 中继服务器（Relay Server）同理\"></a>4. 中继服务器（Relay Server）同理</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum list installed | grep dhcp \t\t\t\t\\\\查看是否安装了dhcp服务</span><br><span class=\"line\">yum -y install dhcp\t\t\t\t\t\t\t\\\\安装dhcp服务</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/816a35a72b3b878410f1a.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/816a35a72b3b878410f1a.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"二、在服务器（Server）上配置地址池\"><a href=\"#二、在服务器（Server）上配置地址池\" class=\"headerlink\" title=\"二、在服务器（Server）上配置地址池\"></a>二、在服务器（Server）上配置地址池</h2><h3 id=\"1-添加地址池\"><a href=\"#1-添加地址池\" class=\"headerlink\" title=\"1. 添加地址池\"></a>1. 添加地址池</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/dhcp/dhcpd.conf\t<span class=\"comment\">//打开配置文件</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">option domain-name &quot;example.org&quot;; </span><br><span class=\"line\">option domain-name-servers 192.168.1.10,192.168.1.11; </span><br><span class=\"line\">default-lease-time 600; </span><br><span class=\"line\">max-lease-time 7200; </span><br><span class=\"line\">subnet 192.168.1.0 netmask 255.255.255.0 &#123;</span><br><span class=\"line\">         range 192.168.1.110 192.168.1.190;</span><br><span class=\"line\">         option routers 192.168.1.2; </span><br><span class=\"line\">&#125; </span><br><span class=\"line\">subnet 192.168.2.0 netmask 255.255.255.0 &#123;</span><br><span class=\"line\">         range 192.168.2.100 192.168.2.200;</span><br><span class=\"line\">         option routers 192.168.2.254;</span><br><span class=\"line\">         host client2 &#123;</span><br><span class=\"line\">                 hardware ethernet 00:0C:29:B4:04:A7;</span><br><span class=\"line\">                 fixed-address 192.168.2.188;</span><br><span class=\"line\">         &#125; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/89a9106274ae0ae7e69fa.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/89a9106274ae0ae7e69fa.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<p><img src=\"https://ymxpic.pages.dev/file/2849076a51d687cbe3ef6.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/2849076a51d687cbe3ef6.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dhcpd -t\t<span class=\"comment\">//检查语法错误</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/48c7ca2f478a42b60f0fb.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/48c7ca2f478a42b60f0fb.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"12\"></p>\n<h3 id=\"2-重启dhcp服务并自启\"><a href=\"#2-重启dhcp服务并自启\" class=\"headerlink\" title=\"2.重启dhcp服务并自启\"></a>2.重启dhcp服务并自启</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart dhcpd\t\t<span class=\"comment\">//重启dhcp服务</span></span><br><span class=\"line\">systemctl enable dhcpd\t\t<span class=\"comment\">//开机自启dhcp服务</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/25ddedc58967347ad8864.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/25ddedc58967347ad8864.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"13\"></p>\n<h3 id=\"3-添加默认路由\"><a href=\"#3-添加默认路由\" class=\"headerlink\" title=\"3. 添加默认路由\"></a>3. 添加默认路由</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">route add <span class=\"keyword\">default</span> gw <span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.254</span></span><br><span class=\"line\">route add <span class=\"keyword\">default</span> gw <span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.2</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"三、在中继服务器（Relay-Server）配置中继服务\"><a href=\"#三、在中继服务器（Relay-Server）配置中继服务\" class=\"headerlink\" title=\"三、在中继服务器（Relay Server）配置中继服务\"></a>三、在中继服务器（Relay Server）配置中继服务</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp /lib/systemd/system/dhcrelay.service /etc/systemd/system   <span class=\"comment\">//将dhcp中继主配文件复制</span></span><br><span class=\"line\">vim /etc/systemd/system/dhcrelay.service                      <span class=\"comment\">//编辑dhcp中继主配文件</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/ca7d379a64e67581a179a.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/ca7d379a64e67581a179a.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"14\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl daemon-reload\t\t\t\t\t<span class=\"comment\">//重载</span></span><br><span class=\"line\">systemctl start dhcrelay.service\t\t<span class=\"comment\">//启动中继服务</span></span><br><span class=\"line\">systemctl enable dhcrelay.service\t\t<span class=\"comment\">//开机自启中继服务</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/cd3d4cb9ab67782678448.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/cd3d4cb9ab67782678448.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/sysctl.conf\t<span class=\"comment\">//打开配置文件</span></span><br><span class=\"line\"><span class=\"string\">&quot;net.ipv4.ip_forward=1&quot;</span>\t<span class=\"comment\">//加入这一句话</span></span><br><span class=\"line\">sysctl -p\t\t\t\t<span class=\"comment\">//重载</span></span><br><span class=\"line\">dhcrelay <span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.10</span>\t<span class=\"comment\">//开启中继</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/f0d887b30fc6bf24b72cf.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/f0d887b30fc6bf24b72cf.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"四、验证\"><a href=\"#四、验证\" class=\"headerlink\" title=\"四、验证\"></a>四、验证</h2><h3 id=\"1-客户端（Client1）验证\"><a href=\"#1-客户端（Client1）验证\" class=\"headerlink\" title=\"1.客户端（Client1）验证\"></a>1.客户端（Client1）验证</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/sysconfig/network-scripts/ifcfg-ens33\t<span class=\"comment\">//打开网卡配置脚本 将之前的静态地址改成dhcp</span></span><br><span class=\"line\">systemctl restart network\t\t\t\t\t\t<span class=\"comment\">//重启网络服务</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/c58156bc744386a035a96.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/c58156bc744386a035a96.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dhclient -r\t\t\t\t\t\t\t\t<span class=\"comment\">//释放租约</span></span><br><span class=\"line\">dhclient\t\t\t\t\t\t\t\t<span class=\"comment\">//重新获取租约</span></span><br><span class=\"line\">ip addr show ens33\t\t\t\t\t\t<span class=\"comment\">//查看网卡ens33的状态</span></span><br><span class=\"line\">tail /<span class=\"keyword\">var</span>/lib/dhclient/dhclient.leases\t<span class=\"comment\">//查看租约</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/316ddce30f37e5bd60544.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/316ddce30f37e5bd60544.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-客户端（Client2）验证同理，这里就不演示了。下面展示一下window7怎么获取。\"><a href=\"#2-客户端（Client2）验证同理，这里就不演示了。下面展示一下window7怎么获取。\" class=\"headerlink\" title=\"2.客户端（Client2）验证同理，这里就不演示了。下面展示一下window7怎么获取。\"></a>2.客户端（Client2）验证同理，这里就不演示了。下面展示一下window7怎么获取。</h3><p><img src=\"https://ymxpic.pages.dev/file/6679c9e4c47bdfc4737e2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/6679c9e4c47bdfc4737e2.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br>查看租约<br><img src=\"https://ymxpic.pages.dev/file/3af11b4bebffa7415db95.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/3af11b4bebffa7415db95.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"3-服务器（Server）查看租约\"><a href=\"#3-服务器（Server）查看租约\" class=\"headerlink\" title=\"3.服务器（Server）查看租约\"></a>3.服务器（Server）查看租约</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tail /<span class=\"keyword\">var</span>/lib/dhcpd/dhcpd.leases</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/5f214d3684934287efed3.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/5f214d3684934287efed3.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"至此，实验结束。\"><a href=\"#至此，实验结束。\" class=\"headerlink\" title=\"至此，实验结束。\"></a>至此，实验结束。</h2>",
            "tags": [
                "服务器",
                "Linux",
                "CentOS",
                "网络安全",
                "网络协议",
                "DHCP"
            ]
        },
        {
            "id": "https://yeminxi.github.io/posts/cfebefbe.html",
            "url": "https://yeminxi.github.io/posts/cfebefbe.html",
            "title": "第三章 Centos 7 Linux配置samba 实训任务1：配置Samba服务",
            "date_published": "2024-05-28T03:48:51.000Z",
            "content_html": "<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>虚拟机需求：1台服务器（Server）、1台客户端（Client）</p>\n<blockquote>\n<p><strong>在第二章的基础上继续实训</strong></p>\n</blockquote>\n<h2 id=\"实训任务1：配置Samba服务\"><a href=\"#实训任务1：配置Samba服务\" class=\"headerlink\" title=\"实训任务1：配置Samba服务\"></a>实训任务1：配置Samba服务</h2><blockquote>\n<h3 id=\"任务1-创建Samba共享，本地目录为-data-share，要求：\"><a href=\"#任务1-创建Samba共享，本地目录为-data-share，要求：\" class=\"headerlink\" title=\"任务1 创建Samba共享，本地目录为&#x2F;data&#x2F;share，要求：\"></a>任务1 创建Samba共享，本地目录为&#x2F;data&#x2F;share，要求：</h3><p>共享名为share1<br>仅允许zsuser用户能上传文件</p>\n</blockquote>\n<blockquote>\n<h3 id=\"任务2-创建Samba共享，本地目录为-data-public，要求：\"><a href=\"#任务2-创建Samba共享，本地目录为-data-public，要求：\" class=\"headerlink\" title=\"任务2 创建Samba共享，本地目录为&#x2F;data&#x2F;public，要求：\"></a>任务2 创建Samba共享，本地目录为&#x2F;data&#x2F;public，要求：</h3><p>共享名为public</p>\n<p>允许匿名访问</p>\n<p>所有用户都能上传文件</p>\n</blockquote>\n<h2 id=\"一、在服务器（Server）上安装Samba服务\"><a href=\"#一、在服务器（Server）上安装Samba服务\" class=\"headerlink\" title=\"一、在服务器（Server）上安装Samba服务\"></a>一、在服务器（Server）上安装Samba服务</h2><h3 id=\"1-确保良好的网络连接也要保证设备的联网\"><a href=\"#1-确保良好的网络连接也要保证设备的联网\" class=\"headerlink\" title=\"1. 确保良好的网络连接也要保证设备的联网\"></a>1. 确保良好的网络连接也要保证设备的联网</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum list installed | grep samba \t\t\t\t\\\\查看是否安装了samba服务</span><br><span class=\"line\">yum -y install samba\t\t\t\t\t\t\t\\\\安装samba服务</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/8703f6d6f03de11ce6cd0.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/8703f6d6f03de11ce6cd0.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-防火墙设置\"><a href=\"#2-防火墙设置\" class=\"headerlink\" title=\"2. 防火墙设置\"></a>2. 防火墙设置</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-service=samba\t\t\\\\开启samba服务 允许通过</span><br><span class=\"line\">firewall-cmd --reload\t\t\t\t\t\t\t\t\t\t\t\\\\重启防火墙</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/1542ac9641fa09b4280d1.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/1542ac9641fa09b4280d1.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"3-开启samba服务\"><a href=\"#3-开启samba服务\" class=\"headerlink\" title=\"3. 开启samba服务\"></a>3. 开启samba服务</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start smb nmb\t\t\t\t\t\\\\开启samba服务</span><br><span class=\"line\">systemctl enable smb nmb\t\t\t\t\\\\开机自启samba服务</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/0b672eb5283341ecba40d.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/0b672eb5283341ecba40d.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"4-创建samba用户\"><a href=\"#4-创建samba用户\" class=\"headerlink\" title=\"4. 创建samba用户\"></a>4. 创建samba用户</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">useradd zsuser\t\t\t\t\\\\添加zsuser用户</span><br><span class=\"line\">smbpasswd -a zsuser\t\t\t\\\\为zsuser用户添加密码</span><br><span class=\"line\">useradd tom\t\t\t\t\t\\\\添加多一个用户好测试</span><br><span class=\"line\">smbpasswd -a tom\t\t\t\\\\设置密码</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/1eea16dcab85fe84a94aa.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/1eea16dcab85fe84a94aa.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"二、在服务器（Server）上创建samba共享目录\"><a href=\"#二、在服务器（Server）上创建samba共享目录\" class=\"headerlink\" title=\"二、在服务器（Server）上创建samba共享目录\"></a>二、在服务器（Server）上创建samba共享目录</h2><h3 id=\"1-创建share、public目录\"><a href=\"#1-创建share、public目录\" class=\"headerlink\" title=\"1. 创建share、public目录\"></a>1. 创建share、public目录</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir /data /data/share/ /data/<span class=\"keyword\">public</span>/\t\t\t\t\\\\创建share、<span class=\"keyword\">public</span>目录</span><br><span class=\"line\">chmod <span class=\"number\">777</span> /data /data/share/ /data/<span class=\"keyword\">public</span>/\t\t\t\\\\设置目录权限</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/ae1a02daba7ce86ac7934.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/ae1a02daba7ce86ac7934.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-创建share1、public共享目录\"><a href=\"#2-创建share1、public共享目录\" class=\"headerlink\" title=\"2. 创建share1、public共享目录\"></a>2. 创建share1、public共享目录</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/samba/smb.conf\t\t\t\t\\\\编辑配置文件详细内容如下所示</span><br><span class=\"line\">[global]\t\t\t\t\t\\\\在全局变量中加入</span><br><span class=\"line\">map <span class=\"type\">to</span> <span class=\"variable\">guest</span> <span class=\"operator\">=</span> bad user\t\t\\\\开启匿名访问</span><br><span class=\"line\">[share1]</span><br><span class=\"line\">        comment = share1\t\\\\共享注释</span><br><span class=\"line\">        path = /data/share\t\\\\指定共享目录</span><br><span class=\"line\">        <span class=\"type\">write</span> <span class=\"variable\">list</span> <span class=\"operator\">=</span> zsuser\t\\\\写入列表</span><br><span class=\"line\">        writable = no\t\t\\\\不支持写入数据（列表中写读，不在列表只读）</span><br><span class=\"line\">[<span class=\"keyword\">public</span>]</span><br><span class=\"line\">        comment = <span class=\"keyword\">public</span>\t\\\\共享注释</span><br><span class=\"line\">        path = /data/<span class=\"keyword\">public</span>\t\\\\指定共享目录</span><br><span class=\"line\">        <span class=\"type\">guest</span> <span class=\"variable\">ok</span> <span class=\"operator\">=</span> yes\t\t\\\\允许匿名访问</span><br><span class=\"line\">        browseable = yes\t\\\\所有人可见</span><br><span class=\"line\">        writeable = yes\t\t\\\\支持写入数据</span><br><span class=\"line\">        <span class=\"type\">read</span> <span class=\"variable\">only</span> <span class=\"operator\">=</span> no\t\t\\\\是否可读</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/2f5eb2de14ebbab215b92.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/2f5eb2de14ebbab215b92.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"3-检查语法错误跟重启samba服务\"><a href=\"#3-检查语法错误跟重启samba服务\" class=\"headerlink\" title=\"3. 检查语法错误跟重启samba服务\"></a>3. 检查语法错误跟重启samba服务</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">testparm\t\t\t\t\t\t\t\\\\检查语法错误</span><br><span class=\"line\">systemctl restart sbm nmb\t\t\t\\\\重启samba服务</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/89a4b66e91f45918dd916.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/89a4b66e91f45918dd916.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"4-配置selinux\"><a href=\"#4-配置selinux\" class=\"headerlink\" title=\"4. 配置selinux\"></a>4. 配置selinux</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">setenforce <span class=\"number\">1</span>\t\t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//开启</span></span><br><span class=\"line\">ls -ldZ /data/share /data/<span class=\"keyword\">public</span>\t\t\t\t\t\t<span class=\"comment\">//查看文件夹安全上下文</span></span><br><span class=\"line\">chcon -t samba_share_t /data/share /data/<span class=\"keyword\">public</span>\t\t\t</span><br><span class=\"line\"><span class=\"comment\">//为/data/share设置samba_share_t标签目录，使selinux允许samba读和写这个目录。</span></span><br><span class=\"line\"><span class=\"comment\">//为/data/public设置samba_share_t标签目录，使selinux允许samba读和写这个目录。</span></span><br><span class=\"line\">ls -ldZ /data/share /data/<span class=\"keyword\">public</span>\t\t\t\t\t\t<span class=\"comment\">//查看文件夹安全上下文</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/bfe396cae2869d5149a97.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/bfe396cae2869d5149a97.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"三、在客户机（Client）上测试\"><a href=\"#三、在客户机（Client）上测试\" class=\"headerlink\" title=\"三、在客户机（Client）上测试\"></a>三、在客户机（Client）上测试</h2><h3 id=\"1-测试-任务1\"><a href=\"#1-测试-任务1\" class=\"headerlink\" title=\"1. 测试 任务1\"></a>1. 测试 任务1</h3><blockquote>\n<p>smbclient &#x2F;&#x2F;192.168.1.10&#x2F;share1 -U zsuser\t\t\t\t&#x3D;&#x3D;使用zsuser用户访问samba服务&#x3D;&#x3D;<br>mkdir test \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;测试是否能创建test文件夹&#x3D;&#x3D;<br>ls \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;查看列表 显示test文件夹 证明成功&#x3D;&#x3D;<br>exit \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;退出&#x3D;&#x3D;\t</p>\n</blockquote>\n<blockquote>\n<p>smbclient&#x2F;&#x2F;192.168.1.10&#x2F;share1 -U tom \t\t\t\t\t&#x3D;&#x3D;使用tom用户访问samba服务&#x3D;&#x3D;<br>mkdir test1 \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;测试是否能创建test1文件夹&#x3D;&#x3D;<br>ls \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;查看列表 不显示test1文件夹 证明除了zsuser用户能写入其余用户不能写入只能读&#x3D;&#x3D;<br>exit\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;退出&#x3D;&#x3D;</p>\n</blockquote>\n<p><img src=\"https://ymxpic.pages.dev/file/5d43a1d78cd30590d6e82.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/5d43a1d78cd30590d6e82.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-测试-任务2\"><a href=\"#2-测试-任务2\" class=\"headerlink\" title=\"2. 测试 任务2\"></a>2. 测试 任务2</h3><blockquote>\n<p>smbclient&#x2F;&#x2F;192.168.1.10&#x2F;share1 -U guest\t\t\t\t\t&#x3D;&#x3D;使用匿名用户访问samba服务&#x3D;&#x3D;<br>mkdir test1 \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;测试是否能创建test1文件夹&#x3D;&#x3D;<br>ls \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;查看列表 显示test1文件夹 证明所有用户都能读写&#x3D;&#x3D;<br>exit\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;退出&#x3D;&#x3D;</p>\n</blockquote>\n<p><img src=\"https://ymxpic.pages.dev/file/7af823ce5f86eecd47f75.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/7af823ce5f86eecd47f75.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"3-windows-7-测试\"><a href=\"#3-windows-7-测试\" class=\"headerlink\" title=\"3. windows 7 测试\"></a>3. windows 7 测试</h3><p><img src=\"https://ymxpic.pages.dev/file/cde9ec53b36cd2bd6147f.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/cde9ec53b36cd2bd6147f.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"至此，实验结束。\"><a href=\"#至此，实验结束。\" class=\"headerlink\" title=\"至此，实验结束。\"></a>至此，实验结束。</h2>",
            "tags": [
                "服务器",
                "运维",
                "Linux",
                "CentOS",
                "网络",
                "Samba"
            ]
        },
        {
            "id": "https://yeminxi.github.io/posts/c38d1213.html",
            "url": "https://yeminxi.github.io/posts/c38d1213.html",
            "title": "第二章_Centos 7 Linux配置ssh 实训任务：SSH的安全配置",
            "date_published": "2024-05-28T03:21:51.000Z",
            "content_html": "<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>虚拟机需求：1台服务器（Server）、1台客户端（Client）</p>\n<blockquote>\n<h2 id=\"实训任务2：SSH的安全配置\"><a href=\"#实训任务2：SSH的安全配置\" class=\"headerlink\" title=\"实训任务2：SSH的安全配置\"></a>实训任务2：SSH的安全配置</h2><h3 id=\"任务情境描述-某公司管理员已经将自己个人电脑免密登录到远程服务器。\"><a href=\"#任务情境描述-某公司管理员已经将自己个人电脑免密登录到远程服务器。\" class=\"headerlink\" title=\"任务情境描述 某公司管理员已经将自己个人电脑免密登录到远程服务器。\"></a>任务情境描述 某公司管理员已经将自己个人电脑免密登录到远程服务器。</h3></blockquote>\n<blockquote>\n<p><img src=\"https://ymxpic.pages.dev/file/223c1ea91948fb2ec3a2e.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/223c1ea91948fb2ec3a2e.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n</blockquote>\n<blockquote>\n<p><strong>服务器地址为192.168.1.10&#x2F;24（IP地址可自行设置）</strong><br><strong>管理员PC地址为192.168.1.20&#x2F;24（IP地址可自行设置）</strong><br><strong>管理员ID为admin，密码为password</strong></p>\n</blockquote>\n<blockquote>\n<h3 id=\"任务需求：\"><a href=\"#任务需求：\" class=\"headerlink\" title=\"任务需求：\"></a>任务需求：</h3><h4 id=\"（1）为了让SSH更安全，需要修改SSH的端口为61234；\"><a href=\"#（1）为了让SSH更安全，需要修改SSH的端口为61234；\" class=\"headerlink\" title=\"（1）为了让SSH更安全，需要修改SSH的端口为61234；\"></a>（1）为了让SSH更安全，需要修改SSH的端口为61234；</h4><h4 id=\"（2）限制SSH服务器只能由管理员PC通过admin用户登录，其他用户均无法远程访问服务器。\"><a href=\"#（2）限制SSH服务器只能由管理员PC通过admin用户登录，其他用户均无法远程访问服务器。\" class=\"headerlink\" title=\"（2）限制SSH服务器只能由管理员PC通过admin用户登录，其他用户均无法远程访问服务器。\"></a>（2）限制SSH服务器只能由管理员PC通过admin用户登录，其他用户均无法远程访问服务器。</h4></blockquote>\n<blockquote>\n<p>请完成配置，并提交实验报告。（线下课程随堂检查） 若没有安装Centos 7 虚拟机 请单击此处 有详细的安装教程</p>\n</blockquote>\n<h2 id=\"一、配置虚拟网络（可自行设置）\"><a href=\"#一、配置虚拟网络（可自行设置）\" class=\"headerlink\" title=\"一、配置虚拟网络（可自行设置）\"></a>一、配置虚拟网络（可自行设置）</h2><p><img src=\"https://ymxpic.pages.dev/file/fed0bb0a28d20213b36af.png\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/fed0bb0a28d20213b36af.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br><img src=\"https://ymxpic.pages.dev/file/1e065255b4baed349e831.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/1e065255b4baed349e831.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"不勾选使用本地DHCP服务 按题目需求修改IP地址\"></p>\n<h3 id=\"1-修改NAT模式的子网IP：192-168-1-0-子网掩码：255-255-255-0\"><a href=\"#1-修改NAT模式的子网IP：192-168-1-0-子网掩码：255-255-255-0\" class=\"headerlink\" title=\"1. 修改NAT模式的子网IP：192.168.1.0 子网掩码：255.255.255.0\"></a>1. 修改NAT模式的子网IP：192.168.1.0 子网掩码：255.255.255.0</h3><h3 id=\"2-取消勾选使用本地DHCP服务将IP地址分配给虚拟机\"><a href=\"#2-取消勾选使用本地DHCP服务将IP地址分配给虚拟机\" class=\"headerlink\" title=\"2. 取消勾选使用本地DHCP服务将IP地址分配给虚拟机\"></a>2. 取消勾选使用本地DHCP服务将IP地址分配给虚拟机</h3><h3 id=\"3-单击“NAT-设置”-修改网关：192-168-1-2\"><a href=\"#3-单击“NAT-设置”-修改网关：192-168-1-2\" class=\"headerlink\" title=\"3. 单击“NAT 设置” 修改网关：192.168.1.2\"></a>3. 单击“NAT 设置” 修改网关：192.168.1.2</h3><h2 id=\"二、配置服务器（server）与客户端（client）的IP地址并使互相ping通\"><a href=\"#二、配置服务器（server）与客户端（client）的IP地址并使互相ping通\" class=\"headerlink\" title=\"二、配置服务器（server）与客户端（client）的IP地址并使互相ping通\"></a>二、配置服务器（server）与客户端（client）的IP地址并使互相ping通</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">su root\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\\\\进入root</span><br><span class=\"line\">vim /etc/sysconfig/network-scripts/ifcfg-ens33\t\t\t\t\t\\\\修改默认网卡脚本 一切按照实际情况</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-服务器（server）网络配置（添加修改命令如下）\"><a href=\"#1-服务器（server）网络配置（添加修改命令如下）\" class=\"headerlink\" title=\"1. 服务器（server）网络配置（添加修改命令如下）\"></a>1. 服务器（server）网络配置（添加修改命令如下）</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">BOOTPROTO=<span class=\"string\">&quot;static&quot;</span> </span><br><span class=\"line\">ONBOOT=<span class=\"string\">&quot;yes&quot;</span> </span><br><span class=\"line\">IPADDR=<span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.10</span></span><br><span class=\"line\">GATEWAY=<span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.2</span> </span><br><span class=\"line\">NETMAKS=<span class=\"number\">255.255</span><span class=\"number\">.255</span><span class=\"number\">.0</span> </span><br><span class=\"line\">DNS1=<span class=\"number\">202.96</span><span class=\"number\">.128</span><span class=\"number\">.86</span>（电信）\t联通：<span class=\"number\">221.5</span><span class=\"number\">.88</span><span class=\"number\">.88</span>\t移动：<span class=\"number\">211.136</span><span class=\"number\">.192</span><span class=\"number\">.6</span></span><br><span class=\"line\">DNS2=<span class=\"number\">114.114</span><span class=\"number\">.114</span><span class=\"number\">.114</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/287e94072c3aba4c9d5f1.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/287e94072c3aba4c9d5f1.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-客户端（client）同理\"><a href=\"#2-客户端（client）同理\" class=\"headerlink\" title=\"2. 客户端（client）同理\"></a>2. 客户端（client）同理</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">BOOTPROTO=<span class=\"string\">&quot;static&quot;</span> </span><br><span class=\"line\">ONBOOT=<span class=\"string\">&quot;yes&quot;</span> </span><br><span class=\"line\">IPADDR=<span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.10</span></span><br><span class=\"line\">GATEWAY=<span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.2</span> </span><br><span class=\"line\">NETMAKS=<span class=\"number\">255.255</span><span class=\"number\">.255</span><span class=\"number\">.0</span> </span><br><span class=\"line\">DNS1=<span class=\"number\">202.96</span><span class=\"number\">.128</span><span class=\"number\">.86</span>（电信）\t联通：<span class=\"number\">221.5</span><span class=\"number\">.88</span><span class=\"number\">.88</span>\t移动：<span class=\"number\">211.136</span><span class=\"number\">.192</span><span class=\"number\">.6</span></span><br><span class=\"line\">DNS2=<span class=\"number\">114.114</span><span class=\"number\">.114</span><span class=\"number\">.114</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/01459d855c7a42e646142.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/01459d855c7a42e646142.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"3-服务器（Server）与客户端（Client）互相ping通\"><a href=\"#3-服务器（Server）与客户端（Client）互相ping通\" class=\"headerlink\" title=\"3. 服务器（Server）与客户端（Client）互相ping通\"></a>3. 服务器（Server）与客户端（Client）互相ping通</h3><p><img src=\"https://ymxpic.pages.dev/file/cd8e84945a0c96b3ba10e.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/cd8e84945a0c96b3ba10e.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"三、在服务器（Server）上添加用户\"><a href=\"#三、在服务器（Server）上添加用户\" class=\"headerlink\" title=\"三、在服务器（Server）上添加用户\"></a>三、在服务器（Server）上添加用户</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">useradd admin\t\t\t\t\t\t\t\t\t\\\\添加管理员admin</span><br><span class=\"line\">passwd --stdin admin\t\t\t\t\t\t\t\\\\为管理员admin设置密码</span><br><span class=\"line\">password\t\t\t\t\t\t\t\t\t\t\\\\输入题目要求密码</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/dcbc3c531ac66b66e037a.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/dcbc3c531ac66b66e037a.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"四、在服务器（Server）修改ssh默认端口\"><a href=\"#四、在服务器（Server）修改ssh默认端口\" class=\"headerlink\" title=\"四、在服务器（Server）修改ssh默认端口\"></a>四、在服务器（Server）修改ssh默认端口</h2><h3 id=\"1-确保虚拟机已安装openssh-server-以下命令可查询\"><a href=\"#1-确保虚拟机已安装openssh-server-以下命令可查询\" class=\"headerlink\" title=\"1. 确保虚拟机已安装openssh-server 以下命令可查询\"></a>1. 确保虚拟机已安装openssh-server 以下命令可查询</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum list installed | grep openssh-server</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/b09fa4d1f40e5a93c5c7a.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/b09fa4d1f40e5a93c5c7a.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"若无结果就未安装，则可输入以下命令进行安装\"><a href=\"#若无结果就未安装，则可输入以下命令进行安装\" class=\"headerlink\" title=\"若无结果就未安装，则可输入以下命令进行安装\"></a>若无结果就未安装，则可输入以下命令进行安装</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install openssh-server</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-修改默认端口\"><a href=\"#2-修改默认端口\" class=\"headerlink\" title=\"2. 修改默认端口\"></a>2. 修改默认端口</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/4ebd48c1d1c005be1286d.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/4ebd48c1d1c005be1286d.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"3-防火墙设置和修改安全上下文\"><a href=\"#3-防火墙设置和修改安全上下文\" class=\"headerlink\" title=\"3. 防火墙设置和修改安全上下文\"></a>3. 防火墙设置和修改安全上下文</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --permanent --add-port=<span class=\"number\">61234</span>/tcp\t\t\t\t\\\\开启端口<span class=\"number\">61234</span></span><br><span class=\"line\">firewall-cmd --reload\t\t\t\t\t\t\t\t\t\t\\\\重启防火墙</span><br><span class=\"line\">semanage port -a -t ssh_port_t -p tcp <span class=\"number\">61234</span>\t\t\t\t\t\\\\修改安全上下文</span><br><span class=\"line\">semanage port -l | grep ssh\t\t\t\t\t\t\t\t\t\\\\查看修改以后的上下文</span><br><span class=\"line\">systemctl restart sshd\t\t\t\t\t\t\t\t\t\t\\\\重启ssh服务</span><br><span class=\"line\">systemctl enable sshd\t\t\t\t\t\t\t\t\t    \\\\设置ssh服务开机自启</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/7d0076fc7114f62912f38.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/7d0076fc7114f62912f38.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"4-客户端（Client）测试\"><a href=\"#4-客户端（Client）测试\" class=\"headerlink\" title=\"4.客户端（Client）测试\"></a>4.客户端（Client）测试</h3><p><img src=\"https://ymxpic.pages.dev/file/265010c8a895e25da61e4.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/265010c8a895e25da61e4.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"五、指定用户免密登录\"><a href=\"#五、指定用户免密登录\" class=\"headerlink\" title=\"五、指定用户免密登录\"></a>五、指定用户免密登录</h2><h3 id=\"1-首先在客户端（Client）生成密钥并发送到服务器（Server）\"><a href=\"#1-首先在客户端（Client）生成密钥并发送到服务器（Server）\" class=\"headerlink\" title=\"1. 首先在客户端（Client）生成密钥并发送到服务器（Server）\"></a>1. 首先在客户端（Client）生成密钥并发送到服务器（Server）</h3><p><img src=\"https://ymxpic.pages.dev/file/b8b1e7237120492d6a675.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/b8b1e7237120492d6a675.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen\t\t\t\t\t\t\t\t\t\t\\\\生成密钥 连续 按<span class=\"number\">3</span>次 Enter键</span><br><span class=\"line\">ssh-copy-id -p <span class=\"number\">61234</span> admin@<span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.10</span>\t\t\t\\\\把生成的密钥传到服务器去</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-其次在服务器（Server）修改配置文件-禁止root用户登录和无密码登录\"><a href=\"#2-其次在服务器（Server）修改配置文件-禁止root用户登录和无密码登录\" class=\"headerlink\" title=\"2. 其次在服务器（Server）修改配置文件 禁止root用户登录和无密码登录\"></a>2. 其次在服务器（Server）修改配置文件 禁止root用户登录和无密码登录</h3><p><img src=\"https://ymxpic.pages.dev/file/0e7c4336feb5885a628db.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/0e7c4336feb5885a628db.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/ssh/sshd_config\t\t\t\t\t\t\\\\打开配置文件</span><br><span class=\"line\">systemctl restart sshd\t\t\t\t\t\t\t\\\\修改完重启ssh服务</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-在客户端（Client）上测试\"><a href=\"#3-在客户端（Client）上测试\" class=\"headerlink\" title=\"3. 在客户端（Client）上测试\"></a>3. 在客户端（Client）上测试</h3><p><img src=\"https://ymxpic.pages.dev/file/328d429cca3adb782450b.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/328d429cca3adb782450b.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br> <strong>管理员admin成功免密登录，其他用户均无法远程访问服务器。</strong></p>\n<h2 id=\"六、至此，实验结束。\"><a href=\"#六、至此，实验结束。\" class=\"headerlink\" title=\"六、至此，实验结束。\"></a>六、至此，实验结束。</h2>",
            "tags": [
                "服务器",
                "Linux",
                "CentOS",
                "安全",
                "SSH"
            ]
        },
        {
            "id": "https://yeminxi.github.io/posts/6404ce4b.html",
            "url": "https://yeminxi.github.io/posts/6404ce4b.html",
            "title": "第一章 VMware Workstation Pro 17安装Centos 7 安装虚拟机及简单配置",
            "date_published": "2024-05-25T05:15:51.000Z",
            "content_html": "<h1 id=\"前言-vm-17-安装Centos7-安装准备\"><a href=\"#前言-vm-17-安装Centos7-安装准备\" class=\"headerlink\" title=\"前言  vm 17 安装Centos7 安装准备\"></a>前言  vm 17 安装Centos7 安装准备</h1><blockquote>\n<p>单击文字下载<br>    &nbsp;&nbsp;&nbsp;&nbsp;<a href=\"https://pan-yz.cldisk.com/external/m/file/996322369614340096\">镜像</a><br>    &nbsp;&nbsp;&nbsp;&nbsp;<a href=\"https://www.vmware.com/cn/products/workstation-pro/workstation-pro-evaluation.html\">官网自行下载</a></p>\n</blockquote>\n<h2 id=\"一、创建新的虚拟机\"><a href=\"#一、创建新的虚拟机\" class=\"headerlink\" title=\"一、创建新的虚拟机\"></a>一、创建新的虚拟机</h2><p><img src=\"https://ymxpic.pages.dev/file/8d8cbe41506c9a66e5067.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/8d8cbe41506c9a66e5067.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"二、选择硬件兼容性\"><a href=\"#二、选择硬件兼容性\" class=\"headerlink\" title=\"二、选择硬件兼容性\"></a>二、选择硬件兼容性</h2><p><img src=\"https://ymxpic.pages.dev/file/33224d2fee42ecb57d6a7.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/33224d2fee42ecb57d6a7.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"三、安装客户机操作系统\"><a href=\"#三、安装客户机操作系统\" class=\"headerlink\" title=\"三、安装客户机操作系统\"></a>三、安装客户机操作系统</h2><p><img src=\"https://ymxpic.pages.dev/file/db15754c0e370219cdb05.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/db15754c0e370219cdb05.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"四、个性化Linux\"><a href=\"#四、个性化Linux\" class=\"headerlink\" title=\"四、个性化Linux\"></a>四、个性化Linux</h2><p><img src=\"https://ymxpic.pages.dev/file/d3f2efc9dafd94297df88.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/d3f2efc9dafd94297df88.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"五、命名虚拟机-位置\"><a href=\"#五、命名虚拟机-位置\" class=\"headerlink\" title=\"五、命名虚拟机 位置\"></a>五、命名虚拟机 位置</h2><p><img src=\"https://ymxpic.pages.dev/file/7bd92fe9c66fc538938e8.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/7bd92fe9c66fc538938e8.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"六、处理器配置\"><a href=\"#六、处理器配置\" class=\"headerlink\" title=\"六、处理器配置\"></a>六、处理器配置</h2><p><img src=\"https://ymxpic.pages.dev/file/ab1bf00a9512e745a02d6.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/ab1bf00a9512e745a02d6.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"七、此虚拟机内存（默认即可-看自己配置）\"><a href=\"#七、此虚拟机内存（默认即可-看自己配置）\" class=\"headerlink\" title=\"七、此虚拟机内存（默认即可 看自己配置）\"></a>七、此虚拟机内存（默认即可 看自己配置）</h2><p><img src=\"https://ymxpic.pages.dev/file/53bba1b04d860c72d0963.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/53bba1b04d860c72d0963.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"八、网络类型\"><a href=\"#八、网络类型\" class=\"headerlink\" title=\"八、网络类型\"></a>八、网络类型</h2><p><img src=\"https://ymxpic.pages.dev/file/4620459158b88fbcf8014.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/4620459158b88fbcf8014.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"九、选择磁盘类型\"><a href=\"#九、选择磁盘类型\" class=\"headerlink\" title=\"九、选择磁盘类型\"></a>九、选择磁盘类型</h2><p><img src=\"https://ymxpic.pages.dev/file/4b2406e78d01a4466735a.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/4b2406e78d01a4466735a.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"十、选择I-O控制器类型\"><a href=\"#十、选择I-O控制器类型\" class=\"headerlink\" title=\"十、选择I&#x2F;O控制器类型\"></a>十、选择I&#x2F;O控制器类型</h2><p><img src=\"https://ymxpic.pages.dev/file/1b774776de43e1e0df272.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/1b774776de43e1e0df272.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"十一、指定磁盘容量\"><a href=\"#十一、指定磁盘容量\" class=\"headerlink\" title=\"十一、指定磁盘容量\"></a>十一、指定磁盘容量</h2><p><img src=\"https://ymxpic.pages.dev/file/303dfe834fe95a50f27d7.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/303dfe834fe95a50f27d7.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"十二、选择磁盘\"><a href=\"#十二、选择磁盘\" class=\"headerlink\" title=\"十二、选择磁盘\"></a>十二、选择磁盘</h2><p><img src=\"https://ymxpic.pages.dev/file/4737e8d92549bf1f5ca75.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/4737e8d92549bf1f5ca75.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"十三、指定磁盘文件\"><a href=\"#十三、指定磁盘文件\" class=\"headerlink\" title=\"十三、指定磁盘文件\"></a>十三、指定磁盘文件</h2><p><img src=\"https://ymxpic.pages.dev/file/9a9a115a72cc6a63d4ee4.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/9a9a115a72cc6a63d4ee4.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"十四、完成\"><a href=\"#十四、完成\" class=\"headerlink\" title=\"十四、完成\"></a>十四、完成</h2><p><img src=\"https://ymxpic.pages.dev/file/a4360fbc27a38fe8040b0.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/a4360fbc27a38fe8040b0.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"十五、中继服务器安装可以参考这一步（其余可忽略此步）\"><a href=\"#十五、中继服务器安装可以参考这一步（其余可忽略此步）\" class=\"headerlink\" title=\"十五、中继服务器安装可以参考这一步（其余可忽略此步）\"></a>十五、中继服务器安装可以参考这一步（其余可忽略此步）</h2><p><strong>双网卡 NAT模式 仅主机</strong><br><img src=\"https://ymxpic.pages.dev/file/b266fccebe578c0d7745c.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/b266fccebe578c0d7745c.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br><img src=\"https://ymxpic.pages.dev/file/e89e9b0d772197548641b.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/e89e9b0d772197548641b.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br><img src=\"https://ymxpic.pages.dev/file/dd298c168427001c63a25.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/dd298c168427001c63a25.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br><img src=\"https://ymxpic.pages.dev/file/633cb4080d73173ae94e2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/633cb4080d73173ae94e2.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"十六、启动虚拟机\"><a href=\"#十六、启动虚拟机\" class=\"headerlink\" title=\"十六、启动虚拟机\"></a>十六、启动虚拟机</h2><p><img src=\"https://ymxpic.pages.dev/file/b79117af237c9eacfd47c.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/b79117af237c9eacfd47c.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br>不需要任何操作，等待一段时间<br><img src=\"https://ymxpic.pages.dev/file/9acda126e29400555c4f9.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/9acda126e29400555c4f9.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br>出现此界面即安装完成</p>\n<h2 id=\"十七、设置中文-拼音输入法-时区\"><a href=\"#十七、设置中文-拼音输入法-时区\" class=\"headerlink\" title=\"十七、设置中文 拼音输入法 时区\"></a>十七、设置中文 拼音输入法 时区</h2><p>按照步骤进行实验<br><img src=\"https://ymxpic.pages.dev/file/fcd2ce9fbc2f4a30689a3.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/fcd2ce9fbc2f4a30689a3.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br><img src=\"https://ymxpic.pages.dev/file/7aea610295c1887c69ad2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/7aea610295c1887c69ad2.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br><img src=\"https://ymxpic.pages.dev/file/3dd03cd5b76565c453b15.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/3dd03cd5b76565c453b15.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br><img src=\"https://ymxpic.pages.dev/file/92d4077407b880ced8c8a.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/92d4077407b880ced8c8a.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br><img src=\"https://ymxpic.pages.dev/file/eb6ae8c0dd80d7af39e61.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/eb6ae8c0dd80d7af39e61.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br>重启即可</p>\n<h2 id=\"至此，安装完成。\"><a href=\"#至此，安装完成。\" class=\"headerlink\" title=\"至此，安装完成。\"></a>至此，安装完成。</h2><h3 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h3><h4 id=\"一开机就蓝屏的情况，可以参考以下方法：\"><a href=\"#一开机就蓝屏的情况，可以参考以下方法：\" class=\"headerlink\" title=\"一开机就蓝屏的情况，可以参考以下方法：\"></a>一开机就蓝屏的情况，可以参考以下方法：</h4><h5 id=\"1-配置虚拟内存（20480MB打上）\"><a href=\"#1-配置虚拟内存（20480MB打上）\" class=\"headerlink\" title=\"1. 配置虚拟内存（20480MB打上）\"></a>1. 配置虚拟内存（20480MB打上）</h5><p><img src=\"https://ymxpic.pages.dev/file/68fd31450cfb5356e965e.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/68fd31450cfb5356e965e.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h5 id=\"2-打开功能\"><a href=\"#2-打开功能\" class=\"headerlink\" title=\"2. 打开功能\"></a>2. 打开功能</h5><p><img src=\"https://ymxpic.pages.dev/file/27765d942109e52aa010b.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/27765d942109e52aa010b.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n",
            "tags": [
                "服务器",
                "运维",
                "VMware",
                "Linux",
                "CentOS"
            ]
        }
    ]
}