{
    "version": "https://jsonfeed.org/version/1",
    "title": "叶泯希·杂七杂八的🐕窝 • All posts by \"网络\" tag",
    "description": "叶泯希的个人博客,yeminxiblog",
    "home_page_url": "https://yeminxi.github.io",
    "items": [
        {
            "id": "https://yeminxi.github.io/posts/2d95345a.html",
            "url": "https://yeminxi.github.io/posts/2d95345a.html",
            "title": "第七章 Centos 7 Linux配置ftp 实训任务1：FTP服务器加密传输",
            "date_published": "2024-05-28T05:31:51.000Z",
            "content_html": "<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p><em><strong>&#x3D;&#x3D;前面的DNS一定要成功才能做！！！&#x3D;&#x3D;</strong></em><br>虚拟机需求：1台DNS服务器（Server）、1台Web服务器（Ftp Server）、1台客户端（Client1）</p>\n<blockquote>\n<p><strong>在第五章的基础上继续实训</strong></p>\n</blockquote>\n<h2 id=\"FTP服务器加密传输\"><a href=\"#FTP服务器加密传输\" class=\"headerlink\" title=\"FTP服务器加密传输\"></a>FTP服务器加密传输</h2><blockquote>\n<p>任务情境描述<br>某公司在需要使用vsftpd搭建一台FTP服务器，用于web站点资料的更新和公司公用文件的存放。为了保证客户机和服务器之间传输数据的保密性和完整性，公司决定使用SSL&#x2F;TLS协议加固FTP服务器，客户机和服务器之间采用SSL&#x2F;TLS协议加密数据。</p>\n</blockquote>\n<h2 id=\"任务要求：\"><a href=\"#任务要求：\" class=\"headerlink\" title=\"任务要求：\"></a>任务要求：</h2><blockquote>\n<h3 id=\"1-禁止使用不安全的FTP，请使用“CA”证书颁发机构，颁发的证书，启用FTPS服务；\"><a href=\"#1-禁止使用不安全的FTP，请使用“CA”证书颁发机构，颁发的证书，启用FTPS服务；\" class=\"headerlink\" title=\"1. 禁止使用不安全的FTP，请使用“CA”证书颁发机构，颁发的证书，启用FTPS服务；\"></a>1. 禁止使用不安全的FTP，请使用“CA”证书颁发机构，颁发的证书，启用FTPS服务；</h3><pre><code>Country Name (2 letter code) [XX]:CN\n</code></pre>\n<p>State or Province Name (fullname) []:GD \t \t<br>Locality Name (eg, city) [Default City]:GuangZhou \t<br>    Organization Name (eg, company) [Default Company Ltd]:mydomain.com \t<br>    Organizational Unit Name (eg, section) []:Operations Departments \t<br>    Common Name (eg, your name or your server’s hostname)[]:ftp.mydomain.com</p>\n<h3 id=\"2-使用ftp-mydomian-com域名访问服务器；\"><a href=\"#2-使用ftp-mydomian-com域名访问服务器；\" class=\"headerlink\" title=\"2. 使用ftp.mydomian.com域名访问服务器；\"></a>2. 使用ftp.mydomian.com域名访问服务器；</h3><h3 id=\"3-用户webadmin，登录ftp服务器，根目录为-webdata-；\"><a href=\"#3-用户webadmin，登录ftp服务器，根目录为-webdata-；\" class=\"headerlink\" title=\"3. 用户webadmin，登录ftp服务器，根目录为&#x2F;webdata&#x2F;；\"></a>3. 用户webadmin，登录ftp服务器，根目录为&#x2F;webdata&#x2F;；</h3><h3 id=\"4-登录后限制在自己的根目录；\"><a href=\"#4-登录后限制在自己的根目录；\" class=\"headerlink\" title=\"4. 登录后限制在自己的根目录；\"></a>4. 登录后限制在自己的根目录；</h3><h3 id=\"5-允许WEB管理员上传和下载文件，但是禁止上传后缀名为-doc-docx-xlsx的文件；\"><a href=\"#5-允许WEB管理员上传和下载文件，但是禁止上传后缀名为-doc-docx-xlsx的文件；\" class=\"headerlink\" title=\"5. 允许WEB管理员上传和下载文件，但是禁止上传后缀名为.doc .docx .xlsx的文件；\"></a>5. 允许WEB管理员上传和下载文件，但是禁止上传后缀名为.doc .docx .xlsx的文件；</h3><h3 id=\"6-限制用户的下载最大速度为100kb-s；最大同一IP在线人数为2人；\"><a href=\"#6-限制用户的下载最大速度为100kb-s；最大同一IP在线人数为2人；\" class=\"headerlink\" title=\"6. 限制用户的下载最大速度为100kb&#x2F;s；最大同一IP在线人数为2人；\"></a>6. 限制用户的下载最大速度为100kb&#x2F;s；最大同一IP在线人数为2人；</h3><h3 id=\"7-用于通过工具或者浏览器下载的最大速度不超过100kb-s；\"><a href=\"#7-用于通过工具或者浏览器下载的最大速度不超过100kb-s；\" class=\"headerlink\" title=\"7.用于通过工具或者浏览器下载的最大速度不超过100kb&#x2F;s；\"></a>7.用于通过工具或者浏览器下载的最大速度不超过100kb&#x2F;s；</h3><h3 id=\"8-一个IP地址同时登陆的用户进程-人数不超过2人。\"><a href=\"#8-一个IP地址同时登陆的用户进程-人数不超过2人。\" class=\"headerlink\" title=\"8. 一个IP地址同时登陆的用户进程&#x2F;人数不超过2人。\"></a>8. 一个IP地址同时登陆的用户进程&#x2F;人数不超过2人。</h3></blockquote>\n<h2 id=\"一、配置Ftp服务器（Ftp-Server）的IP地址\"><a href=\"#一、配置Ftp服务器（Ftp-Server）的IP地址\" class=\"headerlink\" title=\"一、配置Ftp服务器（Ftp Server）的IP地址\"></a>一、配置Ftp服务器（Ftp Server）的IP地址</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">BOOTPROTO=static</span><br><span class=\"line\">IPADDR=192.168.1.100</span><br><span class=\"line\">GATEWAY=192.168.1.2</span><br><span class=\"line\">NETMASK=255.255.255.0</span><br><span class=\"line\">DNS1=192.168.1.10</span><br><span class=\"line\">DNS2=202.96.128.86</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/b3c12c42b1a1943313648.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/b3c12c42b1a1943313648.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"二、-为Ftp服务器（Ftp-Server）安装vsftp服务\"><a href=\"#二、-为Ftp服务器（Ftp-Server）安装vsftp服务\" class=\"headerlink\" title=\"二、 为Ftp服务器（Ftp Server）安装vsftp服务\"></a>二、 为Ftp服务器（Ftp Server）安装vsftp服务</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install vsftpd\t<span class=\"comment\">//安装vsftp服务</span></span><br><span class=\"line\">systemctl start vsftpd\t<span class=\"comment\">//开启vsftp服务</span></span><br><span class=\"line\">systemctl enable vsftpd\t<span class=\"comment\">//开机自启</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/da457df601a02990e21fc.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/da457df601a02990e21fc.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"三、Ftp服务器（Ftp-Server）生成证书\"><a href=\"#三、Ftp服务器（Ftp-Server）生成证书\" class=\"headerlink\" title=\"三、Ftp服务器（Ftp Server）生成证书\"></a>三、Ftp服务器（Ftp Server）生成证书</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">创建目录[root<span class=\"meta\">@webserver</span> webserver]# mkdir /etc/ssl/serverkey</span><br><span class=\"line\">生成证书[root<span class=\"meta\">@webserver</span> webserver]# openssl req -x509 -nodes -keyout /etc/ssl/serverkey/vsftpd.pem -out /etc/ssl/serverkey/vsftpd.pem -days <span class=\"number\">365</span> -newkey rsa:<span class=\"number\">2048</span></span><br><span class=\"line\">Generating a <span class=\"number\">2048</span> bit RSA <span class=\"keyword\">private</span> key</span><br><span class=\"line\">................+++</span><br><span class=\"line\">.....+++</span><br><span class=\"line\">writing <span class=\"keyword\">new</span> <span class=\"title class_\">private</span> key to <span class=\"string\">&#x27;/etc/ssl/serverkey/vsftpd.pem&#x27;</span></span><br><span class=\"line\">-----</span><br><span class=\"line\">You are about to be asked to enter information that will be incorporated</span><br><span class=\"line\">into your certificate request.</span><br><span class=\"line\">What you are about to enter is what is called a Distinguished Name or a DN.</span><br><span class=\"line\">There are quite a few fields but you can leave some blank</span><br><span class=\"line\">For some fields there will be a <span class=\"keyword\">default</span> value,</span><br><span class=\"line\">If you enter <span class=\"string\">&#x27;.&#x27;</span>, the field will be left blank.</span><br><span class=\"line\">-----</span><br><span class=\"line\">Country <span class=\"title function_\">Name</span> <span class=\"params\">(<span class=\"number\">2</span> letter code)</span> [CN]:</span><br><span class=\"line\">State or Province <span class=\"title function_\">Name</span> <span class=\"params\">(full name)</span> [China]:GD</span><br><span class=\"line\">Locality <span class=\"title function_\">Name</span> <span class=\"params\">(eg, city)</span> [GuangZhou]:</span><br><span class=\"line\">Organization <span class=\"title function_\">Name</span> <span class=\"params\">(eg, company)</span> [ymx.com]:</span><br><span class=\"line\">Organizational Unit <span class=\"title function_\">Name</span> <span class=\"params\">(eg, section)</span> []:Operations Departments</span><br><span class=\"line\">Common <span class=\"title function_\">Name</span> <span class=\"params\">(eg, your name or your server<span class=\"string\">&#x27;s hostname) []:ftp.ymx.com</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"params\">Email Address []:</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"params\">[root@webserver webserver]#</span></span></span><br></pre></td></tr></table></figure>\n<p>图片打反了 别按照图片 按上面的文本<br><img src=\"https://ymxpic.pages.dev/file/173428ff934d91c26fc94.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/173428ff934d91c26fc94.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"四、-Ftp服务器（Ftp-Server）防火墙设置\"><a href=\"#四、-Ftp服务器（Ftp-Server）防火墙设置\" class=\"headerlink\" title=\"四、 Ftp服务器（Ftp Server）防火墙设置\"></a>四、 Ftp服务器（Ftp Server）防火墙设置</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">允许ftp通过[root<span class=\"meta\">@webserver</span> webserver]# firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-service=ftp</span><br><span class=\"line\">success</span><br><span class=\"line\">允许端口通过[root<span class=\"meta\">@webserver</span> webserver]# firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-port=<span class=\"number\">990</span>/tcp</span><br><span class=\"line\">success</span><br><span class=\"line\">允许端口通过[root<span class=\"meta\">@webserver</span> webserver]# firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-port=<span class=\"number\">990</span>/udp</span><br><span class=\"line\">success</span><br><span class=\"line\">允许端口通过[root<span class=\"meta\">@webserver</span> webserver]# firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-port=<span class=\"number\">40000</span>-<span class=\"number\">50000</span>/tcp</span><br><span class=\"line\">success</span><br><span class=\"line\">允许端口通过[root<span class=\"meta\">@webserver</span> webserver]# firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-port=<span class=\"number\">40000</span>-<span class=\"number\">50000</span>/udp</span><br><span class=\"line\">success</span><br><span class=\"line\">重启防火墙[root<span class=\"meta\">@webserver</span> webserver]# firewall-cmd --reload </span><br><span class=\"line\">success</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/cb7bc5a7b1bc7e530010d.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/cb7bc5a7b1bc7e530010d.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"五、-Ftp服务器（Ftp-Server）配置vsftp文件\"><a href=\"#五、-Ftp服务器（Ftp-Server）配置vsftp文件\" class=\"headerlink\" title=\"五、 Ftp服务器（Ftp Server）配置vsftp文件\"></a>五、 Ftp服务器（Ftp Server）配置vsftp文件</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/vsftpd/vsftpd.conf</span><br></pre></td></tr></table></figure>\n<p>最后插入</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssl_enable=yes</span><br><span class=\"line\">ssl_tlsv1=yes</span><br><span class=\"line\">ssl_sslv2=no</span><br><span class=\"line\">ssl_sslv3=no</span><br><span class=\"line\">rsa_private_key_file=/etc/ssl/serverkey/vsftpd.pem</span><br><span class=\"line\">rsa_cert_file=/etc/ssl/serverkey/vsftpd.pem</span><br><span class=\"line\">allow_anon_ssl=no</span><br><span class=\"line\">force_local_logins_ssl=yes</span><br><span class=\"line\">force_local_data_ssl=yes</span><br><span class=\"line\">pasv_min_port=40000</span><br><span class=\"line\">pasv_max_port=50000</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart vsftpd\t<span class=\"comment\">//重启</span></span><br></pre></td></tr></table></figure>\n<p>图片打错了请按照上面文本打<br><img src=\"https://ymxpic.pages.dev/file/7ffae0727a56d9d65892a.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/7ffae0727a56d9d65892a.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br><img src=\"https://ymxpic.pages.dev/file/9b2f1e351d05e8dcd8e28.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/9b2f1e351d05e8dcd8e28.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"六、创建用户和根目录以及虚拟用户（详情看学习通ftp虚拟用户章节-这里不做过多解释）\"><a href=\"#六、创建用户和根目录以及虚拟用户（详情看学习通ftp虚拟用户章节-这里不做过多解释）\" class=\"headerlink\" title=\"六、创建用户和根目录以及虚拟用户（详情看学习通ftp虚拟用户章节 这里不做过多解释）\"></a>六、创建用户和根目录以及虚拟用户（详情看学习通ftp虚拟用户章节 这里不做过多解释）</h2><p>看不懂去看ppt</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# useradd webadmin -s /sbin/nologin </span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# useradd admin -s /sbin/nologin  </span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# passwd --stdin webadmin </span><br><span class=\"line\">更改用户 webadmin 的密码 。</span><br><span class=\"line\">root</span><br><span class=\"line\">passwd：所有的身份验证令牌已经成功更新。</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# passwd --stdin admin</span><br><span class=\"line\">更改用户 admin 的密码 。</span><br><span class=\"line\">root</span><br><span class=\"line\">passwd：所有的身份验证令牌已经成功更新。</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# vim /etc/vsftpd/vusr.txt </span><br><span class=\"line\">webadmin</span><br><span class=\"line\">root</span><br><span class=\"line\">admin</span><br><span class=\"line\">root</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# mkdir -p /<span class=\"keyword\">var</span>/ftp/pub/ /webdata</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# chmod <span class=\"number\">777</span> /webdata</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# chown webadmin /<span class=\"keyword\">var</span>/ftp/pub/ /webdata</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# rpm -qf /usr/bin/db_load</span><br><span class=\"line\">libdb-utils-<span class=\"number\">5.3</span><span class=\"number\">.21</span>-<span class=\"number\">24.</span>el7.x86_64</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# db_load -T -t hash -f /etc/vsftpd/vusr.txt /etc/vsftpd/vusr.db</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# file /etc/vsftpd/vusr.db</span><br><span class=\"line\">/etc/vsftpd/vusr.db: Berkeley <span class=\"title function_\">DB</span> <span class=\"params\">(Hash, version <span class=\"number\">9</span>, <span class=\"keyword\">native</span> <span class=\"type\">byte</span>-order)</span></span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# chmod <span class=\"number\">600</span> /etc/vsftpd/vusr.*</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# cp -p /etc/pam.d/vsftpd /etc/pam.d/vsftpd-vusr</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# vim /etc/pam.d/vsftpd-vusr</span><br><span class=\"line\">auth       sufficient   /lib64/security/pam_userdb.so db=/etc/vsftpd/vusr</span><br><span class=\"line\">account    sufficient   /lib64/security/pam_userdb.so db=/etc/vsftpd/vusr</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# vim /etc/vsftpd/vsftpd.conf </span><br><span class=\"line\">local_enable=yes</span><br><span class=\"line\">chroot_local_user=yes</span><br><span class=\"line\">pam_service_name=vsftpd-vusr</span><br><span class=\"line\">guest_enable=yes</span><br><span class=\"line\">guest_username=webadmin</span><br><span class=\"line\">user_config_dir=/etc/vsftpd/vconfig</span><br><span class=\"line\">virtual_use_local_privs=yes</span><br><span class=\"line\">allow_writeable_chroot=yes</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# mkdir /etc/vsftpd/vconfig/</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# vim /etc/vsftpd/vconfig/webadmin</span><br><span class=\"line\">local_root=/webdata</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# vim /etc/vsftpd/vconfig/admin</span><br><span class=\"line\">local_root=/webdata</span><br><span class=\"line\">write_enable=no</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# setsebool -P ftpd_full_access on</span><br><span class=\"line\">[root<span class=\"meta\">@webserver</span> webserver]# systemctl restart vsftpd</span><br></pre></td></tr></table></figure>\n<h2 id=\"七、-使用域名登录要在Dns服务器（Dns-Server）上正反向加上一条（略过）\"><a href=\"#七、-使用域名登录要在Dns服务器（Dns-Server）上正反向加上一条（略过）\" class=\"headerlink\" title=\"七、 使用域名登录要在Dns服务器（Dns Server）上正反向加上一条（略过）\"></a>七、 使用域名登录要在Dns服务器（Dns Server）上正反向加上一条（略过）</h2><p><img src=\"https://ymxpic.pages.dev/file/204c48d07d06906775de2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/204c48d07d06906775de2.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"八、任务需求后四项Ftp服务器（Ftp-Server）上修改配置文件\"><a href=\"#八、任务需求后四项Ftp服务器（Ftp-Server）上修改配置文件\" class=\"headerlink\" title=\"八、任务需求后四项Ftp服务器（Ftp Server）上修改配置文件\"></a>八、任务需求后四项Ftp服务器（Ftp Server）上修改配置文件</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/vsftpd/vsftpd.conf</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#允许WEB管理员上传和下载文件，但是禁止上传后缀名为.doc .docx .xlsx的文件；</span><br><span class=\"line\">deny_file=&#123;*.doc,*.docx,*.xlsx&#125;</span><br><span class=\"line\">#限制用户的下载最大速度为100kb/s；用于通过工具或者浏览器下载的最大速度不超过100kb/s；人数为<span class=\"number\">2</span>人；</span><br><span class=\"line\">local_max_rate=<span class=\"number\">102400</span></span><br><span class=\"line\">#最大同一IP在线</span><br><span class=\"line\">max_per_ip=<span class=\"number\">2</span></span><br><span class=\"line\">#一个IP地址同时登陆的用户进程/人数不超过<span class=\"number\">2</span>人。</span><br><span class=\"line\">max_clients=<span class=\"number\">2</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart vsftpd</span><br></pre></td></tr></table></figure>\n<h2 id=\"九、客户端（client1）测试\"><a href=\"#九、客户端（client1）测试\" class=\"headerlink\" title=\"九、客户端（client1）测试\"></a>九、客户端（client1）测试</h2><h3 id=\"1-安装ftp服务和FileZilla\"><a href=\"#1-安装ftp服务和FileZilla\" class=\"headerlink\" title=\"1. 安装ftp服务和FileZilla\"></a>1. 安装ftp服务和FileZilla</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install epel-release</span><br><span class=\"line\">yum -y install filezilla</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/fa01511cce2858dc00271.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/fa01511cce2858dc00271.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-创建测试文件\"><a href=\"#2-创建测试文件\" class=\"headerlink\" title=\"2. 创建测试文件\"></a>2. 创建测试文件</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@client</span> server]# mkdir /home/server/test <span class=\"comment\">/*server是我的用户名，看情况来*/</span></span><br><span class=\"line\">[root<span class=\"meta\">@client</span> server]# chmod <span class=\"number\">777</span>  /home/server/test</span><br><span class=\"line\">[root<span class=\"meta\">@client</span> server]# cd /home/server/test/</span><br><span class=\"line\">[root<span class=\"meta\">@client</span> test]# vim test.txt</span><br><span class=\"line\">[root<span class=\"meta\">@client</span> test]# vim test.doc</span><br><span class=\"line\">[root<span class=\"meta\">@client</span> test]# vim test.docx</span><br><span class=\"line\">[root<span class=\"meta\">@client</span> test]# vim test.xlsx</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-尝试域名带证书CA登录ftp\"><a href=\"#3-尝试域名带证书CA登录ftp\" class=\"headerlink\" title=\"3. 尝试域名带证书CA登录ftp\"></a>3. 尝试域名带证书CA登录ftp</h3><p><img src=\"https://ymxpic.pages.dev/file/cbc7ba60aae41fa13abc7.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/cbc7ba60aae41fa13abc7.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br><img src=\"https://ymxpic.pages.dev/file/9fefc4d3e02513f54f15f.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/9fefc4d3e02513f54f15f.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br><img src=\"https://ymxpic.pages.dev/file/45c7673c5fb3db94c02c4.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/45c7673c5fb3db94c02c4.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br>登录成功！</p>\n<h3 id=\"4-尝试禁止上传文件类型上传\"><a href=\"#4-尝试禁止上传文件类型上传\" class=\"headerlink\" title=\"4.  尝试禁止上传文件类型上传\"></a>4.  尝试禁止上传文件类型上传</h3><p><img src=\"https://ymxpic.pages.dev/file/1c3ebb110203217f2412e.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/1c3ebb110203217f2412e.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br>上传失败！</p>\n<h3 id=\"5-尝试下载文件\"><a href=\"#5-尝试下载文件\" class=\"headerlink\" title=\"5. 尝试下载文件\"></a>5. 尝试下载文件</h3><p><img src=\"https://ymxpic.pages.dev/file/9583e247ad1aa7c6720bc.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/9583e247ad1aa7c6720bc.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br>成功！</p>\n<h3 id=\"6-单IP多用户登录\"><a href=\"#6-单IP多用户登录\" class=\"headerlink\" title=\"6. 单IP多用户登录\"></a>6. 单IP多用户登录</h3><p><img src=\"https://ymxpic.pages.dev/file/6257891a3377c2add1e27.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/6257891a3377c2add1e27.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br>最多只能2个不能再多了！</p>\n<h2 id=\"至此，实验结束。\"><a href=\"#至此，实验结束。\" class=\"headerlink\" title=\"至此，实验结束。\"></a>至此，实验结束。</h2>",
            "tags": [
                "服务器",
                "Linux",
                "CentOS",
                "网络",
                "FTP"
            ]
        },
        {
            "id": "https://yeminxi.github.io/posts/974b3ed7.html",
            "url": "https://yeminxi.github.io/posts/974b3ed7.html",
            "title": "第五章 Centos 7 Linux配置dns 实训任务：部署DNS服务器",
            "date_published": "2024-05-28T04:32:51.000Z",
            "content_html": "<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>虚拟机需求：1台服务器（Server）、1台客户端（Client1）</p>\n<blockquote>\n<p><strong>在第四章的基础上继续实训</strong></p>\n</blockquote>\n<h2 id=\"部署DNS服务器\"><a href=\"#部署DNS服务器\" class=\"headerlink\" title=\"部署DNS服务器\"></a>部署DNS服务器</h2><blockquote>\n<h3 id=\"任务情境描述\"><a href=\"#任务情境描述\" class=\"headerlink\" title=\"任务情境描述\"></a>任务情境描述</h3><p>某公司要求在内部网络部署DNS服务器，用内部DNS服务器为内部网络中的计算机提供内部网络和Internet的域名解析服务。</p>\n</blockquote>\n<h3 id=\"网络拓扑图如下：\"><a href=\"#网络拓扑图如下：\" class=\"headerlink\" title=\"网络拓扑图如下：\"></a>网络拓扑图如下：</h3><p><img src=\"https://ymxpic.pages.dev/file/9a3bf5e11c452db3f7c9d.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/9a3bf5e11c452db3f7c9d.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<blockquote>\n<h3 id=\"环境说明：\"><a href=\"#环境说明：\" class=\"headerlink\" title=\"环境说明：\"></a>环境说明：</h3><p>（1） server安装CentOS 7基础设施服务器</p>\n<p>（2） client安装CentOS 7桌面环境</p>\n<p>（3） server、client均已配置网络和主机名（配置了第四章就不用配置了）</p>\n</blockquote>\n<blockquote>\n<h3 id=\"部署信息如下：\"><a href=\"#部署信息如下：\" class=\"headerlink\" title=\"部署信息如下：\"></a>部署信息如下：</h3><p>（1） 公司的DNS域名为 ymx.com（或自己命名）&#x2F;&#x2F;这里我用了自己的，用老师的是myhost.com下面表格也要跟着改</p>\n<p>（2） 名称解释要求如下表所示：</p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th>角色</th>\n<th>主机名</th>\n<th>IP地址</th>\n<th>备注</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Web服务器</td>\n<td><a href=\"http://www.ymx.com/\">www.ymx.com</a></td>\n<td>192.168.1.100</td>\n<td></td>\n</tr>\n<tr>\n<td>FTP服务器</td>\n<td>ftp.ymx.com</td>\n<td>192.168.1.100</td>\n<td>配置别名记录</td>\n</tr>\n<tr>\n<td>邮件服务器</td>\n<td>mail.ymx.com</td>\n<td>192.168.1.200</td>\n<td>配置相应的交换记录</td>\n</tr>\n<tr>\n<td>DNS服务器</td>\n<td>dns.ymx.com</td>\n<td>192.168.1.10</td>\n<td>DNS服务器</td>\n</tr>\n</tbody></table>\n<blockquote>\n<h3 id=\"任务1（用前面的就不用重新配置了）\"><a href=\"#任务1（用前面的就不用重新配置了）\" class=\"headerlink\" title=\"任务1（用前面的就不用重新配置了）\"></a>任务1（用前面的就不用重新配置了）</h3><p>根据上图中的网络图谱配置实训环境</p>\n<p>（1） 修改计算机名</p>\n<p>（2） 配置网络</p>\n<p>（3）开启防火墙，添加对应的服务</p>\n</blockquote>\n<blockquote>\n<h3 id=\"任务2\"><a href=\"#任务2\" class=\"headerlink\" title=\"任务2\"></a>任务2</h3><p>在server1上安装DNS服务，并将其配置为主DNS服务器</p>\n<p>（1） 安装DNS服务</p>\n<p>（2） 创建正向查找区域，并根据上表提供的信息在区域中添加资源记录；<br>          创建反向查找区域，并根据上表提供的信息在区域中添加资源记录；</p>\n<p>（3） 检查区域数据文件语法错误</p>\n<p>（4） 启动&#x2F;重启DNS服务</p>\n<p>（5） 开启防火墙，添加对应的服务</p>\n</blockquote>\n<blockquote>\n<h3 id=\"任务3\"><a href=\"#任务3\" class=\"headerlink\" title=\"任务3\"></a>任务3</h3><p>使用client对主DNS服务器进行测试</p>\n<p>（1） client网络配置</p>\n<p>（2） 在客户端执行DNS域名查询测试，对主&#x2F;辅DNS均进行域名查询测试（可使用命令指令使用主NDS或服务DNS进行查询）</p>\n</blockquote>\n<h2 id=\"一、在服务器（Server）上安装DNS服务\"><a href=\"#一、在服务器（Server）上安装DNS服务\" class=\"headerlink\" title=\"一、在服务器（Server）上安装DNS服务\"></a>一、在服务器（Server）上安装DNS服务</h2><h3 id=\"1-确保良好的网络连接也要保证设备的联网\"><a href=\"#1-确保良好的网络连接也要保证设备的联网\" class=\"headerlink\" title=\"1. 确保良好的网络连接也要保证设备的联网\"></a>1. 确保良好的网络连接也要保证设备的联网</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum list installed | grep bind \t\t\t\t\\\\查看是否安装了dns服务</span><br><span class=\"line\">yum -y install bind\t\t\t\t\t\t\t\\\\安装dns服务</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/5ecdc267b84b5e1eecf9b.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/5ecdc267b84b5e1eecf9b.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-启动服务\"><a href=\"#2-启动服务\" class=\"headerlink\" title=\"2. 启动服务\"></a>2. 启动服务</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start named\t\t<span class=\"comment\">//启动dns服务</span></span><br><span class=\"line\">systemctl enable named\t\t<span class=\"comment\">//开机自启dns服务</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/b0450986f32adae814627.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/b0450986f32adae814627.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"2\"></p>\n<h3 id=\"3-防火墙配置\"><a href=\"#3-防火墙配置\" class=\"headerlink\" title=\"3. 防火墙配置\"></a>3. 防火墙配置</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-port=<span class=\"number\">53</span>/tcp\t<span class=\"comment\">//开启53端口</span></span><br><span class=\"line\">firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-port=<span class=\"number\">53</span>/udp</span><br><span class=\"line\">firewall-cmd --reload\t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//重启防火墙</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/39be9522b5ad2f238d32f.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/39be9522b5ad2f238d32f.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"二、在服务器（Server）上配置dns服务\"><a href=\"#二、在服务器（Server）上配置dns服务\" class=\"headerlink\" title=\"二、在服务器（Server）上配置dns服务\"></a>二、在服务器（Server）上配置dns服务</h2><h3 id=\"1-配置全局服务实现高速缓存\"><a href=\"#1-配置全局服务实现高速缓存\" class=\"headerlink\" title=\"1.配置全局服务实现高速缓存\"></a>1.配置全局服务实现高速缓存</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/named.conf\t\t<span class=\"comment\">//打开配置文件进行如下修改</span></span><br><span class=\"line\">named-checkconf\t\t\t<span class=\"comment\">//检查语法</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/86b0e18dd3c088a584d48.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/86b0e18dd3c088a584d48.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">listen-on port 53 &#123; any; &#125;;\t\t\t\t\t\t\t//改为any，named监听所有IP地址</span><br><span class=\"line\">allow-query     &#123; any; &#125;;\t\t\t\t\t\t\t//改为any，接受所有客户端的查询</span><br><span class=\"line\">forwarders      &#123;202.96.128.86;202.96.128.166;&#125;;\t//添加该项，配置转发器</span><br><span class=\"line\">dnssec-enable no;\t\t\t\t\t\t\t\t\t//改为no，禁用dnssec</span><br><span class=\"line\">dnssec-validation no;\t\t\t\t\t\t\t\t</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/f8db812aa6e49d4dc1883.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/f8db812aa6e49d4dc1883.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<blockquote>\n<p>检查语法发现错误，是因为我第22行打错单词了，重新编辑改回去就不报错了。</p>\n</blockquote>\n<h3 id=\"2-创建定义DNS服务器正向、反向查找区域\"><a href=\"#2-创建定义DNS服务器正向、反向查找区域\" class=\"headerlink\" title=\"2. 创建定义DNS服务器正向、反向查找区域\"></a>2. 创建定义DNS服务器正向、反向查找区域</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/named.conf\t\t<span class=\"comment\">//打开配置文件进行如下修改</span></span><br><span class=\"line\">named-checkconf\t\t\t<span class=\"comment\">//检查语法</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/4b50564b4ea5063d89f52.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/4b50564b4ea5063d89f52.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">zone &quot;ymx.com&quot; IN &#123;\t\t\t\t\t\t\t//DNS域名</span><br><span class=\"line\">        type master;\t\t\t\t\t\t//区域类型为主要区域</span><br><span class=\"line\">        file &quot;ymx.com.zone&quot;;\t\t\t\t//区域数据存储文件名，位置默认为 /var/named 目录</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">zone &quot;1.168.192.in-addr.arpa&quot; IN &#123;\t\t\t//子网地址需要反写，后缀是固定的</span><br><span class=\"line\">        type master;\t\t\t\t\t\t//区域类型为主要区域</span><br><span class=\"line\">        file &quot;1.168.192.zone&quot;;\t\t\t\t//区域数据存储文件名，位置默认为 /var/named 目录</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>如是按照题目（myhost.com）来的话如下:</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">zone &quot;myhost.com&quot; IN &#123;\t\t\t\t\t\t\t//DNS域名</span><br><span class=\"line\">        type master;\t\t\t\t\t\t//区域类型为主要区域</span><br><span class=\"line\">        file &quot;myhost.com.zone&quot;;\t\t\t\t//区域数据存储文件名，位置默认为 /var/named 目录</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">zone &quot;1.168.192.in-addr.arpa&quot; IN &#123;\t\t\t//子网地址需要反写，后缀是固定的</span><br><span class=\"line\">        type master;\t\t\t\t\t\t//区域类型为主要区域</span><br><span class=\"line\">        file &quot;1.168.192.zone&quot;;\t\t\t\t//区域数据存储文件名，位置默认为 /var/named 目录</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-创建区域数据文件\"><a href=\"#3-创建区域数据文件\" class=\"headerlink\" title=\"3. 创建区域数据文件\"></a>3. 创建区域数据文件</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /<span class=\"keyword\">var</span>/named</span><br><span class=\"line\">cp -a named.localhost ymx.com.zone\t\t<span class=\"comment\">//创建正向区域数据文件</span></span><br><span class=\"line\">cp -a named.loopback <span class=\"number\">1.168</span><span class=\"number\">.192</span>.zone\t\t<span class=\"comment\">//创建反向区域数据文件</span></span><br><span class=\"line\">systemctl restart named\t\t\t\t\t<span class=\"comment\">//重启dns服务</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>如是按照题目（myhost.com）来的话如下:</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /<span class=\"keyword\">var</span>/named</span><br><span class=\"line\">cp -a named.localhost myhost.com.zone\t<span class=\"comment\">//创建正向区域数据文件</span></span><br><span class=\"line\">cp -a named.loopback <span class=\"number\">1.168</span><span class=\"number\">.192</span>.zone\t\t<span class=\"comment\">//创建反向区域数据文件</span></span><br><span class=\"line\">systemctl restart named\t\t\t\t\t<span class=\"comment\">//重启dns服务</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"4-编辑正向区域数据文件\"><a href=\"#4-编辑正向区域数据文件\" class=\"headerlink\" title=\"4. 编辑正向区域数据文件\"></a>4. 编辑正向区域数据文件</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim ymx.com.zone\t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//编辑正向区域数据</span></span><br><span class=\"line\">named-checkzone ymx.com.zone  /<span class=\"keyword\">var</span>/named/ymx.com.zone\t<span class=\"comment\">//检查语法</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/2c79ad9474f20745df0c5.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/2c79ad9474f20745df0c5.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$TTL 1D</span><br><span class=\"line\">@       IN SOA  dns ymx.com. (\t\t\t\t\t\t\t\t\t//区域授权服务器</span><br><span class=\"line\">                                        0       ; serial</span><br><span class=\"line\">                                        1D      ; refresh</span><br><span class=\"line\">                                        1H      ; retry</span><br><span class=\"line\">                                        1W      ; expire</span><br><span class=\"line\">                                        3H )    ; minimum</span><br><span class=\"line\">        NS      dns</span><br><span class=\"line\">dns     A       192.168.1.10\t\t\t\t\t\t\t\t\t//名称服务器记录</span><br><span class=\"line\">www     A       192.168.1.100\t\t\t\t\t\t\t\t\t//主机记录</span><br><span class=\"line\">mail    A       192.168.1.200</span><br><span class=\"line\">ftp     CNAME   www\t\t\t\t\t\t\t\t\t\t\t\t//别名记录</span><br><span class=\"line\">mail    MX 10   mail\t\t\t\t\t\t\t\t\t\t\t//邮箱交换器记录</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>如是按照题目（myhost.com）来的话如下:</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim myhost.com.zone\t\t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//编辑正向区域数据</span></span><br><span class=\"line\">named-checkzone myhost.com.zone  /<span class=\"keyword\">var</span>/named/myhost.com.zone\t<span class=\"comment\">//检查语法</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$TTL 1D</span><br><span class=\"line\">@       IN SOA  server myhost.com. (\t\t\t\t\t\t\t\t\t//区域授权服务器</span><br><span class=\"line\">                                        0       ; serial</span><br><span class=\"line\">                                        1D      ; refresh</span><br><span class=\"line\">                                        1H      ; retry</span><br><span class=\"line\">                                        1W      ; expire</span><br><span class=\"line\">                                        3H )    ; minimum</span><br><span class=\"line\">        NS      server</span><br><span class=\"line\">server  A       192.168.1.10\t\t\t\t\t\t\t\t\t//名称服务器记录</span><br><span class=\"line\">www     A       192.168.1.100\t\t\t\t\t\t\t\t\t//主机记录</span><br><span class=\"line\">mail    A       192.168.1.200</span><br><span class=\"line\">ftp     CNAME   www\t\t\t\t\t\t\t\t\t\t\t\t//别名记录</span><br><span class=\"line\">mail    MX 10   mail\t\t\t\t\t\t\t\t\t\t\t//邮箱交换器记录</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/d959c88b2a0ba4d313c6d.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/d959c88b2a0ba4d313c6d.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"5-编辑反向区域数据文件\"><a href=\"#5-编辑反向区域数据文件\" class=\"headerlink\" title=\"5. 编辑反向区域数据文件\"></a>5. 编辑反向区域数据文件</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim <span class=\"number\">1.168</span><span class=\"number\">.192</span>.zone \t\t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//编辑反向区域数据</span></span><br><span class=\"line\">named-checkzone <span class=\"number\">1.168</span><span class=\"number\">.192</span>.zone  /<span class=\"keyword\">var</span>/named/<span class=\"number\">1.168</span><span class=\"number\">.192</span>.zone\t<span class=\"comment\">//检查语法</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/0e74a1c1bf31a363b73fc.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/0e74a1c1bf31a363b73fc.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$TTL 1D</span><br><span class=\"line\">@       IN SOA  dns ymx.com. (\t\t\t\t\t\t\t\t//区域授权的DNS服务器</span><br><span class=\"line\">                                        0       ; serial</span><br><span class=\"line\">                                        1D      ; refresh</span><br><span class=\"line\">                                        1H      ; retry</span><br><span class=\"line\">                                        1W      ; expire</span><br><span class=\"line\">                                        3H )    ; minimum</span><br><span class=\"line\">        NS      dns\t\t\t\t\t\t\t\t\t\t\t//名称服务器记录</span><br><span class=\"line\">dns     A       192.168.1.10\t\t\t\t\t\t\t\t//指针记录</span><br><span class=\"line\">10      PTR     dns.ymx.com.</span><br><span class=\"line\">100     PTR     www.ymx.com.</span><br><span class=\"line\">100     PTR     ftp.ymx.com.</span><br><span class=\"line\">200     PTR     mail.ymx.com.</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/85bd8de0c3edd41d5bf9c.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/85bd8de0c3edd41d5bf9c.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<blockquote>\n<p>如是按照题目（myhost.com）来的话如下:</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim <span class=\"number\">1.168</span><span class=\"number\">.192</span>.zone \t\t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//编辑反向区域数据</span></span><br><span class=\"line\">named-checkzone <span class=\"number\">1.168</span><span class=\"number\">.192</span>.zone  /<span class=\"keyword\">var</span>/named/<span class=\"number\">1.168</span><span class=\"number\">.192</span>.zone\t<span class=\"comment\">//检查语法</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$TTL 1D</span><br><span class=\"line\">@       IN SOA  server myhost.com. (\t\t\t\t\t\t\t//区域授权的DNS服务器</span><br><span class=\"line\">                                        0       ; serial</span><br><span class=\"line\">                                        1D      ; refresh</span><br><span class=\"line\">                                        1H      ; retry</span><br><span class=\"line\">                                        1W      ; expire</span><br><span class=\"line\">                                        3H )    ; minimum</span><br><span class=\"line\">        NS      server\t\t\t\t\t\t\t\t\t\t\t//名称服务器记录</span><br><span class=\"line\">server  A       192.168.1.10\t\t\t\t\t\t\t\t\t//指针记录</span><br><span class=\"line\">10      PTR     server.myhost.com.\t\t\t\t\t\t</span><br><span class=\"line\">100     PTR     www.myhost.com.</span><br><span class=\"line\">100     PTR     ftp.myhost.com.</span><br><span class=\"line\">200     PTR     mail.myhost.com.</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>若语法检查无错误<br><img src=\"https://ymxpic.pages.dev/file/224df854a0c755daf9fd2.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/224df854a0c755daf9fd2.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart named\t\t<span class=\"comment\">//重启dns服务，且无返回信息则成功</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/97139188680461f22a0fb.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/97139188680461f22a0fb.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"三、在客户端（Client1）上进行测试\"><a href=\"#三、在客户端（Client1）上进行测试\" class=\"headerlink\" title=\"三、在客户端（Client1）上进行测试\"></a>三、在客户端（Client1）上进行测试</h2><h3 id=\"1-重新获取\"><a href=\"#1-重新获取\" class=\"headerlink\" title=\"1. 重新获取\"></a>1. 重新获取</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dhclient -r\t\t\t\t\t\t<span class=\"comment\">//释放租约</span></span><br><span class=\"line\">dhclient\t\t\t\t\t\t<span class=\"comment\">//重新获取租约</span></span><br><span class=\"line\">tail /etc/resolv.conf\t\t\t<span class=\"comment\">//查看客户端使用的DNS服务器</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/c58f7e03dfb8e3bc9fabd.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/c58f7e03dfb8e3bc9fabd.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-nslookup非交互式操作\"><a href=\"#2-nslookup非交互式操作\" class=\"headerlink\" title=\"2. nslookup非交互式操作\"></a>2. nslookup非交互式操作</h3><h4 id=\"2-1-测试正向解析\"><a href=\"#2-1-测试正向解析\" class=\"headerlink\" title=\"2.1 测试正向解析\"></a>2.1 测试正向解析</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nslookup www.ymx.com</span><br><span class=\"line\">nslookup ftp.ymx.com</span><br><span class=\"line\">nslookup mail.ymx.com</span><br><span class=\"line\">nslookup www.baidu.com</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/bc4dce8064bee257697bd.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/bc4dce8064bee257697bd.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h4 id=\"2-2-测试反向解析\"><a href=\"#2-2-测试反向解析\" class=\"headerlink\" title=\"2.2 测试反向解析\"></a>2.2 测试反向解析</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nslookup <span class=\"number\">202.108</span><span class=\"number\">.22</span><span class=\"number\">.5</span></span><br><span class=\"line\">nslookup <span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.10</span></span><br><span class=\"line\">nslookup <span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.100</span></span><br><span class=\"line\">nslookup <span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.200</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/bedfef08fa7af8e7af35e.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/bedfef08fa7af8e7af35e.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"3-nslookup交互式操作（知道就好不用做）\"><a href=\"#3-nslookup交互式操作（知道就好不用做）\" class=\"headerlink\" title=\"3. nslookup交互式操作（知道就好不用做）\"></a>3. nslookup交互式操作（知道就好不用做）</h3><h4 id=\"3-1-查看所有配置\"><a href=\"#3-1-查看所有配置\" class=\"headerlink\" title=\"3.1 查看所有配置\"></a>3.1 查看所有配置</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nslookup</span><br><span class=\"line\">set all</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/0d52dfe4f10aa0e388467.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/0d52dfe4f10aa0e388467.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h4 id=\"3-2-查询主机名www-ymx-com\"><a href=\"#3-2-查询主机名www-ymx-com\" class=\"headerlink\" title=\"3.2 查询主机名www.ymx.com\"></a>3.2 查询主机名<a href=\"http://www.ymx.com/\">www.ymx.com</a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">www.ymx.com</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/3db5d9ca1f855e5b61f8b.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/3db5d9ca1f855e5b61f8b.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h4 id=\"3-3-查询ymx-com区域授权记录\"><a href=\"#3-3-查询ymx-com区域授权记录\" class=\"headerlink\" title=\"3.3 查询ymx.com区域授权记录\"></a>3.3 查询ymx.com区域授权记录</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">set type=soa</span><br><span class=\"line\">ymx.com</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/b4b78740bc024a8a81610.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/b4b78740bc024a8a81610.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h4 id=\"3-4-查询1-168-192-in-addr-arpa区域授权记录\"><a href=\"#3-4-查询1-168-192-in-addr-arpa区域授权记录\" class=\"headerlink\" title=\"3.4 查询1.168.192.in-addr.arpa区域授权记录\"></a>3.4 查询1.168.192.in-addr.arpa区域授权记录</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1.168</span><span class=\"number\">.192</span>.in-addr.arpa</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/cde1584ef3d609a9520df.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/cde1584ef3d609a9520df.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h4 id=\"3-5-查询邮箱交换器记录\"><a href=\"#3-5-查询邮箱交换器记录\" class=\"headerlink\" title=\"3.5 查询邮箱交换器记录\"></a>3.5 查询邮箱交换器记录</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">set type=mx</span><br><span class=\"line\">ymx.com</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/663745b9f94e4326cad32.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/663745b9f94e4326cad32.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h4 id=\"3-6-查询名称服务器记录\"><a href=\"#3-6-查询名称服务器记录\" class=\"headerlink\" title=\"3.6 查询名称服务器记录\"></a>3.6 查询名称服务器记录</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">set type=ns</span><br><span class=\"line\">ymx.com</span><br><span class=\"line\"><span class=\"number\">1.168</span><span class=\"number\">.192</span>.in-addr.arpa</span><br><span class=\"line\">exit\t\t\t\t\t\t\t<span class=\"comment\">//退出</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/04bad564727027d52486b.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/04bad564727027d52486b.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"至此，实验结束。\"><a href=\"#至此，实验结束。\" class=\"headerlink\" title=\"至此，实验结束。\"></a>至此，实验结束。</h2>",
            "tags": [
                "服务器",
                "运维",
                "Linux",
                "CentOS",
                "网络",
                "DNS"
            ]
        },
        {
            "id": "https://yeminxi.github.io/posts/cfebefbe.html",
            "url": "https://yeminxi.github.io/posts/cfebefbe.html",
            "title": "第三章 Centos 7 Linux配置samba 实训任务1：配置Samba服务",
            "date_published": "2024-05-28T03:48:51.000Z",
            "content_html": "<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>虚拟机需求：1台服务器（Server）、1台客户端（Client）</p>\n<blockquote>\n<p><strong>在第二章的基础上继续实训</strong></p>\n</blockquote>\n<h2 id=\"实训任务1：配置Samba服务\"><a href=\"#实训任务1：配置Samba服务\" class=\"headerlink\" title=\"实训任务1：配置Samba服务\"></a>实训任务1：配置Samba服务</h2><blockquote>\n<h3 id=\"任务1-创建Samba共享，本地目录为-data-share，要求：\"><a href=\"#任务1-创建Samba共享，本地目录为-data-share，要求：\" class=\"headerlink\" title=\"任务1 创建Samba共享，本地目录为&#x2F;data&#x2F;share，要求：\"></a>任务1 创建Samba共享，本地目录为&#x2F;data&#x2F;share，要求：</h3><p>共享名为share1<br>仅允许zsuser用户能上传文件</p>\n</blockquote>\n<blockquote>\n<h3 id=\"任务2-创建Samba共享，本地目录为-data-public，要求：\"><a href=\"#任务2-创建Samba共享，本地目录为-data-public，要求：\" class=\"headerlink\" title=\"任务2 创建Samba共享，本地目录为&#x2F;data&#x2F;public，要求：\"></a>任务2 创建Samba共享，本地目录为&#x2F;data&#x2F;public，要求：</h3><p>共享名为public</p>\n<p>允许匿名访问</p>\n<p>所有用户都能上传文件</p>\n</blockquote>\n<h2 id=\"一、在服务器（Server）上安装Samba服务\"><a href=\"#一、在服务器（Server）上安装Samba服务\" class=\"headerlink\" title=\"一、在服务器（Server）上安装Samba服务\"></a>一、在服务器（Server）上安装Samba服务</h2><h3 id=\"1-确保良好的网络连接也要保证设备的联网\"><a href=\"#1-确保良好的网络连接也要保证设备的联网\" class=\"headerlink\" title=\"1. 确保良好的网络连接也要保证设备的联网\"></a>1. 确保良好的网络连接也要保证设备的联网</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum list installed | grep samba \t\t\t\t\\\\查看是否安装了samba服务</span><br><span class=\"line\">yum -y install samba\t\t\t\t\t\t\t\\\\安装samba服务</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/8703f6d6f03de11ce6cd0.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/8703f6d6f03de11ce6cd0.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-防火墙设置\"><a href=\"#2-防火墙设置\" class=\"headerlink\" title=\"2. 防火墙设置\"></a>2. 防火墙设置</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-service=samba\t\t\\\\开启samba服务 允许通过</span><br><span class=\"line\">firewall-cmd --reload\t\t\t\t\t\t\t\t\t\t\t\\\\重启防火墙</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/1542ac9641fa09b4280d1.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/1542ac9641fa09b4280d1.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"3-开启samba服务\"><a href=\"#3-开启samba服务\" class=\"headerlink\" title=\"3. 开启samba服务\"></a>3. 开启samba服务</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start smb nmb\t\t\t\t\t\\\\开启samba服务</span><br><span class=\"line\">systemctl enable smb nmb\t\t\t\t\\\\开机自启samba服务</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/0b672eb5283341ecba40d.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/0b672eb5283341ecba40d.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"4-创建samba用户\"><a href=\"#4-创建samba用户\" class=\"headerlink\" title=\"4. 创建samba用户\"></a>4. 创建samba用户</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">useradd zsuser\t\t\t\t\\\\添加zsuser用户</span><br><span class=\"line\">smbpasswd -a zsuser\t\t\t\\\\为zsuser用户添加密码</span><br><span class=\"line\">useradd tom\t\t\t\t\t\\\\添加多一个用户好测试</span><br><span class=\"line\">smbpasswd -a tom\t\t\t\\\\设置密码</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/1eea16dcab85fe84a94aa.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/1eea16dcab85fe84a94aa.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"二、在服务器（Server）上创建samba共享目录\"><a href=\"#二、在服务器（Server）上创建samba共享目录\" class=\"headerlink\" title=\"二、在服务器（Server）上创建samba共享目录\"></a>二、在服务器（Server）上创建samba共享目录</h2><h3 id=\"1-创建share、public目录\"><a href=\"#1-创建share、public目录\" class=\"headerlink\" title=\"1. 创建share、public目录\"></a>1. 创建share、public目录</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir /data /data/share/ /data/<span class=\"keyword\">public</span>/\t\t\t\t\\\\创建share、<span class=\"keyword\">public</span>目录</span><br><span class=\"line\">chmod <span class=\"number\">777</span> /data /data/share/ /data/<span class=\"keyword\">public</span>/\t\t\t\\\\设置目录权限</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/ae1a02daba7ce86ac7934.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/ae1a02daba7ce86ac7934.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-创建share1、public共享目录\"><a href=\"#2-创建share1、public共享目录\" class=\"headerlink\" title=\"2. 创建share1、public共享目录\"></a>2. 创建share1、public共享目录</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/samba/smb.conf\t\t\t\t\\\\编辑配置文件详细内容如下所示</span><br><span class=\"line\">[global]\t\t\t\t\t\\\\在全局变量中加入</span><br><span class=\"line\">map <span class=\"type\">to</span> <span class=\"variable\">guest</span> <span class=\"operator\">=</span> bad user\t\t\\\\开启匿名访问</span><br><span class=\"line\">[share1]</span><br><span class=\"line\">        comment = share1\t\\\\共享注释</span><br><span class=\"line\">        path = /data/share\t\\\\指定共享目录</span><br><span class=\"line\">        <span class=\"type\">write</span> <span class=\"variable\">list</span> <span class=\"operator\">=</span> zsuser\t\\\\写入列表</span><br><span class=\"line\">        writable = no\t\t\\\\不支持写入数据（列表中写读，不在列表只读）</span><br><span class=\"line\">[<span class=\"keyword\">public</span>]</span><br><span class=\"line\">        comment = <span class=\"keyword\">public</span>\t\\\\共享注释</span><br><span class=\"line\">        path = /data/<span class=\"keyword\">public</span>\t\\\\指定共享目录</span><br><span class=\"line\">        <span class=\"type\">guest</span> <span class=\"variable\">ok</span> <span class=\"operator\">=</span> yes\t\t\\\\允许匿名访问</span><br><span class=\"line\">        browseable = yes\t\\\\所有人可见</span><br><span class=\"line\">        writeable = yes\t\t\\\\支持写入数据</span><br><span class=\"line\">        <span class=\"type\">read</span> <span class=\"variable\">only</span> <span class=\"operator\">=</span> no\t\t\\\\是否可读</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/2f5eb2de14ebbab215b92.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/2f5eb2de14ebbab215b92.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"3-检查语法错误跟重启samba服务\"><a href=\"#3-检查语法错误跟重启samba服务\" class=\"headerlink\" title=\"3. 检查语法错误跟重启samba服务\"></a>3. 检查语法错误跟重启samba服务</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">testparm\t\t\t\t\t\t\t\\\\检查语法错误</span><br><span class=\"line\">systemctl restart sbm nmb\t\t\t\\\\重启samba服务</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/89a4b66e91f45918dd916.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/89a4b66e91f45918dd916.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"4-配置selinux\"><a href=\"#4-配置selinux\" class=\"headerlink\" title=\"4. 配置selinux\"></a>4. 配置selinux</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">setenforce <span class=\"number\">1</span>\t\t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//开启</span></span><br><span class=\"line\">ls -ldZ /data/share /data/<span class=\"keyword\">public</span>\t\t\t\t\t\t<span class=\"comment\">//查看文件夹安全上下文</span></span><br><span class=\"line\">chcon -t samba_share_t /data/share /data/<span class=\"keyword\">public</span>\t\t\t</span><br><span class=\"line\"><span class=\"comment\">//为/data/share设置samba_share_t标签目录，使selinux允许samba读和写这个目录。</span></span><br><span class=\"line\"><span class=\"comment\">//为/data/public设置samba_share_t标签目录，使selinux允许samba读和写这个目录。</span></span><br><span class=\"line\">ls -ldZ /data/share /data/<span class=\"keyword\">public</span>\t\t\t\t\t\t<span class=\"comment\">//查看文件夹安全上下文</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/bfe396cae2869d5149a97.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/bfe396cae2869d5149a97.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"三、在客户机（Client）上测试\"><a href=\"#三、在客户机（Client）上测试\" class=\"headerlink\" title=\"三、在客户机（Client）上测试\"></a>三、在客户机（Client）上测试</h2><h3 id=\"1-测试-任务1\"><a href=\"#1-测试-任务1\" class=\"headerlink\" title=\"1. 测试 任务1\"></a>1. 测试 任务1</h3><blockquote>\n<p>smbclient &#x2F;&#x2F;192.168.1.10&#x2F;share1 -U zsuser\t\t\t\t&#x3D;&#x3D;使用zsuser用户访问samba服务&#x3D;&#x3D;<br>mkdir test \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;测试是否能创建test文件夹&#x3D;&#x3D;<br>ls \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;查看列表 显示test文件夹 证明成功&#x3D;&#x3D;<br>exit \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;退出&#x3D;&#x3D;\t</p>\n</blockquote>\n<blockquote>\n<p>smbclient&#x2F;&#x2F;192.168.1.10&#x2F;share1 -U tom \t\t\t\t\t&#x3D;&#x3D;使用tom用户访问samba服务&#x3D;&#x3D;<br>mkdir test1 \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;测试是否能创建test1文件夹&#x3D;&#x3D;<br>ls \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;查看列表 不显示test1文件夹 证明除了zsuser用户能写入其余用户不能写入只能读&#x3D;&#x3D;<br>exit\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;退出&#x3D;&#x3D;</p>\n</blockquote>\n<p><img src=\"https://ymxpic.pages.dev/file/5d43a1d78cd30590d6e82.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/5d43a1d78cd30590d6e82.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-测试-任务2\"><a href=\"#2-测试-任务2\" class=\"headerlink\" title=\"2. 测试 任务2\"></a>2. 测试 任务2</h3><blockquote>\n<p>smbclient&#x2F;&#x2F;192.168.1.10&#x2F;share1 -U guest\t\t\t\t\t&#x3D;&#x3D;使用匿名用户访问samba服务&#x3D;&#x3D;<br>mkdir test1 \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;测试是否能创建test1文件夹&#x3D;&#x3D;<br>ls \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;查看列表 显示test1文件夹 证明所有用户都能读写&#x3D;&#x3D;<br>exit\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;退出&#x3D;&#x3D;</p>\n</blockquote>\n<p><img src=\"https://ymxpic.pages.dev/file/7af823ce5f86eecd47f75.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/7af823ce5f86eecd47f75.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"3-windows-7-测试\"><a href=\"#3-windows-7-测试\" class=\"headerlink\" title=\"3. windows 7 测试\"></a>3. windows 7 测试</h3><p><img src=\"https://ymxpic.pages.dev/file/cde9ec53b36cd2bd6147f.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/cde9ec53b36cd2bd6147f.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"至此，实验结束。\"><a href=\"#至此，实验结束。\" class=\"headerlink\" title=\"至此，实验结束。\"></a>至此，实验结束。</h2>",
            "tags": [
                "服务器",
                "运维",
                "Linux",
                "CentOS",
                "网络",
                "Samba"
            ]
        }
    ]
}