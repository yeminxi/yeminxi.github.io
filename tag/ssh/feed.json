{
    "version": "https://jsonfeed.org/version/1",
    "title": "叶泯希·杂七杂八的🐕窝 • All posts by \"ssh\" tag",
    "description": "叶泯希的个人博客,yeminxiblog",
    "home_page_url": "https://yeminxi.github.io",
    "items": [
        {
            "id": "https://yeminxi.github.io/posts/c38d1213.html",
            "url": "https://yeminxi.github.io/posts/c38d1213.html",
            "title": "第二章_Centos 7 Linux配置ssh 实训任务：SSH的安全配置",
            "date_published": "2024-05-28T03:21:51.000Z",
            "content_html": "<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>虚拟机需求：1台服务器（Server）、1台客户端（Client）</p>\n<blockquote>\n<h2 id=\"实训任务2：SSH的安全配置\"><a href=\"#实训任务2：SSH的安全配置\" class=\"headerlink\" title=\"实训任务2：SSH的安全配置\"></a>实训任务2：SSH的安全配置</h2><h3 id=\"任务情境描述-某公司管理员已经将自己个人电脑免密登录到远程服务器。\"><a href=\"#任务情境描述-某公司管理员已经将自己个人电脑免密登录到远程服务器。\" class=\"headerlink\" title=\"任务情境描述 某公司管理员已经将自己个人电脑免密登录到远程服务器。\"></a>任务情境描述 某公司管理员已经将自己个人电脑免密登录到远程服务器。</h3></blockquote>\n<blockquote>\n<p><img src=\"https://ymxpic.pages.dev/file/223c1ea91948fb2ec3a2e.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/223c1ea91948fb2ec3a2e.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n</blockquote>\n<blockquote>\n<p><strong>服务器地址为192.168.1.10&#x2F;24（IP地址可自行设置）</strong><br><strong>管理员PC地址为192.168.1.20&#x2F;24（IP地址可自行设置）</strong><br><strong>管理员ID为admin，密码为password</strong></p>\n</blockquote>\n<blockquote>\n<h3 id=\"任务需求：\"><a href=\"#任务需求：\" class=\"headerlink\" title=\"任务需求：\"></a>任务需求：</h3><h4 id=\"（1）为了让SSH更安全，需要修改SSH的端口为61234；\"><a href=\"#（1）为了让SSH更安全，需要修改SSH的端口为61234；\" class=\"headerlink\" title=\"（1）为了让SSH更安全，需要修改SSH的端口为61234；\"></a>（1）为了让SSH更安全，需要修改SSH的端口为61234；</h4><h4 id=\"（2）限制SSH服务器只能由管理员PC通过admin用户登录，其他用户均无法远程访问服务器。\"><a href=\"#（2）限制SSH服务器只能由管理员PC通过admin用户登录，其他用户均无法远程访问服务器。\" class=\"headerlink\" title=\"（2）限制SSH服务器只能由管理员PC通过admin用户登录，其他用户均无法远程访问服务器。\"></a>（2）限制SSH服务器只能由管理员PC通过admin用户登录，其他用户均无法远程访问服务器。</h4></blockquote>\n<blockquote>\n<p>请完成配置，并提交实验报告。（线下课程随堂检查） 若没有安装Centos 7 虚拟机 请单击此处 有详细的安装教程</p>\n</blockquote>\n<h2 id=\"一、配置虚拟网络（可自行设置）\"><a href=\"#一、配置虚拟网络（可自行设置）\" class=\"headerlink\" title=\"一、配置虚拟网络（可自行设置）\"></a>一、配置虚拟网络（可自行设置）</h2><p><img src=\"https://ymxpic.pages.dev/file/fed0bb0a28d20213b36af.png\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/fed0bb0a28d20213b36af.png\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br><img src=\"https://ymxpic.pages.dev/file/1e065255b4baed349e831.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/1e065255b4baed349e831.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\" alt=\"不勾选使用本地DHCP服务 按题目需求修改IP地址\"></p>\n<h3 id=\"1-修改NAT模式的子网IP：192-168-1-0-子网掩码：255-255-255-0\"><a href=\"#1-修改NAT模式的子网IP：192-168-1-0-子网掩码：255-255-255-0\" class=\"headerlink\" title=\"1. 修改NAT模式的子网IP：192.168.1.0 子网掩码：255.255.255.0\"></a>1. 修改NAT模式的子网IP：192.168.1.0 子网掩码：255.255.255.0</h3><h3 id=\"2-取消勾选使用本地DHCP服务将IP地址分配给虚拟机\"><a href=\"#2-取消勾选使用本地DHCP服务将IP地址分配给虚拟机\" class=\"headerlink\" title=\"2. 取消勾选使用本地DHCP服务将IP地址分配给虚拟机\"></a>2. 取消勾选使用本地DHCP服务将IP地址分配给虚拟机</h3><h3 id=\"3-单击“NAT-设置”-修改网关：192-168-1-2\"><a href=\"#3-单击“NAT-设置”-修改网关：192-168-1-2\" class=\"headerlink\" title=\"3. 单击“NAT 设置” 修改网关：192.168.1.2\"></a>3. 单击“NAT 设置” 修改网关：192.168.1.2</h3><h2 id=\"二、配置服务器（server）与客户端（client）的IP地址并使互相ping通\"><a href=\"#二、配置服务器（server）与客户端（client）的IP地址并使互相ping通\" class=\"headerlink\" title=\"二、配置服务器（server）与客户端（client）的IP地址并使互相ping通\"></a>二、配置服务器（server）与客户端（client）的IP地址并使互相ping通</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">su root\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\\\\进入root</span><br><span class=\"line\">vim /etc/sysconfig/network-scripts/ifcfg-ens33\t\t\t\t\t\\\\修改默认网卡脚本 一切按照实际情况</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-服务器（server）网络配置（添加修改命令如下）\"><a href=\"#1-服务器（server）网络配置（添加修改命令如下）\" class=\"headerlink\" title=\"1. 服务器（server）网络配置（添加修改命令如下）\"></a>1. 服务器（server）网络配置（添加修改命令如下）</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">BOOTPROTO=<span class=\"string\">&quot;static&quot;</span> </span><br><span class=\"line\">ONBOOT=<span class=\"string\">&quot;yes&quot;</span> </span><br><span class=\"line\">IPADDR=<span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.10</span></span><br><span class=\"line\">GATEWAY=<span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.2</span> </span><br><span class=\"line\">NETMAKS=<span class=\"number\">255.255</span><span class=\"number\">.255</span><span class=\"number\">.0</span> </span><br><span class=\"line\">DNS1=<span class=\"number\">202.96</span><span class=\"number\">.128</span><span class=\"number\">.86</span>（电信）\t联通：<span class=\"number\">221.5</span><span class=\"number\">.88</span><span class=\"number\">.88</span>\t移动：<span class=\"number\">211.136</span><span class=\"number\">.192</span><span class=\"number\">.6</span></span><br><span class=\"line\">DNS2=<span class=\"number\">114.114</span><span class=\"number\">.114</span><span class=\"number\">.114</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/287e94072c3aba4c9d5f1.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/287e94072c3aba4c9d5f1.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-客户端（client）同理\"><a href=\"#2-客户端（client）同理\" class=\"headerlink\" title=\"2. 客户端（client）同理\"></a>2. 客户端（client）同理</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">BOOTPROTO=<span class=\"string\">&quot;static&quot;</span> </span><br><span class=\"line\">ONBOOT=<span class=\"string\">&quot;yes&quot;</span> </span><br><span class=\"line\">IPADDR=<span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.10</span></span><br><span class=\"line\">GATEWAY=<span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.2</span> </span><br><span class=\"line\">NETMAKS=<span class=\"number\">255.255</span><span class=\"number\">.255</span><span class=\"number\">.0</span> </span><br><span class=\"line\">DNS1=<span class=\"number\">202.96</span><span class=\"number\">.128</span><span class=\"number\">.86</span>（电信）\t联通：<span class=\"number\">221.5</span><span class=\"number\">.88</span><span class=\"number\">.88</span>\t移动：<span class=\"number\">211.136</span><span class=\"number\">.192</span><span class=\"number\">.6</span></span><br><span class=\"line\">DNS2=<span class=\"number\">114.114</span><span class=\"number\">.114</span><span class=\"number\">.114</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/01459d855c7a42e646142.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/01459d855c7a42e646142.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"3-服务器（Server）与客户端（Client）互相ping通\"><a href=\"#3-服务器（Server）与客户端（Client）互相ping通\" class=\"headerlink\" title=\"3. 服务器（Server）与客户端（Client）互相ping通\"></a>3. 服务器（Server）与客户端（Client）互相ping通</h3><p><img src=\"https://ymxpic.pages.dev/file/cd8e84945a0c96b3ba10e.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/cd8e84945a0c96b3ba10e.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"三、在服务器（Server）上添加用户\"><a href=\"#三、在服务器（Server）上添加用户\" class=\"headerlink\" title=\"三、在服务器（Server）上添加用户\"></a>三、在服务器（Server）上添加用户</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">useradd admin\t\t\t\t\t\t\t\t\t\\\\添加管理员admin</span><br><span class=\"line\">passwd --stdin admin\t\t\t\t\t\t\t\\\\为管理员admin设置密码</span><br><span class=\"line\">password\t\t\t\t\t\t\t\t\t\t\\\\输入题目要求密码</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/dcbc3c531ac66b66e037a.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/dcbc3c531ac66b66e037a.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"四、在服务器（Server）修改ssh默认端口\"><a href=\"#四、在服务器（Server）修改ssh默认端口\" class=\"headerlink\" title=\"四、在服务器（Server）修改ssh默认端口\"></a>四、在服务器（Server）修改ssh默认端口</h2><h3 id=\"1-确保虚拟机已安装openssh-server-以下命令可查询\"><a href=\"#1-确保虚拟机已安装openssh-server-以下命令可查询\" class=\"headerlink\" title=\"1. 确保虚拟机已安装openssh-server 以下命令可查询\"></a>1. 确保虚拟机已安装openssh-server 以下命令可查询</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum list installed | grep openssh-server</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/b09fa4d1f40e5a93c5c7a.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/b09fa4d1f40e5a93c5c7a.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"若无结果就未安装，则可输入以下命令进行安装\"><a href=\"#若无结果就未安装，则可输入以下命令进行安装\" class=\"headerlink\" title=\"若无结果就未安装，则可输入以下命令进行安装\"></a>若无结果就未安装，则可输入以下命令进行安装</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install openssh-server</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-修改默认端口\"><a href=\"#2-修改默认端口\" class=\"headerlink\" title=\"2. 修改默认端口\"></a>2. 修改默认端口</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/4ebd48c1d1c005be1286d.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/4ebd48c1d1c005be1286d.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"3-防火墙设置和修改安全上下文\"><a href=\"#3-防火墙设置和修改安全上下文\" class=\"headerlink\" title=\"3. 防火墙设置和修改安全上下文\"></a>3. 防火墙设置和修改安全上下文</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --permanent --add-port=<span class=\"number\">61234</span>/tcp\t\t\t\t\\\\开启端口<span class=\"number\">61234</span></span><br><span class=\"line\">firewall-cmd --reload\t\t\t\t\t\t\t\t\t\t\\\\重启防火墙</span><br><span class=\"line\">semanage port -a -t ssh_port_t -p tcp <span class=\"number\">61234</span>\t\t\t\t\t\\\\修改安全上下文</span><br><span class=\"line\">semanage port -l | grep ssh\t\t\t\t\t\t\t\t\t\\\\查看修改以后的上下文</span><br><span class=\"line\">systemctl restart sshd\t\t\t\t\t\t\t\t\t\t\\\\重启ssh服务</span><br><span class=\"line\">systemctl enable sshd\t\t\t\t\t\t\t\t\t    \\\\设置ssh服务开机自启</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/7d0076fc7114f62912f38.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/7d0076fc7114f62912f38.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"4-客户端（Client）测试\"><a href=\"#4-客户端（Client）测试\" class=\"headerlink\" title=\"4.客户端（Client）测试\"></a>4.客户端（Client）测试</h3><p><img src=\"https://ymxpic.pages.dev/file/265010c8a895e25da61e4.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/265010c8a895e25da61e4.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"五、指定用户免密登录\"><a href=\"#五、指定用户免密登录\" class=\"headerlink\" title=\"五、指定用户免密登录\"></a>五、指定用户免密登录</h2><h3 id=\"1-首先在客户端（Client）生成密钥并发送到服务器（Server）\"><a href=\"#1-首先在客户端（Client）生成密钥并发送到服务器（Server）\" class=\"headerlink\" title=\"1. 首先在客户端（Client）生成密钥并发送到服务器（Server）\"></a>1. 首先在客户端（Client）生成密钥并发送到服务器（Server）</h3><p><img src=\"https://ymxpic.pages.dev/file/b8b1e7237120492d6a675.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/b8b1e7237120492d6a675.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen\t\t\t\t\t\t\t\t\t\t\\\\生成密钥 连续 按<span class=\"number\">3</span>次 Enter键</span><br><span class=\"line\">ssh-copy-id -p <span class=\"number\">61234</span> admin@<span class=\"number\">192.168</span><span class=\"number\">.1</span><span class=\"number\">.10</span>\t\t\t\\\\把生成的密钥传到服务器去</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-其次在服务器（Server）修改配置文件-禁止root用户登录和无密码登录\"><a href=\"#2-其次在服务器（Server）修改配置文件-禁止root用户登录和无密码登录\" class=\"headerlink\" title=\"2. 其次在服务器（Server）修改配置文件 禁止root用户登录和无密码登录\"></a>2. 其次在服务器（Server）修改配置文件 禁止root用户登录和无密码登录</h3><p><img src=\"https://ymxpic.pages.dev/file/0e7c4336feb5885a628db.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/0e7c4336feb5885a628db.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/ssh/sshd_config\t\t\t\t\t\t\\\\打开配置文件</span><br><span class=\"line\">systemctl restart sshd\t\t\t\t\t\t\t\\\\修改完重启ssh服务</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-在客户端（Client）上测试\"><a href=\"#3-在客户端（Client）上测试\" class=\"headerlink\" title=\"3. 在客户端（Client）上测试\"></a>3. 在客户端（Client）上测试</h3><p><img src=\"https://ymxpic.pages.dev/file/328d429cca3adb782450b.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/328d429cca3adb782450b.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"><br> <strong>管理员admin成功免密登录，其他用户均无法远程访问服务器。</strong></p>\n<h2 id=\"六、至此，实验结束。\"><a href=\"#六、至此，实验结束。\" class=\"headerlink\" title=\"六、至此，实验结束。\"></a>六、至此，实验结束。</h2>",
            "tags": [
                "服务器",
                "Linux",
                "CentOS",
                "安全",
                "SSH"
            ]
        }
    ]
}