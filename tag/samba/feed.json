{
    "version": "https://jsonfeed.org/version/1",
    "title": "叶泯希·杂七杂八的🐕窝 • All posts by \"samba\" tag",
    "description": "叶泯希的个人博客,yeminxiblog",
    "home_page_url": "https://yeminxi.github.io",
    "items": [
        {
            "id": "https://yeminxi.github.io/posts/cfebefbe.html",
            "url": "https://yeminxi.github.io/posts/cfebefbe.html",
            "title": "第三章 Centos 7 Linux配置samba 实训任务1：配置Samba服务",
            "date_published": "2024-05-28T03:48:51.000Z",
            "content_html": "<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>虚拟机需求：1台服务器（Server）、1台客户端（Client）</p>\n<blockquote>\n<p><strong>在第二章的基础上继续实训</strong></p>\n</blockquote>\n<h2 id=\"实训任务1：配置Samba服务\"><a href=\"#实训任务1：配置Samba服务\" class=\"headerlink\" title=\"实训任务1：配置Samba服务\"></a>实训任务1：配置Samba服务</h2><blockquote>\n<h3 id=\"任务1-创建Samba共享，本地目录为-data-share，要求：\"><a href=\"#任务1-创建Samba共享，本地目录为-data-share，要求：\" class=\"headerlink\" title=\"任务1 创建Samba共享，本地目录为&#x2F;data&#x2F;share，要求：\"></a>任务1 创建Samba共享，本地目录为&#x2F;data&#x2F;share，要求：</h3><p>共享名为share1<br>仅允许zsuser用户能上传文件</p>\n</blockquote>\n<blockquote>\n<h3 id=\"任务2-创建Samba共享，本地目录为-data-public，要求：\"><a href=\"#任务2-创建Samba共享，本地目录为-data-public，要求：\" class=\"headerlink\" title=\"任务2 创建Samba共享，本地目录为&#x2F;data&#x2F;public，要求：\"></a>任务2 创建Samba共享，本地目录为&#x2F;data&#x2F;public，要求：</h3><p>共享名为public</p>\n<p>允许匿名访问</p>\n<p>所有用户都能上传文件</p>\n</blockquote>\n<h2 id=\"一、在服务器（Server）上安装Samba服务\"><a href=\"#一、在服务器（Server）上安装Samba服务\" class=\"headerlink\" title=\"一、在服务器（Server）上安装Samba服务\"></a>一、在服务器（Server）上安装Samba服务</h2><h3 id=\"1-确保良好的网络连接也要保证设备的联网\"><a href=\"#1-确保良好的网络连接也要保证设备的联网\" class=\"headerlink\" title=\"1. 确保良好的网络连接也要保证设备的联网\"></a>1. 确保良好的网络连接也要保证设备的联网</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum list installed | grep samba \t\t\t\t\\\\查看是否安装了samba服务</span><br><span class=\"line\">yum -y install samba\t\t\t\t\t\t\t\\\\安装samba服务</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/8703f6d6f03de11ce6cd0.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/8703f6d6f03de11ce6cd0.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-防火墙设置\"><a href=\"#2-防火墙设置\" class=\"headerlink\" title=\"2. 防火墙设置\"></a>2. 防火墙设置</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --permanent --zone=<span class=\"keyword\">public</span> --add-service=samba\t\t\\\\开启samba服务 允许通过</span><br><span class=\"line\">firewall-cmd --reload\t\t\t\t\t\t\t\t\t\t\t\\\\重启防火墙</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/1542ac9641fa09b4280d1.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/1542ac9641fa09b4280d1.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"3-开启samba服务\"><a href=\"#3-开启samba服务\" class=\"headerlink\" title=\"3. 开启samba服务\"></a>3. 开启samba服务</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start smb nmb\t\t\t\t\t\\\\开启samba服务</span><br><span class=\"line\">systemctl enable smb nmb\t\t\t\t\\\\开机自启samba服务</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/0b672eb5283341ecba40d.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/0b672eb5283341ecba40d.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"4-创建samba用户\"><a href=\"#4-创建samba用户\" class=\"headerlink\" title=\"4. 创建samba用户\"></a>4. 创建samba用户</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">useradd zsuser\t\t\t\t\\\\添加zsuser用户</span><br><span class=\"line\">smbpasswd -a zsuser\t\t\t\\\\为zsuser用户添加密码</span><br><span class=\"line\">useradd tom\t\t\t\t\t\\\\添加多一个用户好测试</span><br><span class=\"line\">smbpasswd -a tom\t\t\t\\\\设置密码</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/1eea16dcab85fe84a94aa.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/1eea16dcab85fe84a94aa.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"二、在服务器（Server）上创建samba共享目录\"><a href=\"#二、在服务器（Server）上创建samba共享目录\" class=\"headerlink\" title=\"二、在服务器（Server）上创建samba共享目录\"></a>二、在服务器（Server）上创建samba共享目录</h2><h3 id=\"1-创建share、public目录\"><a href=\"#1-创建share、public目录\" class=\"headerlink\" title=\"1. 创建share、public目录\"></a>1. 创建share、public目录</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir /data /data/share/ /data/<span class=\"keyword\">public</span>/\t\t\t\t\\\\创建share、<span class=\"keyword\">public</span>目录</span><br><span class=\"line\">chmod <span class=\"number\">777</span> /data /data/share/ /data/<span class=\"keyword\">public</span>/\t\t\t\\\\设置目录权限</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/ae1a02daba7ce86ac7934.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/ae1a02daba7ce86ac7934.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-创建share1、public共享目录\"><a href=\"#2-创建share1、public共享目录\" class=\"headerlink\" title=\"2. 创建share1、public共享目录\"></a>2. 创建share1、public共享目录</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/samba/smb.conf\t\t\t\t\\\\编辑配置文件详细内容如下所示</span><br><span class=\"line\">[global]\t\t\t\t\t\\\\在全局变量中加入</span><br><span class=\"line\">map <span class=\"type\">to</span> <span class=\"variable\">guest</span> <span class=\"operator\">=</span> bad user\t\t\\\\开启匿名访问</span><br><span class=\"line\">[share1]</span><br><span class=\"line\">        comment = share1\t\\\\共享注释</span><br><span class=\"line\">        path = /data/share\t\\\\指定共享目录</span><br><span class=\"line\">        <span class=\"type\">write</span> <span class=\"variable\">list</span> <span class=\"operator\">=</span> zsuser\t\\\\写入列表</span><br><span class=\"line\">        writable = no\t\t\\\\不支持写入数据（列表中写读，不在列表只读）</span><br><span class=\"line\">[<span class=\"keyword\">public</span>]</span><br><span class=\"line\">        comment = <span class=\"keyword\">public</span>\t\\\\共享注释</span><br><span class=\"line\">        path = /data/<span class=\"keyword\">public</span>\t\\\\指定共享目录</span><br><span class=\"line\">        <span class=\"type\">guest</span> <span class=\"variable\">ok</span> <span class=\"operator\">=</span> yes\t\t\\\\允许匿名访问</span><br><span class=\"line\">        browseable = yes\t\\\\所有人可见</span><br><span class=\"line\">        writeable = yes\t\t\\\\支持写入数据</span><br><span class=\"line\">        <span class=\"type\">read</span> <span class=\"variable\">only</span> <span class=\"operator\">=</span> no\t\t\\\\是否可读</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/2f5eb2de14ebbab215b92.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/2f5eb2de14ebbab215b92.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"3-检查语法错误跟重启samba服务\"><a href=\"#3-检查语法错误跟重启samba服务\" class=\"headerlink\" title=\"3. 检查语法错误跟重启samba服务\"></a>3. 检查语法错误跟重启samba服务</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">testparm\t\t\t\t\t\t\t\\\\检查语法错误</span><br><span class=\"line\">systemctl restart sbm nmb\t\t\t\\\\重启samba服务</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/89a4b66e91f45918dd916.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/89a4b66e91f45918dd916.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"4-配置selinux\"><a href=\"#4-配置selinux\" class=\"headerlink\" title=\"4. 配置selinux\"></a>4. 配置selinux</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">setenforce <span class=\"number\">1</span>\t\t\t\t\t\t\t\t\t\t\t<span class=\"comment\">//开启</span></span><br><span class=\"line\">ls -ldZ /data/share /data/<span class=\"keyword\">public</span>\t\t\t\t\t\t<span class=\"comment\">//查看文件夹安全上下文</span></span><br><span class=\"line\">chcon -t samba_share_t /data/share /data/<span class=\"keyword\">public</span>\t\t\t</span><br><span class=\"line\"><span class=\"comment\">//为/data/share设置samba_share_t标签目录，使selinux允许samba读和写这个目录。</span></span><br><span class=\"line\"><span class=\"comment\">//为/data/public设置samba_share_t标签目录，使selinux允许samba读和写这个目录。</span></span><br><span class=\"line\">ls -ldZ /data/share /data/<span class=\"keyword\">public</span>\t\t\t\t\t\t<span class=\"comment\">//查看文件夹安全上下文</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ymxpic.pages.dev/file/bfe396cae2869d5149a97.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/bfe396cae2869d5149a97.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"三、在客户机（Client）上测试\"><a href=\"#三、在客户机（Client）上测试\" class=\"headerlink\" title=\"三、在客户机（Client）上测试\"></a>三、在客户机（Client）上测试</h2><h3 id=\"1-测试-任务1\"><a href=\"#1-测试-任务1\" class=\"headerlink\" title=\"1. 测试 任务1\"></a>1. 测试 任务1</h3><blockquote>\n<p>smbclient &#x2F;&#x2F;192.168.1.10&#x2F;share1 -U zsuser\t\t\t\t&#x3D;&#x3D;使用zsuser用户访问samba服务&#x3D;&#x3D;<br>mkdir test \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;测试是否能创建test文件夹&#x3D;&#x3D;<br>ls \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;查看列表 显示test文件夹 证明成功&#x3D;&#x3D;<br>exit \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;退出&#x3D;&#x3D;\t</p>\n</blockquote>\n<blockquote>\n<p>smbclient&#x2F;&#x2F;192.168.1.10&#x2F;share1 -U tom \t\t\t\t\t&#x3D;&#x3D;使用tom用户访问samba服务&#x3D;&#x3D;<br>mkdir test1 \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;测试是否能创建test1文件夹&#x3D;&#x3D;<br>ls \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;查看列表 不显示test1文件夹 证明除了zsuser用户能写入其余用户不能写入只能读&#x3D;&#x3D;<br>exit\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;退出&#x3D;&#x3D;</p>\n</blockquote>\n<p><img src=\"https://ymxpic.pages.dev/file/5d43a1d78cd30590d6e82.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/5d43a1d78cd30590d6e82.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"2-测试-任务2\"><a href=\"#2-测试-任务2\" class=\"headerlink\" title=\"2. 测试 任务2\"></a>2. 测试 任务2</h3><blockquote>\n<p>smbclient&#x2F;&#x2F;192.168.1.10&#x2F;share1 -U guest\t\t\t\t\t&#x3D;&#x3D;使用匿名用户访问samba服务&#x3D;&#x3D;<br>mkdir test1 \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;测试是否能创建test1文件夹&#x3D;&#x3D;<br>ls \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;查看列表 显示test1文件夹 证明所有用户都能读写&#x3D;&#x3D;<br>exit\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#x3D;&#x3D;退出&#x3D;&#x3D;</p>\n</blockquote>\n<p><img src=\"https://ymxpic.pages.dev/file/7af823ce5f86eecd47f75.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/7af823ce5f86eecd47f75.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h3 id=\"3-windows-7-测试\"><a href=\"#3-windows-7-测试\" class=\"headerlink\" title=\"3. windows 7 测试\"></a>3. windows 7 测试</h3><p><img src=\"https://ymxpic.pages.dev/file/cde9ec53b36cd2bd6147f.jpg\" class=\"lazyload placeholder\" data-srcset=\"https://ymxpic.pages.dev/file/cde9ec53b36cd2bd6147f.jpg\" srcset=\"https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp\"></p>\n<h2 id=\"至此，实验结束。\"><a href=\"#至此，实验结束。\" class=\"headerlink\" title=\"至此，实验结束。\"></a>至此，实验结束。</h2>",
            "tags": [
                "服务器",
                "运维",
                "Linux",
                "CentOS",
                "网络",
                "Samba"
            ]
        }
    ]
}